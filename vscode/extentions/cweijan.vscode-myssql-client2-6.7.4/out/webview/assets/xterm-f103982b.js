import{L as tn,M as mi,n as yi,i as Gr,a as Ot}from"./vueConfig-2816384f.js";import{_ as rn}from"./switch-0dd92594.js";import{_ as sn,a as dt}from"./option-86a3cd54.js";import{D as nn}from"./DatabaseType-7d362de6.js";import"./focus-34de79c8.js";import"./scrollbar-1e3b450c.js";import"./index-4dc5d2a8.js";var jr={exports:{}};(function(K,H){(function(ee,se){K.exports=se()})(self,()=>(()=>{var ee={4567:function(q,c,S){var m=this&&this.__decorate||function(r,l,p,g){var w,v=arguments.length,b=v<3?l:g===null?g=Object.getOwnPropertyDescriptor(l,p):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,l,p,g);else for(var L=r.length-1;L>=0;L--)(w=r[L])&&(b=(v<3?w(b):v>3?w(l,p,b):w(l,p))||b);return v>3&&b&&Object.defineProperty(l,p,b),b},f=this&&this.__param||function(r,l){return function(p,g){l(p,g,r)}};Object.defineProperty(c,"__esModule",{value:!0}),c.AccessibilityManager=void 0;const u=S(9042),d=S(6114),y=S(9924),_=S(844),o=S(5596),t=S(4725),h=S(3656);let s=class extends _.Disposable{constructor(r,l){super(),this._terminal=r,this._renderService=l,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let p=0;p<this._terminal.rows;p++)this._rowElements[p]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[p]);if(this._topBoundaryFocusListener=p=>this._handleBoundaryFocus(p,0),this._bottomBoundaryFocusListener=p=>this._handleBoundaryFocus(p,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new y.TimeBasedDebouncer(this._announceCharacters.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._liveRegionDebouncer),this.register(this._terminal.onResize(p=>this._handleResize(p.rows))),this.register(this._terminal.onRender(p=>this._refreshRows(p.start,p.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(p=>this._handleChar(p))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(p=>this._handleTab(p))),this.register(this._terminal.onKey(p=>this._handleKey(p.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new o.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,h.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,_.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(r){for(let l=0;l<r;l++)this._handleChar(" ")}_handleChar(r){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==r&&(this._charsToAnnounce+=r):this._charsToAnnounce+=r,r===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=u.tooMuchOutput)),d.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,d.isMac&&this._liveRegion.remove()}_handleKey(r){this._clearLiveRegion(),/\p{Control}/u.test(r)||this._charsToConsume.push(r)}_refreshRows(r,l){this._liveRegionDebouncer.refresh(r,l,this._terminal.rows)}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(r,l){const p=r.target,g=this._rowElements[l===0?1:this._rowElements.length-2];if(p.getAttribute("aria-posinset")===(l===0?"1":`${this._terminal.buffer.lines.length}`)||r.relatedTarget!==g)return;let w,v;if(l===0?(w=p,v=this._rowElements.pop(),this._rowContainer.removeChild(v)):(w=this._rowElements.shift(),v=p,this._rowContainer.removeChild(w)),w.removeEventListener("focus",this._topBoundaryFocusListener),v.removeEventListener("focus",this._bottomBoundaryFocusListener),l===0){const b=this._createAccessibilityTreeNode();this._rowElements.unshift(b),this._rowContainer.insertAdjacentElement("afterbegin",b)}else{const b=this._createAccessibilityTreeNode();this._rowElements.push(b),this._rowContainer.appendChild(b)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(l===0?-1:1),this._rowElements[l===0?1:this._rowElements.length-2].focus(),r.preventDefault(),r.stopImmediatePropagation()}_handleResize(r){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let l=this._rowContainer.children.length;l<this._terminal.rows;l++)this._rowElements[l]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[l]);for(;this._rowElements.length>r;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const r=document.createElement("div");return r.setAttribute("role","listitem"),r.tabIndex=-1,this._refreshRowDimensions(r),r}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let r=0;r<this._terminal.rows;r++)this._refreshRowDimensions(this._rowElements[r])}}_refreshRowDimensions(r){r.style.height=`${this._renderService.dimensions.css.cell.height}px`}};s=m([f(1,t.IRenderService)],s),c.AccessibilityManager=s},3614:(q,c)=>{function S(d){return d.replace(/\r?\n/g,"\r")}function m(d,y){return y?"\x1B[200~"+d+"\x1B[201~":d}function f(d,y,_){d=m(d=S(d),_.decPrivateModes.bracketedPasteMode),_.triggerDataEvent(d,!0),y.value=""}function u(d,y,_){const o=_.getBoundingClientRect(),t=d.clientX-o.left-10,h=d.clientY-o.top-10;y.style.width="20px",y.style.height="20px",y.style.left=`${t}px`,y.style.top=`${h}px`,y.style.zIndex="1000",y.focus()}Object.defineProperty(c,"__esModule",{value:!0}),c.rightClickHandler=c.moveTextAreaUnderMouseCursor=c.paste=c.handlePasteEvent=c.copyHandler=c.bracketTextForPaste=c.prepareTextForTerminal=void 0,c.prepareTextForTerminal=S,c.bracketTextForPaste=m,c.copyHandler=function(d,y){d.clipboardData&&d.clipboardData.setData("text/plain",y.selectionText),d.preventDefault()},c.handlePasteEvent=function(d,y,_){d.stopPropagation(),d.clipboardData&&f(d.clipboardData.getData("text/plain"),y,_)},c.paste=f,c.moveTextAreaUnderMouseCursor=u,c.rightClickHandler=function(d,y,_,o,t){u(d,y,_),t&&o.rightClickSelect(d),y.value=o.selectionText,y.select()}},7239:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ColorContrastCache=void 0;const m=S(1505);c.ColorContrastCache=class{constructor(){this._color=new m.TwoKeyMap,this._css=new m.TwoKeyMap}setCss(f,u,d){this._css.set(f,u,d)}getCss(f,u){return this._css.get(f,u)}setColor(f,u,d){this._color.set(f,u,d)}getColor(f,u){return this._color.get(f,u)}clear(){this._color.clear(),this._css.clear()}}},3656:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.addDisposableDomListener=void 0,c.addDisposableDomListener=function(S,m,f,u){S.addEventListener(m,f,u);let d=!1;return{dispose:()=>{d||(d=!0,S.removeEventListener(m,f,u))}}}},6465:function(q,c,S){var m=this&&this.__decorate||function(t,h,s,r){var l,p=arguments.length,g=p<3?h:r===null?r=Object.getOwnPropertyDescriptor(h,s):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(t,h,s,r);else for(var w=t.length-1;w>=0;w--)(l=t[w])&&(g=(p<3?l(g):p>3?l(h,s,g):l(h,s))||g);return p>3&&g&&Object.defineProperty(h,s,g),g},f=this&&this.__param||function(t,h){return function(s,r){h(s,r,t)}};Object.defineProperty(c,"__esModule",{value:!0}),c.Linkifier2=void 0;const u=S(2585),d=S(8460),y=S(844),_=S(3656);let o=class extends y.Disposable{constructor(t){super(),this._bufferService=t,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new d.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new d.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,y.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,y.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}get currentLink(){return this._currentLink}registerLinkProvider(t){return this._linkProviders.push(t),{dispose:()=>{const h=this._linkProviders.indexOf(t);h!==-1&&this._linkProviders.splice(h,1)}}}attachToDom(t,h,s){this._element=t,this._mouseService=h,this._renderService=s,this.register((0,_.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,_.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,_.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,_.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(t){if(this._lastMouseEvent=t,!this._element||!this._mouseService)return;const h=this._positionFromMouseEvent(t,this._element,this._mouseService);if(!h)return;this._isMouseOut=!1;const s=t.composedPath();for(let r=0;r<s.length;r++){const l=s[r];if(l.classList.contains("xterm"))break;if(l.classList.contains("xterm-hover"))return}this._lastBufferCell&&h.x===this._lastBufferCell.x&&h.y===this._lastBufferCell.y||(this._handleHover(h),this._lastBufferCell=h)}_handleHover(t){if(this._activeLine!==t.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(t,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,t)||(this._clearCurrentLink(),this._askForLink(t,!0))}_askForLink(t,h){var s,r;this._activeProviderReplies&&h||((s=this._activeProviderReplies)===null||s===void 0||s.forEach(p=>{p==null||p.forEach(g=>{g.link.dispose&&g.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=t.y);let l=!1;for(const[p,g]of this._linkProviders.entries())h?!((r=this._activeProviderReplies)===null||r===void 0)&&r.get(p)&&(l=this._checkLinkProviderResult(p,t,l)):g.provideLinks(t.y,w=>{var v,b;if(this._isMouseOut)return;const L=w==null?void 0:w.map(A=>({link:A}));(v=this._activeProviderReplies)===null||v===void 0||v.set(p,L),l=this._checkLinkProviderResult(p,t,l),((b=this._activeProviderReplies)===null||b===void 0?void 0:b.size)===this._linkProviders.length&&this._removeIntersectingLinks(t.y,this._activeProviderReplies)})}_removeIntersectingLinks(t,h){const s=new Set;for(let r=0;r<h.size;r++){const l=h.get(r);if(l)for(let p=0;p<l.length;p++){const g=l[p],w=g.link.range.start.y<t?0:g.link.range.start.x,v=g.link.range.end.y>t?this._bufferService.cols:g.link.range.end.x;for(let b=w;b<=v;b++){if(s.has(b)){l.splice(p--,1);break}s.add(b)}}}}_checkLinkProviderResult(t,h,s){var r;if(!this._activeProviderReplies)return s;const l=this._activeProviderReplies.get(t);let p=!1;for(let g=0;g<t;g++)this._activeProviderReplies.has(g)&&!this._activeProviderReplies.get(g)||(p=!0);if(!p&&l){const g=l.find(w=>this._linkAtPosition(w.link,h));g&&(s=!0,this._handleNewLink(g))}if(this._activeProviderReplies.size===this._linkProviders.length&&!s)for(let g=0;g<this._activeProviderReplies.size;g++){const w=(r=this._activeProviderReplies.get(g))===null||r===void 0?void 0:r.find(v=>this._linkAtPosition(v.link,h));if(w){s=!0,this._handleNewLink(w);break}}return s}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(t){if(!this._element||!this._mouseService||!this._currentLink)return;const h=this._positionFromMouseEvent(t,this._element,this._mouseService);h&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,h)&&this._currentLink.link.activate(t,this._currentLink.link.text)}_clearCurrentLink(t,h){this._element&&this._currentLink&&this._lastMouseEvent&&(!t||!h||this._currentLink.link.range.start.y>=t&&this._currentLink.link.range.end.y<=h)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,y.disposeArray)(this._linkCacheDisposables))}_handleNewLink(t){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const h=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);h&&this._linkAtPosition(t.link,h)&&(this._currentLink=t,this._currentLink.state={decorations:{underline:t.link.decorations===void 0||t.link.decorations.underline,pointerCursor:t.link.decorations===void 0||t.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,t.link,this._lastMouseEvent),t.link.decorations={},Object.defineProperties(t.link.decorations,{pointerCursor:{get:()=>{var s,r;return(r=(s=this._currentLink)===null||s===void 0?void 0:s.state)===null||r===void 0?void 0:r.decorations.pointerCursor},set:s=>{var r,l;!((r=this._currentLink)===null||r===void 0)&&r.state&&this._currentLink.state.decorations.pointerCursor!==s&&(this._currentLink.state.decorations.pointerCursor=s,this._currentLink.state.isHovered&&((l=this._element)===null||l===void 0||l.classList.toggle("xterm-cursor-pointer",s)))}},underline:{get:()=>{var s,r;return(r=(s=this._currentLink)===null||s===void 0?void 0:s.state)===null||r===void 0?void 0:r.decorations.underline},set:s=>{var r,l,p;!((r=this._currentLink)===null||r===void 0)&&r.state&&((p=(l=this._currentLink)===null||l===void 0?void 0:l.state)===null||p===void 0?void 0:p.decorations.underline)!==s&&(this._currentLink.state.decorations.underline=s,this._currentLink.state.isHovered&&this._fireUnderlineEvent(t.link,s))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(s=>{if(!this._currentLink)return;const r=s.start===0?0:s.start+1+this._bufferService.buffer.ydisp,l=this._bufferService.buffer.ydisp+1+s.end;if(this._currentLink.link.range.start.y>=r&&this._currentLink.link.range.end.y<=l&&(this._clearCurrentLink(r,l),this._lastMouseEvent&&this._element)){const p=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);p&&this._askForLink(p,!1)}})))}_linkHover(t,h,s){var r;!((r=this._currentLink)===null||r===void 0)&&r.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(h,!0),this._currentLink.state.decorations.pointerCursor&&t.classList.add("xterm-cursor-pointer")),h.hover&&h.hover(s,h.text)}_fireUnderlineEvent(t,h){const s=t.range,r=this._bufferService.buffer.ydisp,l=this._createLinkUnderlineEvent(s.start.x-1,s.start.y-r-1,s.end.x,s.end.y-r-1,void 0);(h?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(l)}_linkLeave(t,h,s){var r;!((r=this._currentLink)===null||r===void 0)&&r.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(h,!1),this._currentLink.state.decorations.pointerCursor&&t.classList.remove("xterm-cursor-pointer")),h.leave&&h.leave(s,h.text)}_linkAtPosition(t,h){const s=t.range.start.y*this._bufferService.cols+t.range.start.x,r=t.range.end.y*this._bufferService.cols+t.range.end.x,l=h.y*this._bufferService.cols+h.x;return s<=l&&l<=r}_positionFromMouseEvent(t,h,s){const r=s.getCoords(t,h,this._bufferService.cols,this._bufferService.rows);if(r)return{x:r[0],y:r[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(t,h,s,r,l){return{x1:t,y1:h,x2:s,y2:r,cols:this._bufferService.cols,fg:l}}};o=m([f(0,u.IBufferService)],o),c.Linkifier2=o},9042:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.tooMuchOutput=c.promptLabel=void 0,c.promptLabel="Terminal input",c.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(q,c,S){var m=this&&this.__decorate||function(o,t,h,s){var r,l=arguments.length,p=l<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,h):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(o,t,h,s);else for(var g=o.length-1;g>=0;g--)(r=o[g])&&(p=(l<3?r(p):l>3?r(t,h,p):r(t,h))||p);return l>3&&p&&Object.defineProperty(t,h,p),p},f=this&&this.__param||function(o,t){return function(h,s){t(h,s,o)}};Object.defineProperty(c,"__esModule",{value:!0}),c.OscLinkProvider=void 0;const u=S(511),d=S(2585);let y=class{constructor(o,t,h){this._bufferService=o,this._optionsService=t,this._oscLinkService=h}provideLinks(o,t){var h;const s=this._bufferService.buffer.lines.get(o-1);if(!s)return void t(void 0);const r=[],l=this._optionsService.rawOptions.linkHandler,p=new u.CellData,g=s.getTrimmedLength();let w=-1,v=-1,b=!1;for(let L=0;L<g;L++)if(v!==-1||s.hasContent(L)){if(s.loadCell(L,p),p.hasExtendedAttrs()&&p.extended.urlId){if(v===-1){v=L,w=p.extended.urlId;continue}b=p.extended.urlId!==w}else v!==-1&&(b=!0);if(b||v!==-1&&L===g-1){const A=(h=this._oscLinkService.getLinkData(w))===null||h===void 0?void 0:h.uri;if(A){const T={start:{x:v+1,y:o},end:{x:L+(b||L!==g-1?0:1),y:o}};let B=!1;if(!(l!=null&&l.allowNonHttpProtocols))try{const U=new URL(A);["http:","https:"].includes(U.protocol)||(B=!0)}catch{B=!0}B||r.push({text:A,range:T,activate:(U,D)=>l?l.activate(U,D,T):_(0,D),hover:(U,D)=>{var F;return(F=l==null?void 0:l.hover)===null||F===void 0?void 0:F.call(l,U,D,T)},leave:(U,D)=>{var F;return(F=l==null?void 0:l.leave)===null||F===void 0?void 0:F.call(l,U,D,T)}})}b=!1,p.hasExtendedAttrs()&&p.extended.urlId?(v=L,w=p.extended.urlId):(v=-1,w=-1)}}t(r)}};function _(o,t){if(confirm(`Do you want to navigate to ${t}?

WARNING: This link could potentially be dangerous`)){const h=window.open();if(h){try{h.opener=null}catch{}h.location.href=t}else console.warn("Opening link blocked as opener could not be cleared")}}y=m([f(0,d.IBufferService),f(1,d.IOptionsService),f(2,d.IOscLinkService)],y),c.OscLinkProvider=y},6193:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.RenderDebouncer=void 0,c.RenderDebouncer=class{constructor(S,m){this._parentWindow=S,this._renderCallback=m,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(S){return this._refreshCallbacks.push(S),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(S,m,f){this._rowCount=f,S=S!==void 0?S:0,m=m!==void 0?m:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,S):S,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,m):m,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const S=Math.max(this._rowStart,0),m=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(S,m),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const S of this._refreshCallbacks)S(0);this._refreshCallbacks=[]}}},5596:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ScreenDprMonitor=void 0;const m=S(844);class f extends m.Disposable{constructor(d){super(),this._parentWindow=d,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,m.toDisposable)(()=>{this.clearListener()}))}setListener(d){this._listener&&this.clearListener(),this._listener=d,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var d;this._outerListener&&((d=this._resolutionMediaMatchList)===null||d===void 0||d.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}c.ScreenDprMonitor=f},3236:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Terminal=void 0;const m=S(2950),f=S(1680),u=S(3614),d=S(2584),y=S(5435),_=S(9312),o=S(6114),t=S(3656),h=S(9042),s=S(4567),r=S(1296),l=S(7399),p=S(8460),g=S(8437),w=S(3230),v=S(4725),b=S(428),L=S(8934),A=S(6465),T=S(5114),B=S(8969),U=S(8055),D=S(4269),F=S(5941),E=S(3107),I=S(5744),O=S(9074),P=S(2585),J=S(3730),j=S(844),X=S(6731),V=typeof window<"u"?window.document:null;class re extends B.CoreTerminal{constructor(z={}){super(z),this.browser=o,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._onCursorMove=this.register(new p.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new p.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new p.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new p.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new p.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new p.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new p.EventEmitter),this._onBlur=this.register(new p.EventEmitter),this._onA11yCharEmitter=this.register(new p.EventEmitter),this._onA11yTabEmitter=this.register(new p.EventEmitter),this._onWillOpen=this.register(new p.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(A.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(J.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(O.DecorationService),this._instantiationService.setService(P.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((W,te)=>this.refresh(W,te))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(W=>this._reportWindowsOptions(W))),this.register(this._inputHandler.onColor(W=>this._handleColorEvent(W))),this.register((0,p.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,p.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,p.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,p.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(W=>this._afterResize(W.cols,W.rows))),this.register((0,j.toDisposable)(()=>{var W,te;this._customKeyEventHandler=void 0,(te=(W=this.element)===null||W===void 0?void 0:W.parentNode)===null||te===void 0||te.removeChild(this.element)}))}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(z){if(this._themeService)for(const W of z){let te,ne="";switch(W.index){case 256:te="foreground",ne="10";break;case 257:te="background",ne="11";break;case 258:te="cursor",ne="12";break;default:te="ansi",ne="4;"+W.index}switch(W.type){case 0:const Se=U.color.toColorRGB(te==="ansi"?this._themeService.colors.ansi[W.index]:this._themeService.colors[te]);this.coreService.triggerDataEvent(`${d.C0.ESC}]${ne};${(0,F.toRgbString)(Se)}${d.C1_ESCAPED.ST}`);break;case 1:if(te==="ansi")this._themeService.modifyColors(ce=>ce.ansi[W.index]=U.rgba.toColor(...W.color));else{const ce=te;this._themeService.modifyColors(ke=>ke[ce]=U.rgba.toColor(...W.color))}break;case 2:this._themeService.restoreColor(W.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(z){var W;z?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=this._instantiationService.createInstance(s.AccessibilityManager,this)):((W=this._accessibilityManager)===null||W===void 0||W.dispose(),this._accessibilityManager=void 0)}_handleTextAreaFocus(z){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(d.C0.ESC+"[I"),this.updateCursorStyle(z),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var z;return(z=this.textarea)===null||z===void 0?void 0:z.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(d.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const z=this.buffer.ybase+this.buffer.y,W=this.buffer.lines.get(z);if(!W)return;const te=Math.min(this.buffer.x,this.cols-1),ne=this._renderService.dimensions.css.cell.height,Se=W.getWidth(te),ce=this._renderService.dimensions.css.cell.width*Se,ke=this.buffer.y*this._renderService.dimensions.css.cell.height,Q=te*this._renderService.dimensions.css.cell.width;this.textarea.style.left=Q+"px",this.textarea.style.top=ke+"px",this.textarea.style.width=ce+"px",this.textarea.style.height=ne+"px",this.textarea.style.lineHeight=ne+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,t.addDisposableDomListener)(this.element,"copy",W=>{this.hasSelection()&&(0,u.copyHandler)(W,this._selectionService)}));const z=W=>(0,u.handlePasteEvent)(W,this.textarea,this.coreService);this.register((0,t.addDisposableDomListener)(this.textarea,"paste",z)),this.register((0,t.addDisposableDomListener)(this.element,"paste",z)),o.isFirefox?this.register((0,t.addDisposableDomListener)(this.element,"mousedown",W=>{W.button===2&&(0,u.rightClickHandler)(W,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,t.addDisposableDomListener)(this.element,"contextmenu",W=>{(0,u.rightClickHandler)(W,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),o.isLinux&&this.register((0,t.addDisposableDomListener)(this.element,"auxclick",W=>{W.button===1&&(0,u.moveTextAreaUnderMouseCursor)(W,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,t.addDisposableDomListener)(this.textarea,"keyup",z=>this._keyUp(z),!0)),this.register((0,t.addDisposableDomListener)(this.textarea,"keydown",z=>this._keyDown(z),!0)),this.register((0,t.addDisposableDomListener)(this.textarea,"keypress",z=>this._keyPress(z),!0)),this.register((0,t.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,t.addDisposableDomListener)(this.textarea,"compositionupdate",z=>this._compositionHelper.compositionupdate(z))),this.register((0,t.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,t.addDisposableDomListener)(this.textarea,"input",z=>this._inputEvent(z),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(z){var W;if(!z)throw new Error("Terminal requires a parent element.");z.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=z.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),z.appendChild(this.element);const te=V.createDocumentFragment();this._viewportElement=V.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),te.appendChild(this._viewportElement),this._viewportScrollArea=V.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=V.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=V.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),te.appendChild(this.screenElement),this.textarea=V.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",h.promptLabel),o.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(T.CoreBrowserService,this.textarea,(W=this._document.defaultView)!==null&&W!==void 0?W:window),this._instantiationService.setService(v.ICoreBrowserService,this._coreBrowserService),this.register((0,t.addDisposableDomListener)(this.textarea,"focus",ne=>this._handleTextAreaFocus(ne))),this.register((0,t.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(b.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(v.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(X.ThemeService),this._instantiationService.setService(v.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(D.CharacterJoinerService),this._instantiationService.setService(v.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(w.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(v.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(ne=>this._onRender.fire(ne))),this.onResize(ne=>this._renderService.resize(ne.cols,ne.rows)),this._compositionView=V.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(m.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(te);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(L.MouseService),this._instantiationService.setService(v.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(f.Viewport,ne=>this.scrollLines(ne,!0,1),this._viewportElement,this._viewportScrollArea),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(_.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(v.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(ne=>this.scrollLines(ne.amount,ne.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(ne=>this._renderService.handleSelectionChanged(ne.start,ne.end,ne.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(ne=>{this.textarea.value=ne,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(ne=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,t.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(E.BufferDecorationRenderer,this.screenElement)),this.register((0,t.addDisposableDomListener)(this.element,"mousedown",ne=>this._selectionService.handleMouseDown(ne))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=this._instantiationService.createInstance(s.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",ne=>this._handleScreenReaderModeOptionChange(ne))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(I.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",ne=>{!this._overviewRulerRenderer&&ne&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(I.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(r.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const z=this,W=this.element;function te(ce){const ke=z._mouseService.getMouseReportCoords(ce,z.screenElement);if(!ke)return!1;let Q,Le;switch(ce.overrideType||ce.type){case"mousemove":Le=32,ce.buttons===void 0?(Q=3,ce.button!==void 0&&(Q=ce.button<3?ce.button:3)):Q=1&ce.buttons?0:4&ce.buttons?1:2&ce.buttons?2:3;break;case"mouseup":Le=0,Q=ce.button<3?ce.button:3;break;case"mousedown":Le=1,Q=ce.button<3?ce.button:3;break;case"wheel":if(z.viewport.getLinesScrolled(ce)===0)return!1;Le=ce.deltaY<0?0:1,Q=4;break;default:return!1}return!(Le===void 0||Q===void 0||Q>4)&&z.coreMouseService.triggerMouseEvent({col:ke.col,row:ke.row,x:ke.x,y:ke.y,button:Q,action:Le,ctrl:ce.ctrlKey,alt:ce.altKey,shift:ce.shiftKey})}const ne={mouseup:null,wheel:null,mousedrag:null,mousemove:null},Se={mouseup:ce=>(te(ce),ce.buttons||(this._document.removeEventListener("mouseup",ne.mouseup),ne.mousedrag&&this._document.removeEventListener("mousemove",ne.mousedrag)),this.cancel(ce)),wheel:ce=>(te(ce),this.cancel(ce,!0)),mousedrag:ce=>{ce.buttons&&te(ce)},mousemove:ce=>{ce.buttons||te(ce)}};this.register(this.coreMouseService.onProtocolChange(ce=>{ce?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(ce)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&ce?ne.mousemove||(W.addEventListener("mousemove",Se.mousemove),ne.mousemove=Se.mousemove):(W.removeEventListener("mousemove",ne.mousemove),ne.mousemove=null),16&ce?ne.wheel||(W.addEventListener("wheel",Se.wheel,{passive:!1}),ne.wheel=Se.wheel):(W.removeEventListener("wheel",ne.wheel),ne.wheel=null),2&ce?ne.mouseup||(ne.mouseup=Se.mouseup):(this._document.removeEventListener("mouseup",ne.mouseup),ne.mouseup=null),4&ce?ne.mousedrag||(ne.mousedrag=Se.mousedrag):(this._document.removeEventListener("mousemove",ne.mousedrag),ne.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,t.addDisposableDomListener)(W,"mousedown",ce=>{if(ce.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(ce))return te(ce),ne.mouseup&&this._document.addEventListener("mouseup",ne.mouseup),ne.mousedrag&&this._document.addEventListener("mousemove",ne.mousedrag),this.cancel(ce)})),this.register((0,t.addDisposableDomListener)(W,"wheel",ce=>{if(!ne.wheel){if(!this.buffer.hasScrollback){const ke=this.viewport.getLinesScrolled(ce);if(ke===0)return;const Q=d.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(ce.deltaY<0?"A":"B");let Le="";for(let fe=0;fe<Math.abs(ke);fe++)Le+=Q;return this.coreService.triggerDataEvent(Le,!0),this.cancel(ce,!0)}return this.viewport.handleWheel(ce)?this.cancel(ce):void 0}},{passive:!1})),this.register((0,t.addDisposableDomListener)(W,"touchstart",ce=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(ce),this.cancel(ce)},{passive:!0})),this.register((0,t.addDisposableDomListener)(W,"touchmove",ce=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(ce)?void 0:this.cancel(ce)},{passive:!1}))}refresh(z,W){var te;(te=this._renderService)===null||te===void 0||te.refreshRows(z,W)}updateCursorStyle(z){var W;!((W=this._selectionService)===null||W===void 0)&&W.shouldColumnSelect(z)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(z,W,te=0){super.scrollLines(z,W,te),this.refresh(0,this.rows-1)}paste(z){(0,u.paste)(z,this.textarea,this.coreService)}attachCustomKeyEventHandler(z){this._customKeyEventHandler=z}registerLinkProvider(z){return this.linkifier2.registerLinkProvider(z)}registerCharacterJoiner(z){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const W=this._characterJoinerService.register(z);return this.refresh(0,this.rows-1),W}deregisterCharacterJoiner(z){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(z)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}addMarker(z){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+z)}registerDecoration(z){return this._decorationService.registerDecoration(z)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(z,W,te){this._selectionService.setSelection(z,W,te)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var z;(z=this._selectionService)===null||z===void 0||z.clearSelection()}selectAll(){var z;(z=this._selectionService)===null||z===void 0||z.selectAll()}selectLines(z,W){var te;(te=this._selectionService)===null||te===void 0||te.selectLines(z,W)}_keyDown(z){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(z)===!1)return!1;const W=this.browser.isMac&&this.options.macOptionIsMeta&&z.altKey;if(!W&&!this._compositionHelper.keydown(z))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;W||z.key!=="Dead"&&z.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const te=(0,l.evaluateKeyboardEvent)(z,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(z),te.type===3||te.type===2){const ne=this.rows-1;return this.scrollLines(te.type===2?-ne:ne),this.cancel(z,!0)}return te.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,z)||(te.cancel&&this.cancel(z,!0),!te.key||!!(z.key&&!z.ctrlKey&&!z.altKey&&!z.metaKey&&z.key.length===1&&z.key.charCodeAt(0)>=65&&z.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(te.key!==d.C0.ETX&&te.key!==d.C0.CR||(this.textarea.value=""),this._onKey.fire({key:te.key,domEvent:z}),this._showCursor(),this.coreService.triggerDataEvent(te.key,!0),!this.optionsService.rawOptions.screenReaderMode||z.altKey||z.ctrlKey?this.cancel(z,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(z,W){const te=z.isMac&&!this.options.macOptionIsMeta&&W.altKey&&!W.ctrlKey&&!W.metaKey||z.isWindows&&W.altKey&&W.ctrlKey&&!W.metaKey||z.isWindows&&W.getModifierState("AltGraph");return W.type==="keypress"?te:te&&(!W.keyCode||W.keyCode>47)}_keyUp(z){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(z)===!1||(function(W){return W.keyCode===16||W.keyCode===17||W.keyCode===18}(z)||this.focus(),this.updateCursorStyle(z),this._keyPressHandled=!1)}_keyPress(z){let W;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(z)===!1)return!1;if(this.cancel(z),z.charCode)W=z.charCode;else if(z.which===null||z.which===void 0)W=z.keyCode;else{if(z.which===0||z.charCode===0)return!1;W=z.which}return!(!W||(z.altKey||z.ctrlKey||z.metaKey)&&!this._isThirdLevelShift(this.browser,z)||(W=String.fromCharCode(W),this._onKey.fire({key:W,domEvent:z}),this._showCursor(),this.coreService.triggerDataEvent(W,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(z){if(z.data&&z.inputType==="insertText"&&(!z.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const W=z.data;return this.coreService.triggerDataEvent(W,!0),this.cancel(z),!0}return!1}resize(z,W){z!==this.cols||W!==this.rows?super.resize(z,W):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(z,W){var te,ne;(te=this._charSizeService)===null||te===void 0||te.measure(),(ne=this.viewport)===null||ne===void 0||ne.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let z=1;z<this.rows;z++)this.buffer.lines.push(this.buffer.getBlankLine(g.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}}reset(){var z,W;this.options.rows=this.rows,this.options.cols=this.cols;const te=this._customKeyEventHandler;this._setup(),super.reset(),(z=this._selectionService)===null||z===void 0||z.reset(),this._decorationService.reset(),this._customKeyEventHandler=te,this.refresh(0,this.rows-1),(W=this.viewport)===null||W===void 0||W.syncScrollArea()}clearTextureAtlas(){var z;(z=this._renderService)===null||z===void 0||z.clearTextureAtlas()}_reportFocus(){var z;!((z=this.element)===null||z===void 0)&&z.classList.contains("focus")?this.coreService.triggerDataEvent(d.C0.ESC+"[I"):this.coreService.triggerDataEvent(d.C0.ESC+"[O")}_reportWindowsOptions(z){if(this._renderService)switch(z){case y.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const W=this._renderService.dimensions.css.canvas.width.toFixed(0),te=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${d.C0.ESC}[4;${te};${W}t`);break;case y.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const ne=this._renderService.dimensions.css.cell.width.toFixed(0),Se=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${d.C0.ESC}[6;${Se};${ne}t`)}}cancel(z,W){if(this.options.cancelEvents||W)return z.preventDefault(),z.stopPropagation(),!1}}c.Terminal=re},9924:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TimeBasedDebouncer=void 0,c.TimeBasedDebouncer=class{constructor(S,m=1e3){this._renderCallback=S,this._debounceThresholdMS=m,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(S,m,f){this._rowCount=f,S=S!==void 0?S:0,m=m!==void 0?m:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,S):S,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,m):m;const u=Date.now();if(u-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=u,this._innerRefresh();else if(!this._additionalRefreshRequested){const d=u-this._lastRefreshMs,y=this._debounceThresholdMS-d;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},y)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const S=Math.max(this._rowStart,0),m=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(S,m)}}},1680:function(q,c,S){var m=this&&this.__decorate||function(t,h,s,r){var l,p=arguments.length,g=p<3?h:r===null?r=Object.getOwnPropertyDescriptor(h,s):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(t,h,s,r);else for(var w=t.length-1;w>=0;w--)(l=t[w])&&(g=(p<3?l(g):p>3?l(h,s,g):l(h,s))||g);return p>3&&g&&Object.defineProperty(h,s,g),g},f=this&&this.__param||function(t,h){return function(s,r){h(s,r,t)}};Object.defineProperty(c,"__esModule",{value:!0}),c.Viewport=void 0;const u=S(844),d=S(3656),y=S(4725),_=S(2585);let o=class extends u.Disposable{constructor(t,h,s,r,l,p,g,w,v){super(),this._scrollLines=t,this._viewportElement=h,this._scrollArea=s,this._bufferService=r,this._optionsService=l,this._charSizeService=p,this._renderService=g,this._coreBrowserService=w,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,d.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(b=>this._activeBuffer=b.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(b=>this._renderDimensions=b)),this._handleThemeChange(v.colors),this.register(v.onChangeColors(b=>this._handleThemeChange(b))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea(),0)}_handleThemeChange(t){this._viewportElement.style.backgroundColor=t.background.css}_refresh(t){if(t)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const h=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==h&&(this._lastRecordedBufferHeight=h,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const t=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==t&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=t),this._refreshAnimationFrame=null}syncScrollArea(t=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(t);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(t)}_handleScroll(t){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);const h=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(h)}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const t=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(t*(this._smoothScrollState.target-this._smoothScrollState.origin)),t<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(t,h){const s=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(h<0&&this._viewportElement.scrollTop!==0||h>0&&s<this._lastRecordedBufferHeight)||(t.cancelable&&t.preventDefault(),!1)}handleWheel(t){const h=this._getPixelsScrolled(t);return h!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+h:this._smoothScrollState.target+=h,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=h,this._bubbleScroll(t,h))}_getPixelsScrolled(t){if(t.deltaY===0||t.shiftKey)return 0;let h=this._applyScrollModifier(t.deltaY,t);return t.deltaMode===WheelEvent.DOM_DELTA_LINE?h*=this._currentRowHeight:t.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(h*=this._currentRowHeight*this._bufferService.rows),h}getBufferElements(t,h){var s;let r,l="";const p=[],g=h??this._bufferService.buffer.lines.length,w=this._bufferService.buffer.lines;for(let v=t;v<g;v++){const b=w.get(v);if(!b)continue;const L=(s=w.get(v+1))===null||s===void 0?void 0:s.isWrapped;if(l+=b.translateToString(!L),!L||v===w.length-1){const A=document.createElement("div");A.textContent=l,p.push(A),l.length>0&&(r=A),l=""}}return{bufferElements:p,cursorElement:r}}getLinesScrolled(t){if(t.deltaY===0||t.shiftKey)return 0;let h=this._applyScrollModifier(t.deltaY,t);return t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(h/=this._currentRowHeight+0,this._wheelPartialScroll+=h,h=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):t.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(h*=this._bufferService.rows),h}_applyScrollModifier(t,h){const s=this._optionsService.rawOptions.fastScrollModifier;return s==="alt"&&h.altKey||s==="ctrl"&&h.ctrlKey||s==="shift"&&h.shiftKey?t*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:t*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(t){this._lastTouchY=t.touches[0].pageY}handleTouchMove(t){const h=this._lastTouchY-t.touches[0].pageY;return this._lastTouchY=t.touches[0].pageY,h!==0&&(this._viewportElement.scrollTop+=h,this._bubbleScroll(t,h))}};o=m([f(3,_.IBufferService),f(4,_.IOptionsService),f(5,y.ICharSizeService),f(6,y.IRenderService),f(7,y.ICoreBrowserService),f(8,y.IThemeService)],o),c.Viewport=o},3107:function(q,c,S){var m=this&&this.__decorate||function(t,h,s,r){var l,p=arguments.length,g=p<3?h:r===null?r=Object.getOwnPropertyDescriptor(h,s):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(t,h,s,r);else for(var w=t.length-1;w>=0;w--)(l=t[w])&&(g=(p<3?l(g):p>3?l(h,s,g):l(h,s))||g);return p>3&&g&&Object.defineProperty(h,s,g),g},f=this&&this.__param||function(t,h){return function(s,r){h(s,r,t)}};Object.defineProperty(c,"__esModule",{value:!0}),c.BufferDecorationRenderer=void 0;const u=S(3656),d=S(4725),y=S(844),_=S(2585);let o=class extends y.Disposable{constructor(t,h,s,r){super(),this._screenElement=t,this._bufferService=h,this._decorationService=s,this._renderService=r,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,u.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(l=>this._removeDecoration(l))),this.register((0,y.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const t of this._decorationService.decorations)this._renderDecoration(t);this._dimensionsChanged=!1}_renderDecoration(t){this._refreshStyle(t),this._dimensionsChanged&&this._refreshXPosition(t)}_createElement(t){var h,s;const r=document.createElement("div");r.classList.add("xterm-decoration"),r.classList.toggle("xterm-decoration-top-layer",((h=t==null?void 0:t.options)===null||h===void 0?void 0:h.layer)==="top"),r.style.width=`${Math.round((t.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,r.style.height=(t.options.height||1)*this._renderService.dimensions.css.cell.height+"px",r.style.top=(t.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",r.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const l=(s=t.options.x)!==null&&s!==void 0?s:0;return l&&l>this._bufferService.cols&&(r.style.display="none"),this._refreshXPosition(t,r),r}_refreshStyle(t){const h=t.marker.line-this._bufferService.buffers.active.ydisp;if(h<0||h>=this._bufferService.rows)t.element&&(t.element.style.display="none",t.onRenderEmitter.fire(t.element));else{let s=this._decorationElements.get(t);s||(s=this._createElement(t),t.element=s,this._decorationElements.set(t,s),this._container.appendChild(s)),s.style.top=h*this._renderService.dimensions.css.cell.height+"px",s.style.display=this._altBufferIsActive?"none":"block",t.onRenderEmitter.fire(s)}}_refreshXPosition(t,h=t.element){var s;if(!h)return;const r=(s=t.options.x)!==null&&s!==void 0?s:0;(t.options.anchor||"left")==="right"?h.style.right=r?r*this._renderService.dimensions.css.cell.width+"px":"":h.style.left=r?r*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(t){var h;(h=this._decorationElements.get(t))===null||h===void 0||h.remove(),this._decorationElements.delete(t),t.dispose()}};o=m([f(1,_.IBufferService),f(2,_.IDecorationService),f(3,d.IRenderService)],o),c.BufferDecorationRenderer=o},5871:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ColorZoneStore=void 0,c.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(S){if(S.options.overviewRulerOptions){for(const m of this._zones)if(m.color===S.options.overviewRulerOptions.color&&m.position===S.options.overviewRulerOptions.position){if(this._lineIntersectsZone(m,S.marker.line))return;if(this._lineAdjacentToZone(m,S.marker.line,S.options.overviewRulerOptions.position))return void this._addLineToZone(m,S.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=S.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=S.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=S.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=S.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:S.options.overviewRulerOptions.color,position:S.options.overviewRulerOptions.position,startBufferLine:S.marker.line,endBufferLine:S.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(S){this._linePadding=S}_lineIntersectsZone(S,m){return m>=S.startBufferLine&&m<=S.endBufferLine}_lineAdjacentToZone(S,m,f){return m>=S.startBufferLine-this._linePadding[f||"full"]&&m<=S.endBufferLine+this._linePadding[f||"full"]}_addLineToZone(S,m){S.startBufferLine=Math.min(S.startBufferLine,m),S.endBufferLine=Math.max(S.endBufferLine,m)}}},5744:function(q,c,S){var m=this&&this.__decorate||function(l,p,g,w){var v,b=arguments.length,L=b<3?p:w===null?w=Object.getOwnPropertyDescriptor(p,g):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(l,p,g,w);else for(var A=l.length-1;A>=0;A--)(v=l[A])&&(L=(b<3?v(L):b>3?v(p,g,L):v(p,g))||L);return b>3&&L&&Object.defineProperty(p,g,L),L},f=this&&this.__param||function(l,p){return function(g,w){p(g,w,l)}};Object.defineProperty(c,"__esModule",{value:!0}),c.OverviewRulerRenderer=void 0;const u=S(5871),d=S(3656),y=S(4725),_=S(844),o=S(2585),t={full:0,left:0,center:0,right:0},h={full:0,left:0,center:0,right:0},s={full:0,left:0,center:0,right:0};let r=class extends _.Disposable{constructor(l,p,g,w,v,b,L){var A;super(),this._viewportElement=l,this._screenElement=p,this._bufferService=g,this._decorationService=w,this._renderService=v,this._optionsService=b,this._coreBrowseService=L,this._colorZoneStore=new u.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(A=this._viewportElement.parentElement)===null||A===void 0||A.insertBefore(this._canvas,this._viewportElement);const T=this._canvas.getContext("2d");if(!T)throw new Error("Ctx cannot be null");this._ctx=T,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,_.toDisposable)(()=>{var B;(B=this._canvas)===null||B===void 0||B.remove()}))}get _width(){return this._optionsService.options.overviewRulerWidth||0}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,d.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const l=Math.floor(this._canvas.width/3),p=Math.ceil(this._canvas.width/3);h.full=this._canvas.width,h.left=l,h.center=p,h.right=l,this._refreshDrawHeightConstants(),s.full=0,s.left=0,s.center=h.left,s.right=h.left+h.center}_refreshDrawHeightConstants(){t.full=Math.round(2*this._coreBrowseService.dpr);const l=this._canvas.height/this._bufferService.buffer.lines.length,p=Math.round(Math.max(Math.min(l,12),6)*this._coreBrowseService.dpr);t.left=p,t.center=p,t.right=p}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*t.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const p of this._decorationService.decorations)this._colorZoneStore.addDecoration(p);this._ctx.lineWidth=1;const l=this._colorZoneStore.zones;for(const p of l)p.position!=="full"&&this._renderColorZone(p);for(const p of l)p.position==="full"&&this._renderColorZone(p);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(l){this._ctx.fillStyle=l.color,this._ctx.fillRect(s[l.position||"full"],Math.round((this._canvas.height-1)*(l.startBufferLine/this._bufferService.buffers.active.lines.length)-t[l.position||"full"]/2),h[l.position||"full"],Math.round((this._canvas.height-1)*((l.endBufferLine-l.startBufferLine)/this._bufferService.buffers.active.lines.length)+t[l.position||"full"]))}_queueRefresh(l,p){this._shouldUpdateDimensions=l||this._shouldUpdateDimensions,this._shouldUpdateAnchor=p||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};r=m([f(2,o.IBufferService),f(3,o.IDecorationService),f(4,y.IRenderService),f(5,o.IOptionsService),f(6,y.ICoreBrowserService)],r),c.OverviewRulerRenderer=r},2950:function(q,c,S){var m=this&&this.__decorate||function(o,t,h,s){var r,l=arguments.length,p=l<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,h):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(o,t,h,s);else for(var g=o.length-1;g>=0;g--)(r=o[g])&&(p=(l<3?r(p):l>3?r(t,h,p):r(t,h))||p);return l>3&&p&&Object.defineProperty(t,h,p),p},f=this&&this.__param||function(o,t){return function(h,s){t(h,s,o)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CompositionHelper=void 0;const u=S(4725),d=S(2585),y=S(2584);let _=class{constructor(o,t,h,s,r,l){this._textarea=o,this._compositionView=t,this._bufferService=h,this._optionsService=s,this._coreService=r,this._renderService=l,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(o){this._compositionView.textContent=o.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(o){if(this._isComposing||this._isSendingComposition){if(o.keyCode===229||o.keyCode===16||o.keyCode===17||o.keyCode===18)return!1;this._finalizeComposition(!1)}return o.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(o){if(this._compositionView.classList.remove("active"),this._isComposing=!1,o){const t={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let h;if(this._isSendingComposition=!1,t.start+=this._dataAlreadySent.length,this._isComposing)h=this._textarea.value.substring(t.start,t.end);else{const s=this._textarea.value.length-t.start;h=this._textarea.value.substring(0,s)}h.length>0&&this._coreService.triggerDataEvent(h,!0)}},0)}else{this._isSendingComposition=!1;const t=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(t,!0)}}_handleAnyTextareaChanges(){const o=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const t=this._textarea.value,h=t.replace(o,"");this._dataAlreadySent=h,t.length>o.length?this._coreService.triggerDataEvent(h,!0):t.length<o.length?this._coreService.triggerDataEvent(`${y.C0.DEL}`,!0):t.length===o.length&&t!==o&&this._coreService.triggerDataEvent(t,!0)}},0)}updateCompositionElements(o){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const t=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),h=this._renderService.dimensions.css.cell.height,s=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,r=t*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=r+"px",this._compositionView.style.top=s+"px",this._compositionView.style.height=h+"px",this._compositionView.style.lineHeight=h+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const l=this._compositionView.getBoundingClientRect();this._textarea.style.left=r+"px",this._textarea.style.top=s+"px",this._textarea.style.width=Math.max(l.width,1)+"px",this._textarea.style.height=Math.max(l.height,1)+"px",this._textarea.style.lineHeight=l.height+"px"}o||setTimeout(()=>this.updateCompositionElements(!0),0)}}};_=m([f(2,d.IBufferService),f(3,d.IOptionsService),f(4,d.ICoreService),f(5,u.IRenderService)],_),c.CompositionHelper=_},9806:(q,c)=>{function S(m,f,u){const d=u.getBoundingClientRect(),y=m.getComputedStyle(u),_=parseInt(y.getPropertyValue("padding-left")),o=parseInt(y.getPropertyValue("padding-top"));return[f.clientX-d.left-_,f.clientY-d.top-o]}Object.defineProperty(c,"__esModule",{value:!0}),c.getCoords=c.getCoordsRelativeToElement=void 0,c.getCoordsRelativeToElement=S,c.getCoords=function(m,f,u,d,y,_,o,t,h){if(!_)return;const s=S(m,f,u);return s?(s[0]=Math.ceil((s[0]+(h?o/2:0))/o),s[1]=Math.ceil(s[1]/t),s[0]=Math.min(Math.max(s[0],1),d+(h?1:0)),s[1]=Math.min(Math.max(s[1],1),y),s):void 0}},9504:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.moveToCellSequence=void 0;const m=S(2584);function f(t,h,s,r){const l=t-u(t,s),p=h-u(h,s),g=Math.abs(l-p)-function(w,v,b){let L=0;const A=w-u(w,b),T=v-u(v,b);for(let B=0;B<Math.abs(A-T);B++){const U=d(w,v)==="A"?-1:1,D=b.buffer.lines.get(A+U*B);D!=null&&D.isWrapped&&L++}return L}(t,h,s);return o(g,_(d(t,h),r))}function u(t,h){let s=0,r=h.buffer.lines.get(t),l=r==null?void 0:r.isWrapped;for(;l&&t>=0&&t<h.rows;)s++,r=h.buffer.lines.get(--t),l=r==null?void 0:r.isWrapped;return s}function d(t,h){return t>h?"A":"B"}function y(t,h,s,r,l,p){let g=t,w=h,v="";for(;g!==s||w!==r;)g+=l?1:-1,l&&g>p.cols-1?(v+=p.buffer.translateBufferLineToString(w,!1,t,g),g=0,t=0,w++):!l&&g<0&&(v+=p.buffer.translateBufferLineToString(w,!1,0,t+1),g=p.cols-1,t=g,w--);return v+p.buffer.translateBufferLineToString(w,!1,t,g)}function _(t,h){const s=h?"O":"[";return m.C0.ESC+s+t}function o(t,h){t=Math.floor(t);let s="";for(let r=0;r<t;r++)s+=h;return s}c.moveToCellSequence=function(t,h,s,r){const l=s.buffer.x,p=s.buffer.y;if(!s.buffer.hasScrollback)return function(v,b,L,A,T,B){return f(b,A,T,B).length===0?"":o(y(v,b,v,b-u(b,T),!1,T).length,_("D",B))}(l,p,0,h,s,r)+f(p,h,s,r)+function(v,b,L,A,T,B){let U;U=f(b,A,T,B).length>0?A-u(A,T):b;const D=A,F=function(E,I,O,P,J,j){let X;return X=f(O,P,J,j).length>0?P-u(P,J):I,E<O&&X<=P||E>=O&&X<P?"C":"D"}(v,b,L,A,T,B);return o(y(v,U,L,D,F==="C",T).length,_(F,B))}(l,p,t,h,s,r);let g;if(p===h)return g=l>t?"D":"C",o(Math.abs(l-t),_(g,r));g=p>h?"D":"C";const w=Math.abs(p-h);return o(function(v,b){return b.cols-v}(p>h?t:l,s)+(w-1)*s.cols+1+((p>h?l:t)-1),_(g,r))}},1296:function(q,c,S){var m=this&&this.__decorate||function(w,v,b,L){var A,T=arguments.length,B=T<3?v:L===null?L=Object.getOwnPropertyDescriptor(v,b):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(w,v,b,L);else for(var U=w.length-1;U>=0;U--)(A=w[U])&&(B=(T<3?A(B):T>3?A(v,b,B):A(v,b))||B);return T>3&&B&&Object.defineProperty(v,b,B),B},f=this&&this.__param||function(w,v){return function(b,L){v(b,L,w)}};Object.defineProperty(c,"__esModule",{value:!0}),c.DomRenderer=void 0;const u=S(3787),d=S(2223),y=S(6171),_=S(4725),o=S(8055),t=S(8460),h=S(844),s=S(2585),r="xterm-dom-renderer-owner-",l="xterm-focus";let p=1,g=class extends h.Disposable{constructor(w,v,b,L,A,T,B,U,D,F){super(),this._element=w,this._screenElement=v,this._viewportElement=b,this._linkifier2=L,this._charSizeService=T,this._optionsService=B,this._bufferService=U,this._coreBrowserService=D,this._themeService=F,this._terminalClass=p++,this._rowElements=[],this._cellToRowElements=[],this.onRequestRedraw=this.register(new t.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add("xterm-rows"),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add("xterm-selection"),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,y.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(E=>this._injectCss(E))),this._injectCss(this._themeService.colors),this._rowFactory=A.createInstance(u.DomRendererRowFactory,document),this._element.classList.add(r+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(E=>this._handleLinkHover(E))),this.register(this._linkifier2.onHideLinkUnderline(E=>this._handleLinkLeave(E))),this.register((0,h.toDisposable)(()=>{this._element.classList.remove(r+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()}))}_updateDimensions(){const w=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*w,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*w),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/w),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/w),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const b of this._rowElements)b.style.width=`${this.dimensions.css.canvas.width}px`,b.style.height=`${this.dimensions.css.cell.height}px`,b.style.lineHeight=`${this.dimensions.css.cell.height}px`,b.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const v=`${this._terminalSelector} .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: ${this.dimensions.css.cell.width}px}`;this._dimensionsStyleElement.textContent=v,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(w){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let v=`${this._terminalSelector} .xterm-rows { color: ${w.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px;}`;v+=`${this._terminalSelector} .xterm-rows .xterm-dim { color: ${o.color.multiplyOpacity(w.foreground,.5).css};}`,v+=`${this._terminalSelector} span:not(.${u.BOLD_CLASS}) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.${u.BOLD_CLASS} { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.${u.ITALIC_CLASS} { font-style: italic;}`,v+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",v+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${w.cursor.css};  color: ${w.cursorAccent.css}; } 50% {  background-color: ${w.cursorAccent.css};  color: ${w.cursor.css}; }}`,v+=`${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_BLOCK_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_BAR_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_UNDERLINE_CLASS} { outline: 1px solid ${w.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .xterm-rows.xterm-focus .${u.CURSOR_CLASS}.${u.CURSOR_BLINK_CLASS}:not(.${u.CURSOR_STYLE_BLOCK_CLASS}) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${u.CURSOR_CLASS}.${u.CURSOR_BLINK_CLASS}.${u.CURSOR_STYLE_BLOCK_CLASS} { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_BLOCK_CLASS} { background-color: ${w.cursor.css}; color: ${w.cursorAccent.css};}${this._terminalSelector} .xterm-rows .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_BAR_CLASS} { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${w.cursor.css} inset;}${this._terminalSelector} .xterm-rows .${u.CURSOR_CLASS}.${u.CURSOR_STYLE_UNDERLINE_CLASS} { box-shadow: 0 -1px 0 ${w.cursor.css} inset;}`,v+=`${this._terminalSelector} .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .xterm-selection div { position: absolute; background-color: ${w.selectionBackgroundOpaque.css};}${this._terminalSelector} .xterm-selection div { position: absolute; background-color: ${w.selectionInactiveBackgroundOpaque.css};}`;for(const[b,L]of w.ansi.entries())v+=`${this._terminalSelector} .xterm-fg-${b} { color: ${L.css}; }${this._terminalSelector} .xterm-fg-${b}.${u.DIM_CLASS} { color: ${o.color.multiplyOpacity(L,.5).css}; }${this._terminalSelector} .xterm-bg-${b} { background-color: ${L.css}; }`;v+=`${this._terminalSelector} .xterm-fg-${d.INVERTED_DEFAULT_COLOR} { color: ${o.color.opaque(w.background).css}; }${this._terminalSelector} .xterm-fg-${d.INVERTED_DEFAULT_COLOR}.${u.DIM_CLASS} { color: ${o.color.multiplyOpacity(o.color.opaque(w.background),.5).css}; }${this._terminalSelector} .xterm-bg-${d.INVERTED_DEFAULT_COLOR} { background-color: ${w.foreground.css}; }`,this._themeStyleElement.textContent=v}handleDevicePixelRatioChange(){this._updateDimensions()}_refreshRowElements(w,v){for(let b=this._rowElements.length;b<=v;b++){const L=document.createElement("div");this._rowContainer.appendChild(L),this._rowElements.push(L)}for(;this._rowElements.length>v;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(w,v){this._refreshRowElements(w,v),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions()}handleBlur(){this._rowContainer.classList.remove(l)}handleFocus(){this._rowContainer.classList.add(l)}handleSelectionChanged(w,v,b){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(this._rowFactory.handleSelectionChanged(w,v,b),this.renderRows(0,this._bufferService.rows-1),!w||!v)return;const L=w[1]-this._bufferService.buffer.ydisp,A=v[1]-this._bufferService.buffer.ydisp,T=Math.max(L,0),B=Math.min(A,this._bufferService.rows-1);if(T>=this._bufferService.rows||B<0)return;const U=document.createDocumentFragment();if(b){const D=w[0]>v[0];U.appendChild(this._createSelectionElement(T,D?v[0]:w[0],D?w[0]:v[0],B-T+1))}else{const D=L===T?w[0]:0,F=T===A?v[0]:this._bufferService.cols;U.appendChild(this._createSelectionElement(T,D,F));const E=B-T-1;if(U.appendChild(this._createSelectionElement(T+1,0,this._bufferService.cols,E)),T!==B){const I=A===B?v[0]:this._bufferService.cols;U.appendChild(this._createSelectionElement(B,0,I))}}this._selectionContainer.appendChild(U)}_createSelectionElement(w,v,b,L=1){const A=document.createElement("div");return A.style.height=L*this.dimensions.css.cell.height+"px",A.style.top=w*this.dimensions.css.cell.height+"px",A.style.left=v*this.dimensions.css.cell.width+"px",A.style.width=this.dimensions.css.cell.width*(b-v)+"px",A}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors)}clear(){for(const w of this._rowElements)w.replaceChildren()}renderRows(w,v){const b=this._bufferService.buffer.ybase+this._bufferService.buffer.y,L=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),A=this._optionsService.rawOptions.cursorBlink;for(let T=w;T<=v;T++){const B=this._rowElements[T],U=T+this._bufferService.buffer.ydisp,D=this._bufferService.buffer.lines.get(U),F=this._optionsService.rawOptions.cursorStyle;this._cellToRowElements[T]&&this._cellToRowElements[T].length===this._bufferService.cols||(this._cellToRowElements[T]=new Int16Array(this._bufferService.cols)),B.replaceChildren(this._rowFactory.createRow(D,U,U===b,F,L,A,this.dimensions.css.cell.width,this._bufferService.cols,this._cellToRowElements[T]))}}get _terminalSelector(){return`.${r}${this._terminalClass}`}_handleLinkHover(w){this._setCellUnderline(w.x1,w.x2,w.y1,w.y2,w.cols,!0)}_handleLinkLeave(w){this._setCellUnderline(w.x1,w.x2,w.y1,w.y2,w.cols,!1)}_setCellUnderline(w,v,b,L,A,T){if(w=this._cellToRowElements[b][w],v=this._cellToRowElements[L][v],w!==-1&&v!==-1)for(;w!==v||b!==L;){const B=this._rowElements[b];if(!B)return;const U=B.children[w];U&&(U.style.textDecoration=T?"underline":"none"),++w>=A&&(w=0,b++)}}};g=m([f(4,s.IInstantiationService),f(5,_.ICharSizeService),f(6,s.IOptionsService),f(7,s.IBufferService),f(8,_.ICoreBrowserService),f(9,_.IThemeService)],g),c.DomRenderer=g},3787:function(q,c,S){var m=this&&this.__decorate||function(g,w,v,b){var L,A=arguments.length,T=A<3?w:b===null?b=Object.getOwnPropertyDescriptor(w,v):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(g,w,v,b);else for(var B=g.length-1;B>=0;B--)(L=g[B])&&(T=(A<3?L(T):A>3?L(w,v,T):L(w,v))||T);return A>3&&T&&Object.defineProperty(w,v,T),T},f=this&&this.__param||function(g,w){return function(v,b){w(v,b,g)}};Object.defineProperty(c,"__esModule",{value:!0}),c.DomRendererRowFactory=c.CURSOR_STYLE_UNDERLINE_CLASS=c.CURSOR_STYLE_BAR_CLASS=c.CURSOR_STYLE_BLOCK_CLASS=c.CURSOR_BLINK_CLASS=c.CURSOR_CLASS=c.STRIKETHROUGH_CLASS=c.OVERLINE_CLASS=c.UNDERLINE_CLASS=c.ITALIC_CLASS=c.DIM_CLASS=c.BOLD_CLASS=void 0;const u=S(2223),d=S(643),y=S(511),_=S(2585),o=S(8055),t=S(4725),h=S(4269),s=S(6171),r=S(3734);c.BOLD_CLASS="xterm-bold",c.DIM_CLASS="xterm-dim",c.ITALIC_CLASS="xterm-italic",c.UNDERLINE_CLASS="xterm-underline",c.OVERLINE_CLASS="xterm-overline",c.STRIKETHROUGH_CLASS="xterm-strikethrough",c.CURSOR_CLASS="xterm-cursor",c.CURSOR_BLINK_CLASS="xterm-cursor-blink",c.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",c.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",c.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";let l=class{constructor(g,w,v,b,L,A,T){this._document=g,this._characterJoinerService=w,this._optionsService=v,this._coreBrowserService=b,this._coreService=L,this._decorationService=A,this._themeService=T,this._workCell=new y.CellData,this._columnSelectMode=!1}handleSelectionChanged(g,w,v){this._selectionStart=g,this._selectionEnd=w,this._columnSelectMode=v}createRow(g,w,v,b,L,A,T,B,U){const D=this._document.createDocumentFragment(),F=this._characterJoinerService.getJoinedCharacters(w);let E=0;for(let J=Math.min(g.length,B)-1;J>=0;J--)if(g.loadCell(J,this._workCell).getCode()!==d.NULL_CELL_CODE||v&&J===L){E=J+1;break}const I=this._themeService.colors;let O=-1,P=0;for(;P<E;P++){g.loadCell(P,this._workCell);let J=this._workCell.getWidth();if(J===0){U[P]=O;continue}let j=!1,X=P,V=this._workCell;if(F.length>0&&P===F[0][0]){j=!0;const fe=F.shift();V=new h.JoinedCellData(this._workCell,g.translateToString(!0,fe[0],fe[1]),fe[1]-fe[0]),X=fe[1]-1,J=V.getWidth()}const re=this._document.createElement("span");if(J>1&&(re.style.width=T*J+"px"),j&&(re.style.display="inline",L>=P&&L<=X&&(L=P)),!this._coreService.isCursorHidden&&v&&P===L)switch(re.classList.add(c.CURSOR_CLASS),A&&re.classList.add(c.CURSOR_BLINK_CLASS),b){case"bar":re.classList.add(c.CURSOR_STYLE_BAR_CLASS);break;case"underline":re.classList.add(c.CURSOR_STYLE_UNDERLINE_CLASS);break;default:re.classList.add(c.CURSOR_STYLE_BLOCK_CLASS)}if(V.isBold()&&re.classList.add(c.BOLD_CLASS),V.isItalic()&&re.classList.add(c.ITALIC_CLASS),V.isDim()&&re.classList.add(c.DIM_CLASS),V.isInvisible()?re.textContent=d.WHITESPACE_CELL_CHAR:re.textContent=V.getChars()||d.WHITESPACE_CELL_CHAR,V.isUnderline()&&(re.classList.add(`${c.UNDERLINE_CLASS}-${V.extended.underlineStyle}`),re.textContent===" "&&(re.textContent=""),!V.isUnderlineColorDefault()))if(V.isUnderlineColorRGB())re.style.textDecorationColor=`rgb(${r.AttributeData.toColorRGB(V.getUnderlineColor()).join(",")})`;else{let fe=V.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&V.isBold()&&fe<8&&(fe+=8),re.style.textDecorationColor=I.ansi[fe].css}V.isOverline()&&(re.classList.add(c.OVERLINE_CLASS),re.textContent===" "&&(re.textContent="")),V.isStrikethrough()&&re.classList.add(c.STRIKETHROUGH_CLASS);let G=V.getFgColor(),z=V.getFgColorMode(),W=V.getBgColor(),te=V.getBgColorMode();const ne=!!V.isInverse();if(ne){const fe=G;G=W,W=fe;const st=z;z=te,te=st}let Se,ce,ke=!1;this._decorationService.forEachDecorationAtCell(P,w,void 0,fe=>{fe.options.layer!=="top"&&ke||(fe.backgroundColorRGB&&(te=50331648,W=fe.backgroundColorRGB.rgba>>8&16777215,Se=fe.backgroundColorRGB),fe.foregroundColorRGB&&(z=50331648,G=fe.foregroundColorRGB.rgba>>8&16777215,ce=fe.foregroundColorRGB),ke=fe.options.layer==="top")});const Q=this._isCellInSelection(P,w);let Le;switch(ke||I.selectionForeground&&Q&&(z=50331648,G=I.selectionForeground.rgba>>8&16777215,ce=I.selectionForeground),Q&&(Se=this._coreBrowserService.isFocused?I.selectionBackgroundOpaque:I.selectionInactiveBackgroundOpaque,ke=!0),ke&&re.classList.add("xterm-decoration-top"),te){case 16777216:case 33554432:Le=I.ansi[W],re.classList.add(`xterm-bg-${W}`);break;case 50331648:Le=o.rgba.toColor(W>>16,W>>8&255,255&W),this._addStyle(re,`background-color:#${p((W>>>0).toString(16),"0",6)}`);break;default:ne?(Le=I.foreground,re.classList.add(`xterm-bg-${u.INVERTED_DEFAULT_COLOR}`)):Le=I.background}switch(Se||V.isDim()&&(Se=o.color.multiplyOpacity(Le,.5)),z){case 16777216:case 33554432:V.isBold()&&G<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(G+=8),this._applyMinimumContrast(re,Le,I.ansi[G],V,Se,void 0)||re.classList.add(`xterm-fg-${G}`);break;case 50331648:const fe=o.rgba.toColor(G>>16&255,G>>8&255,255&G);this._applyMinimumContrast(re,Le,fe,V,Se,ce)||this._addStyle(re,`color:#${p(G.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(re,Le,I.foreground,V,Se,void 0)||ne&&re.classList.add(`xterm-fg-${u.INVERTED_DEFAULT_COLOR}`)}D.appendChild(re),U[P]=++O,P=X}return P<B-1&&U.subarray(P).fill(++O),D}_applyMinimumContrast(g,w,v,b,L,A){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,s.excludeFromContrastRatioDemands)(b.getCode()))return!1;let T;return L||A||(T=this._themeService.colors.contrastCache.getColor(w.rgba,v.rgba)),T===void 0&&(T=o.color.ensureContrastRatio(L||w,A||v,this._optionsService.rawOptions.minimumContrastRatio),this._themeService.colors.contrastCache.setColor((L||w).rgba,(A||v).rgba,T??null)),!!T&&(this._addStyle(g,`color:${T.css}`),!0)}_addStyle(g,w){g.setAttribute("style",`${g.getAttribute("style")||""}${w};`)}_isCellInSelection(g,w){const v=this._selectionStart,b=this._selectionEnd;return!(!v||!b)&&(this._columnSelectMode?v[0]<=b[0]?g>=v[0]&&w>=v[1]&&g<b[0]&&w<=b[1]:g<v[0]&&w>=v[1]&&g>=b[0]&&w<=b[1]:w>v[1]&&w<b[1]||v[1]===b[1]&&w===v[1]&&g>=v[0]&&g<b[0]||v[1]<b[1]&&w===b[1]&&g<b[0]||v[1]<b[1]&&w===v[1]&&g>=v[0])}};function p(g,w,v){for(;g.length<v;)g=w+g;return g}l=m([f(1,t.ICharacterJoinerService),f(2,_.IOptionsService),f(3,t.ICoreBrowserService),f(4,_.ICoreService),f(5,_.IDecorationService),f(6,t.IThemeService)],l),c.DomRendererRowFactory=l},2223:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TEXT_BASELINE=c.DIM_OPACITY=c.INVERTED_DEFAULT_COLOR=void 0;const m=S(6114);c.INVERTED_DEFAULT_COLOR=257,c.DIM_OPACITY=.5,c.TEXT_BASELINE=m.isFirefox||m.isLegacyEdge?"bottom":"ideographic"},6171:(q,c)=>{function S(m){return 57508<=m&&m<=57558}Object.defineProperty(c,"__esModule",{value:!0}),c.createRenderDimensions=c.excludeFromContrastRatioDemands=c.isRestrictedPowerlineGlyph=c.isPowerlineGlyph=c.throwIfFalsy=void 0,c.throwIfFalsy=function(m){if(!m)throw new Error("value must not be falsy");return m},c.isPowerlineGlyph=S,c.isRestrictedPowerlineGlyph=function(m){return 57520<=m&&m<=57527},c.excludeFromContrastRatioDemands=function(m){return S(m)||function(f){return 9472<=f&&f<=9631}(m)},c.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SelectionModel=void 0,c.SelectionModel=class{constructor(S){this._bufferService=S,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const S=this.selectionStart[0]+this.selectionStartLength;return S>this._bufferService.cols?S%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(S/this._bufferService.cols)-1]:[S%this._bufferService.cols,this.selectionStart[1]+Math.floor(S/this._bufferService.cols)]:[S,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const S=this.selectionStart[0]+this.selectionStartLength;return S>this._bufferService.cols?[S%this._bufferService.cols,this.selectionStart[1]+Math.floor(S/this._bufferService.cols)]:[Math.max(S,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const S=this.selectionStart,m=this.selectionEnd;return!(!S||!m)&&(S[1]>m[1]||S[1]===m[1]&&S[0]>m[0])}handleTrim(S){return this.selectionStart&&(this.selectionStart[1]-=S),this.selectionEnd&&(this.selectionEnd[1]-=S),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(q,c,S){var m=this&&this.__decorate||function(t,h,s,r){var l,p=arguments.length,g=p<3?h:r===null?r=Object.getOwnPropertyDescriptor(h,s):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(t,h,s,r);else for(var w=t.length-1;w>=0;w--)(l=t[w])&&(g=(p<3?l(g):p>3?l(h,s,g):l(h,s))||g);return p>3&&g&&Object.defineProperty(h,s,g),g},f=this&&this.__param||function(t,h){return function(s,r){h(s,r,t)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CharSizeService=void 0;const u=S(2585),d=S(8460),y=S(844);let _=class extends y.Disposable{constructor(t,h,s){super(),this._optionsService=s,this.width=0,this.height=0,this._onCharSizeChange=this.register(new d.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new o(t,h,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){const t=this._measureStrategy.measure();t.width===this.width&&t.height===this.height||(this.width=t.width,this.height=t.height,this._onCharSizeChange.fire())}};_=m([f(2,u.IOptionsService)],_),c.CharSizeService=_;class o{constructor(h,s,r){this._document=h,this._parentElement=s,this._optionsService=r,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const h=this._measureElement.getBoundingClientRect();return h.width!==0&&h.height!==0&&(this._result.width=h.width,this._result.height=Math.ceil(h.height)),this._result}}},4269:function(q,c,S){var m=this&&this.__decorate||function(h,s,r,l){var p,g=arguments.length,w=g<3?s:l===null?l=Object.getOwnPropertyDescriptor(s,r):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(h,s,r,l);else for(var v=h.length-1;v>=0;v--)(p=h[v])&&(w=(g<3?p(w):g>3?p(s,r,w):p(s,r))||w);return g>3&&w&&Object.defineProperty(s,r,w),w},f=this&&this.__param||function(h,s){return function(r,l){s(r,l,h)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CharacterJoinerService=c.JoinedCellData=void 0;const u=S(3734),d=S(643),y=S(511),_=S(2585);class o extends u.AttributeData{constructor(s,r,l){super(),this.content=0,this.combinedData="",this.fg=s.fg,this.bg=s.bg,this.combinedData=r,this._width=l}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(s){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.JoinedCellData=o;let t=class zr{constructor(s){this._bufferService=s,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new y.CellData}register(s){const r={id:this._nextCharacterJoinerId++,handler:s};return this._characterJoiners.push(r),r.id}deregister(s){for(let r=0;r<this._characterJoiners.length;r++)if(this._characterJoiners[r].id===s)return this._characterJoiners.splice(r,1),!0;return!1}getJoinedCharacters(s){if(this._characterJoiners.length===0)return[];const r=this._bufferService.buffer.lines.get(s);if(!r||r.length===0)return[];const l=[],p=r.translateToString(!0);let g=0,w=0,v=0,b=r.getFg(0),L=r.getBg(0);for(let A=0;A<r.getTrimmedLength();A++)if(r.loadCell(A,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==b||this._workCell.bg!==L){if(A-g>1){const T=this._getJoinedRanges(p,v,w,r,g);for(let B=0;B<T.length;B++)l.push(T[B])}g=A,v=w,b=this._workCell.fg,L=this._workCell.bg}w+=this._workCell.getChars().length||d.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-g>1){const A=this._getJoinedRanges(p,v,w,r,g);for(let T=0;T<A.length;T++)l.push(A[T])}return l}_getJoinedRanges(s,r,l,p,g){const w=s.substring(r,l);let v=[];try{v=this._characterJoiners[0].handler(w)}catch(b){console.error(b)}for(let b=1;b<this._characterJoiners.length;b++)try{const L=this._characterJoiners[b].handler(w);for(let A=0;A<L.length;A++)zr._mergeRanges(v,L[A])}catch(L){console.error(L)}return this._stringRangesToCellRanges(v,p,g),v}_stringRangesToCellRanges(s,r,l){let p=0,g=!1,w=0,v=s[p];if(v){for(let b=l;b<this._bufferService.cols;b++){const L=r.getWidth(b),A=r.getString(b).length||d.WHITESPACE_CELL_CHAR.length;if(L!==0){if(!g&&v[0]<=w&&(v[0]=b,g=!0),v[1]<=w){if(v[1]=b,v=s[++p],!v)break;v[0]<=w?(v[0]=b,g=!0):g=!1}w+=A}}v&&(v[1]=this._bufferService.cols)}}static _mergeRanges(s,r){let l=!1;for(let p=0;p<s.length;p++){const g=s[p];if(l){if(r[1]<=g[0])return s[p-1][1]=r[1],s;if(r[1]<=g[1])return s[p-1][1]=Math.max(r[1],g[1]),s.splice(p,1),s;s.splice(p,1),p--}else{if(r[1]<=g[0])return s.splice(p,0,r),s;if(r[1]<=g[1])return g[0]=Math.min(r[0],g[0]),s;r[0]<g[1]&&(g[0]=Math.min(r[0],g[0]),l=!0)}}return l?s[s.length-1][1]=r[1]:s.push(r),s}};t=m([f(0,_.IBufferService)],t),c.CharacterJoinerService=t},5114:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CoreBrowserService=void 0,c.CoreBrowserService=class{constructor(S,m){this._textarea=S,this.window=m,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(q,c,S){var m=this&&this.__decorate||function(_,o,t,h){var s,r=arguments.length,l=r<3?o:h===null?h=Object.getOwnPropertyDescriptor(o,t):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(_,o,t,h);else for(var p=_.length-1;p>=0;p--)(s=_[p])&&(l=(r<3?s(l):r>3?s(o,t,l):s(o,t))||l);return r>3&&l&&Object.defineProperty(o,t,l),l},f=this&&this.__param||function(_,o){return function(t,h){o(t,h,_)}};Object.defineProperty(c,"__esModule",{value:!0}),c.MouseService=void 0;const u=S(4725),d=S(9806);let y=class{constructor(_,o){this._renderService=_,this._charSizeService=o}getCoords(_,o,t,h,s){return(0,d.getCoords)(window,_,o,t,h,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,s)}getMouseReportCoords(_,o){const t=(0,d.getCoordsRelativeToElement)(window,_,o);if(!(!this._charSizeService.hasValidSize||t[0]<0||t[1]<0||t[0]>=this._renderService.dimensions.css.canvas.width||t[1]>=this._renderService.dimensions.css.canvas.height))return{col:Math.floor(t[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(t[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(t[0]),y:Math.floor(t[1])}}};y=m([f(0,u.IRenderService),f(1,u.ICharSizeService)],y),c.MouseService=y},3230:function(q,c,S){var m=this&&this.__decorate||function(l,p,g,w){var v,b=arguments.length,L=b<3?p:w===null?w=Object.getOwnPropertyDescriptor(p,g):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(l,p,g,w);else for(var A=l.length-1;A>=0;A--)(v=l[A])&&(L=(b<3?v(L):b>3?v(p,g,L):v(p,g))||L);return b>3&&L&&Object.defineProperty(p,g,L),L},f=this&&this.__param||function(l,p){return function(g,w){p(g,w,l)}};Object.defineProperty(c,"__esModule",{value:!0}),c.RenderService=void 0;const u=S(6193),d=S(8460),y=S(844),_=S(5596),o=S(3656),t=S(2585),h=S(4725),s=S(7226);let r=class extends y.Disposable{constructor(l,p,g,w,v,b,L,A){if(super(),this._rowCount=l,this._charSizeService=w,this._pausedResizeTask=new s.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new d.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new d.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new d.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new d.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this.register({dispose:()=>{var T;return(T=this._renderer)===null||T===void 0?void 0:T.dispose()}}),this._renderDebouncer=new u.RenderDebouncer(L.window,(T,B)=>this._renderRows(T,B)),this.register(this._renderDebouncer),this._screenDprMonitor=new _.ScreenDprMonitor(L.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(b.onResize(()=>this._fullRefresh())),this.register(b.buffers.onBufferActivate(()=>{var T;return(T=this._renderer)===null||T===void 0?void 0:T.clear()})),this.register(g.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(v.onDecorationRegistered(()=>this._fullRefresh())),this.register(v.onDecorationRemoved(()=>this._fullRefresh())),this.register(g.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(b.cols,b.rows),this._fullRefresh()})),this.register(g.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(b.buffer.y,b.buffer.y,!0))),this.register((0,o.addDisposableDomListener)(L.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(A.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in L.window){const T=new L.window.IntersectionObserver(B=>this._handleIntersectionChange(B[B.length-1]),{threshold:0});T.observe(p),this.register({dispose:()=>T.disconnect()})}}get dimensions(){return this._renderer.dimensions}_handleIntersectionChange(l){this._isPaused=l.isIntersecting===void 0?l.intersectionRatio===0:!l.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(l,p,g=!1){this._isPaused?this._needsFullRefresh=!0:(g||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(l,p,this._rowCount))}_renderRows(l,p){this._renderer&&(l=Math.min(l,this._rowCount-1),p=Math.min(p,this._rowCount-1),this._renderer.renderRows(l,p),this._needsSelectionRefresh&&(this._renderer.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:l,end:p}),this._onRender.fire({start:l,end:p}),this._isNextRenderRedrawOnly=!0)}resize(l,p){this._rowCount=p,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer&&(this._renderer.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions))}hasRenderer(){return!!this._renderer}setRenderer(l){var p;(p=this._renderer)===null||p===void 0||p.dispose(),this._renderer=l,this._renderer.onRequestRedraw(g=>this.refreshRows(g.start,g.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(l){return this._renderDebouncer.addRefreshCallback(l)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var l,p;this._renderer&&((p=(l=this._renderer).clearTextureAtlas)===null||p===void 0||p.call(l),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer&&(this._renderer.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(l,p){this._renderer&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.handleResize(l,p)):this._renderer.handleResize(l,p),this._fullRefresh())}handleCharSizeChanged(){var l;(l=this._renderer)===null||l===void 0||l.handleCharSizeChanged()}handleBlur(){var l;(l=this._renderer)===null||l===void 0||l.handleBlur()}handleFocus(){var l;(l=this._renderer)===null||l===void 0||l.handleFocus()}handleSelectionChanged(l,p,g){var w;this._selectionState.start=l,this._selectionState.end=p,this._selectionState.columnSelectMode=g,(w=this._renderer)===null||w===void 0||w.handleSelectionChanged(l,p,g)}handleCursorMove(){var l;(l=this._renderer)===null||l===void 0||l.handleCursorMove()}clear(){var l;(l=this._renderer)===null||l===void 0||l.clear()}};r=m([f(2,t.IOptionsService),f(3,h.ICharSizeService),f(4,t.IDecorationService),f(5,t.IBufferService),f(6,h.ICoreBrowserService),f(7,h.IThemeService)],r),c.RenderService=r},9312:function(q,c,S){var m=this&&this.__decorate||function(v,b,L,A){var T,B=arguments.length,U=B<3?b:A===null?A=Object.getOwnPropertyDescriptor(b,L):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(v,b,L,A);else for(var D=v.length-1;D>=0;D--)(T=v[D])&&(U=(B<3?T(U):B>3?T(b,L,U):T(b,L))||U);return B>3&&U&&Object.defineProperty(b,L,U),U},f=this&&this.__param||function(v,b){return function(L,A){b(L,A,v)}};Object.defineProperty(c,"__esModule",{value:!0}),c.SelectionService=void 0;const u=S(6114),d=S(456),y=S(511),_=S(8460),o=S(4725),t=S(2585),h=S(9806),s=S(9504),r=S(844),l=S(4841),p=String.fromCharCode(160),g=new RegExp(p,"g");let w=class extends r.Disposable{constructor(v,b,L,A,T,B,U,D,F){super(),this._element=v,this._screenElement=b,this._linkifier=L,this._bufferService=A,this._coreService=T,this._mouseService=B,this._optionsService=U,this._renderService=D,this._coreBrowserService=F,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new y.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new _.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new _.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new _.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new _.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=E=>this._handleMouseMove(E),this._mouseUpListener=E=>this._handleMouseUp(E),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(E=>this._handleTrim(E)),this.register(this._bufferService.buffers.onBufferActivate(E=>this._handleBufferActivate(E))),this.enable(),this._model=new d.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,r.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const v=this._model.finalSelectionStart,b=this._model.finalSelectionEnd;return!(!v||!b||v[0]===b[0]&&v[1]===b[1])}get selectionText(){const v=this._model.finalSelectionStart,b=this._model.finalSelectionEnd;if(!v||!b)return"";const L=this._bufferService.buffer,A=[];if(this._activeSelectionMode===3){if(v[0]===b[0])return"";const T=v[0]<b[0]?v[0]:b[0],B=v[0]<b[0]?b[0]:v[0];for(let U=v[1];U<=b[1];U++){const D=L.translateBufferLineToString(U,!0,T,B);A.push(D)}}else{const T=v[1]===b[1]?b[0]:void 0;A.push(L.translateBufferLineToString(v[1],!0,v[0],T));for(let B=v[1]+1;B<=b[1]-1;B++){const U=L.lines.get(B),D=L.translateBufferLineToString(B,!0);U!=null&&U.isWrapped?A[A.length-1]+=D:A.push(D)}if(v[1]!==b[1]){const B=L.lines.get(b[1]),U=L.translateBufferLineToString(b[1],!0,0,b[0]);B&&B.isWrapped?A[A.length-1]+=U:A.push(U)}}return A.map(T=>T.replace(g," ")).join(u.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(v){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),u.isLinux&&v&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(v){const b=this._getMouseBufferCoords(v),L=this._model.finalSelectionStart,A=this._model.finalSelectionEnd;return!!(L&&A&&b)&&this._areCoordsInSelection(b,L,A)}isCellInSelection(v,b){const L=this._model.finalSelectionStart,A=this._model.finalSelectionEnd;return!(!L||!A)&&this._areCoordsInSelection([v,b],L,A)}_areCoordsInSelection(v,b,L){return v[1]>b[1]&&v[1]<L[1]||b[1]===L[1]&&v[1]===b[1]&&v[0]>=b[0]&&v[0]<L[0]||b[1]<L[1]&&v[1]===L[1]&&v[0]<L[0]||b[1]<L[1]&&v[1]===b[1]&&v[0]>=b[0]}_selectWordAtCursor(v,b){var L,A;const T=(A=(L=this._linkifier.currentLink)===null||L===void 0?void 0:L.link)===null||A===void 0?void 0:A.range;if(T)return this._model.selectionStart=[T.start.x-1,T.start.y-1],this._model.selectionStartLength=(0,l.getRangeLength)(T,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const B=this._getMouseBufferCoords(v);return!!B&&(this._selectWordAt(B,b),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(v,b){this._model.clearSelection(),v=Math.max(v,0),b=Math.min(b,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,v],this._model.selectionEnd=[this._bufferService.cols,b],this.refresh(),this._onSelectionChange.fire()}_handleTrim(v){this._model.handleTrim(v)&&this.refresh()}_getMouseBufferCoords(v){const b=this._mouseService.getCoords(v,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(b)return b[0]--,b[1]--,b[1]+=this._bufferService.buffer.ydisp,b}_getMouseEventScrollAmount(v){let b=(0,h.getCoordsRelativeToElement)(this._coreBrowserService.window,v,this._screenElement)[1];const L=this._renderService.dimensions.css.canvas.height;return b>=0&&b<=L?0:(b>L&&(b-=L),b=Math.min(Math.max(b,-50),50),b/=50,b/Math.abs(b)+Math.round(14*b))}shouldForceSelection(v){return u.isMac?v.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:v.shiftKey}handleMouseDown(v){if(this._mouseDownTimeStamp=v.timeStamp,(v.button!==2||!this.hasSelection)&&v.button===0){if(!this._enabled){if(!this.shouldForceSelection(v))return;v.stopPropagation()}v.preventDefault(),this._dragScrollAmount=0,this._enabled&&v.shiftKey?this._handleIncrementalClick(v):v.detail===1?this._handleSingleClick(v):v.detail===2?this._handleDoubleClick(v):v.detail===3&&this._handleTripleClick(v),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(v){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(v))}_handleSingleClick(v){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(v)?3:0,this._model.selectionStart=this._getMouseBufferCoords(v),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const b=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);b&&b.length!==this._model.selectionStart[0]&&b.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(v){this._selectWordAtCursor(v,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(v){const b=this._getMouseBufferCoords(v);b&&(this._activeSelectionMode=2,this._selectLineAt(b[1]))}shouldColumnSelect(v){return v.altKey&&!(u.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(v){if(v.stopImmediatePropagation(),!this._model.selectionStart)return;const b=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(v),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(v),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const L=this._bufferService.buffer;if(this._model.selectionEnd[1]<L.lines.length){const A=L.lines.get(this._model.selectionEnd[1]);A&&A.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}b&&b[0]===this._model.selectionEnd[0]&&b[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const v=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(v.ydisp+this._bufferService.rows,v.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=v.ydisp),this.refresh()}}_handleMouseUp(v){const b=v.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&b<500&&v.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const L=this._mouseService.getCoords(v,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(L&&L[0]!==void 0&&L[1]!==void 0){const A=(0,s.moveToCellSequence)(L[0]-1,L[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(A,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const v=this._model.finalSelectionStart,b=this._model.finalSelectionEnd,L=!(!v||!b||v[0]===b[0]&&v[1]===b[1]);L?v&&b&&(this._oldSelectionStart&&this._oldSelectionEnd&&v[0]===this._oldSelectionStart[0]&&v[1]===this._oldSelectionStart[1]&&b[0]===this._oldSelectionEnd[0]&&b[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(v,b,L)):this._oldHasSelection&&this._fireOnSelectionChange(v,b,L)}_fireOnSelectionChange(v,b,L){this._oldSelectionStart=v,this._oldSelectionEnd=b,this._oldHasSelection=L,this._onSelectionChange.fire()}_handleBufferActivate(v){this.clearSelection(),this._trimListener.dispose(),this._trimListener=v.activeBuffer.lines.onTrim(b=>this._handleTrim(b))}_convertViewportColToCharacterIndex(v,b){let L=b;for(let A=0;b>=A;A++){const T=v.loadCell(A,this._workCell).getChars().length;this._workCell.getWidth()===0?L--:T>1&&b!==A&&(L+=T-1)}return L}setSelection(v,b,L){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[v,b],this._model.selectionStartLength=L,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(v){this._isClickInSelection(v)||(this._selectWordAtCursor(v,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(v,b,L=!0,A=!0){if(v[0]>=this._bufferService.cols)return;const T=this._bufferService.buffer,B=T.lines.get(v[1]);if(!B)return;const U=T.translateBufferLineToString(v[1],!1);let D=this._convertViewportColToCharacterIndex(B,v[0]),F=D;const E=v[0]-D;let I=0,O=0,P=0,J=0;if(U.charAt(D)===" "){for(;D>0&&U.charAt(D-1)===" ";)D--;for(;F<U.length&&U.charAt(F+1)===" ";)F++}else{let V=v[0],re=v[0];B.getWidth(V)===0&&(I++,V--),B.getWidth(re)===2&&(O++,re++);const G=B.getString(re).length;for(G>1&&(J+=G-1,F+=G-1);V>0&&D>0&&!this._isCharWordSeparator(B.loadCell(V-1,this._workCell));){B.loadCell(V-1,this._workCell);const z=this._workCell.getChars().length;this._workCell.getWidth()===0?(I++,V--):z>1&&(P+=z-1,D-=z-1),D--,V--}for(;re<B.length&&F+1<U.length&&!this._isCharWordSeparator(B.loadCell(re+1,this._workCell));){B.loadCell(re+1,this._workCell);const z=this._workCell.getChars().length;this._workCell.getWidth()===2?(O++,re++):z>1&&(J+=z-1,F+=z-1),F++,re++}}F++;let j=D+E-I+P,X=Math.min(this._bufferService.cols,F-D+I+O-P-J);if(b||U.slice(D,F).trim()!==""){if(L&&j===0&&B.getCodePoint(0)!==32){const V=T.lines.get(v[1]-1);if(V&&B.isWrapped&&V.getCodePoint(this._bufferService.cols-1)!==32){const re=this._getWordAt([this._bufferService.cols-1,v[1]-1],!1,!0,!1);if(re){const G=this._bufferService.cols-re.start;j-=G,X+=G}}}if(A&&j+X===this._bufferService.cols&&B.getCodePoint(this._bufferService.cols-1)!==32){const V=T.lines.get(v[1]+1);if(V!=null&&V.isWrapped&&V.getCodePoint(0)!==32){const re=this._getWordAt([0,v[1]+1],!1,!1,!0);re&&(X+=re.length)}}return{start:j,length:X}}}_selectWordAt(v,b){const L=this._getWordAt(v,b);if(L){for(;L.start<0;)L.start+=this._bufferService.cols,v[1]--;this._model.selectionStart=[L.start,v[1]],this._model.selectionStartLength=L.length}}_selectToWordAt(v){const b=this._getWordAt(v,!0);if(b){let L=v[1];for(;b.start<0;)b.start+=this._bufferService.cols,L--;if(!this._model.areSelectionValuesReversed())for(;b.start+b.length>this._bufferService.cols;)b.length-=this._bufferService.cols,L++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?b.start:b.start+b.length,L]}}_isCharWordSeparator(v){return v.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(v.getChars())>=0}_selectLineAt(v){const b=this._bufferService.buffer.getWrappedRangeForLine(v),L={start:{x:0,y:b.first},end:{x:this._bufferService.cols-1,y:b.last}};this._model.selectionStart=[0,b.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,l.getRangeLength)(L,this._bufferService.cols)}};w=m([f(3,t.IBufferService),f(4,t.ICoreService),f(5,o.IMouseService),f(6,t.IOptionsService),f(7,o.IRenderService),f(8,o.ICoreBrowserService)],w),c.SelectionService=w},4725:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.IThemeService=c.ICharacterJoinerService=c.ISelectionService=c.IRenderService=c.IMouseService=c.ICoreBrowserService=c.ICharSizeService=void 0;const m=S(8343);c.ICharSizeService=(0,m.createDecorator)("CharSizeService"),c.ICoreBrowserService=(0,m.createDecorator)("CoreBrowserService"),c.IMouseService=(0,m.createDecorator)("MouseService"),c.IRenderService=(0,m.createDecorator)("RenderService"),c.ISelectionService=(0,m.createDecorator)("SelectionService"),c.ICharacterJoinerService=(0,m.createDecorator)("CharacterJoinerService"),c.IThemeService=(0,m.createDecorator)("ThemeService")},6731:function(q,c,S){var m=this&&this.__decorate||function(w,v,b,L){var A,T=arguments.length,B=T<3?v:L===null?L=Object.getOwnPropertyDescriptor(v,b):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(w,v,b,L);else for(var U=w.length-1;U>=0;U--)(A=w[U])&&(B=(T<3?A(B):T>3?A(v,b,B):A(v,b))||B);return T>3&&B&&Object.defineProperty(v,b,B),B},f=this&&this.__param||function(w,v){return function(b,L){v(b,L,w)}};Object.defineProperty(c,"__esModule",{value:!0}),c.ThemeService=c.DEFAULT_ANSI_COLORS=void 0;const u=S(7239),d=S(8055),y=S(8460),_=S(844),o=S(2585),t=d.css.toColor("#ffffff"),h=d.css.toColor("#000000"),s=d.css.toColor("#ffffff"),r=d.css.toColor("#000000"),l={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};c.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const w=[d.css.toColor("#2e3436"),d.css.toColor("#cc0000"),d.css.toColor("#4e9a06"),d.css.toColor("#c4a000"),d.css.toColor("#3465a4"),d.css.toColor("#75507b"),d.css.toColor("#06989a"),d.css.toColor("#d3d7cf"),d.css.toColor("#555753"),d.css.toColor("#ef2929"),d.css.toColor("#8ae234"),d.css.toColor("#fce94f"),d.css.toColor("#729fcf"),d.css.toColor("#ad7fa8"),d.css.toColor("#34e2e2"),d.css.toColor("#eeeeec")],v=[0,95,135,175,215,255];for(let b=0;b<216;b++){const L=v[b/36%6|0],A=v[b/6%6|0],T=v[b%6];w.push({css:d.channels.toCss(L,A,T),rgba:d.channels.toRgba(L,A,T)})}for(let b=0;b<24;b++){const L=8+10*b;w.push({css:d.channels.toCss(L,L,L),rgba:d.channels.toRgba(L,L,L)})}return w})());let p=class extends _.Disposable{constructor(w){super(),this._optionsService=w,this._onChangeColors=this.register(new y.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._contrastCache=new u.ColorContrastCache,this._colors={foreground:t,background:h,cursor:s,cursorAccent:r,selectionForeground:void 0,selectionBackgroundTransparent:l,selectionBackgroundOpaque:d.color.blend(h,l),selectionInactiveBackgroundTransparent:l,selectionInactiveBackgroundOpaque:d.color.blend(h,l),ansi:c.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(w={}){const v=this._colors;if(v.foreground=g(w.foreground,t),v.background=g(w.background,h),v.cursor=g(w.cursor,s),v.cursorAccent=g(w.cursorAccent,r),v.selectionBackgroundTransparent=g(w.selectionBackground,l),v.selectionBackgroundOpaque=d.color.blend(v.background,v.selectionBackgroundTransparent),v.selectionInactiveBackgroundTransparent=g(w.selectionInactiveBackground,v.selectionBackgroundTransparent),v.selectionInactiveBackgroundOpaque=d.color.blend(v.background,v.selectionInactiveBackgroundTransparent),v.selectionForeground=w.selectionForeground?g(w.selectionForeground,d.NULL_COLOR):void 0,v.selectionForeground===d.NULL_COLOR&&(v.selectionForeground=void 0),d.color.isOpaque(v.selectionBackgroundTransparent)&&(v.selectionBackgroundTransparent=d.color.opacity(v.selectionBackgroundTransparent,.3)),d.color.isOpaque(v.selectionInactiveBackgroundTransparent)&&(v.selectionInactiveBackgroundTransparent=d.color.opacity(v.selectionInactiveBackgroundTransparent,.3)),v.ansi=c.DEFAULT_ANSI_COLORS.slice(),v.ansi[0]=g(w.black,c.DEFAULT_ANSI_COLORS[0]),v.ansi[1]=g(w.red,c.DEFAULT_ANSI_COLORS[1]),v.ansi[2]=g(w.green,c.DEFAULT_ANSI_COLORS[2]),v.ansi[3]=g(w.yellow,c.DEFAULT_ANSI_COLORS[3]),v.ansi[4]=g(w.blue,c.DEFAULT_ANSI_COLORS[4]),v.ansi[5]=g(w.magenta,c.DEFAULT_ANSI_COLORS[5]),v.ansi[6]=g(w.cyan,c.DEFAULT_ANSI_COLORS[6]),v.ansi[7]=g(w.white,c.DEFAULT_ANSI_COLORS[7]),v.ansi[8]=g(w.brightBlack,c.DEFAULT_ANSI_COLORS[8]),v.ansi[9]=g(w.brightRed,c.DEFAULT_ANSI_COLORS[9]),v.ansi[10]=g(w.brightGreen,c.DEFAULT_ANSI_COLORS[10]),v.ansi[11]=g(w.brightYellow,c.DEFAULT_ANSI_COLORS[11]),v.ansi[12]=g(w.brightBlue,c.DEFAULT_ANSI_COLORS[12]),v.ansi[13]=g(w.brightMagenta,c.DEFAULT_ANSI_COLORS[13]),v.ansi[14]=g(w.brightCyan,c.DEFAULT_ANSI_COLORS[14]),v.ansi[15]=g(w.brightWhite,c.DEFAULT_ANSI_COLORS[15]),w.extendedAnsi){const b=Math.min(v.ansi.length-16,w.extendedAnsi.length);for(let L=0;L<b;L++)v.ansi[L+16]=g(w.extendedAnsi[L],c.DEFAULT_ANSI_COLORS[L+16])}this._contrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(w){this._restoreColor(w),this._onChangeColors.fire(this.colors)}_restoreColor(w){if(w!==void 0)switch(w){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[w]=this._restoreColors.ansi[w]}else for(let v=0;v<this._restoreColors.ansi.length;++v)this._colors.ansi[v]=this._restoreColors.ansi[v]}modifyColors(w){w(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function g(w,v){if(w!==void 0)try{return d.css.toColor(w)}catch{}return v}p=m([f(0,o.IOptionsService)],p),c.ThemeService=p},6349:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CircularList=void 0;const m=S(8460),f=S(844);class u extends f.Disposable{constructor(y){super(),this._maxLength=y,this.onDeleteEmitter=this.register(new m.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new m.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new m.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(y){if(this._maxLength===y)return;const _=new Array(y);for(let o=0;o<Math.min(y,this.length);o++)_[o]=this._array[this._getCyclicIndex(o)];this._array=_,this._maxLength=y,this._startIndex=0}get length(){return this._length}set length(y){if(y>this._length)for(let _=this._length;_<y;_++)this._array[_]=void 0;this._length=y}get(y){return this._array[this._getCyclicIndex(y)]}set(y,_){this._array[this._getCyclicIndex(y)]=_}push(y){this._array[this._getCyclicIndex(this._length)]=y,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(y,_,...o){if(_){for(let t=y;t<this._length-_;t++)this._array[this._getCyclicIndex(t)]=this._array[this._getCyclicIndex(t+_)];this._length-=_,this.onDeleteEmitter.fire({index:y,amount:_})}for(let t=this._length-1;t>=y;t--)this._array[this._getCyclicIndex(t+o.length)]=this._array[this._getCyclicIndex(t)];for(let t=0;t<o.length;t++)this._array[this._getCyclicIndex(y+t)]=o[t];if(o.length&&this.onInsertEmitter.fire({index:y,amount:o.length}),this._length+o.length>this._maxLength){const t=this._length+o.length-this._maxLength;this._startIndex+=t,this._length=this._maxLength,this.onTrimEmitter.fire(t)}else this._length+=o.length}trimStart(y){y>this._length&&(y=this._length),this._startIndex+=y,this._length-=y,this.onTrimEmitter.fire(y)}shiftElements(y,_,o){if(!(_<=0)){if(y<0||y>=this._length)throw new Error("start argument out of range");if(y+o<0)throw new Error("Cannot shift elements in list beyond index 0");if(o>0){for(let h=_-1;h>=0;h--)this.set(y+h+o,this.get(y+h));const t=y+_+o-this._length;if(t>0)for(this._length+=t;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let t=0;t<_;t++)this.set(y+t+o,this.get(y+t))}}_getCyclicIndex(y){return(this._startIndex+y)%this._maxLength}}c.CircularList=u},1439:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.clone=void 0,c.clone=function S(m,f=5){if(typeof m!="object")return m;const u=Array.isArray(m)?[]:{};for(const d in m)u[d]=f<=1?m[d]:m[d]&&S(m[d],f-1);return u}},8055:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.contrastRatio=c.toPaddedHex=c.rgba=c.rgb=c.css=c.color=c.channels=c.NULL_COLOR=void 0;const m=S(6114);let f=0,u=0,d=0,y=0;var _,o,t;function h(r){const l=r.toString(16);return l.length<2?"0"+l:l}function s(r,l){return r<l?(l+.05)/(r+.05):(r+.05)/(l+.05)}c.NULL_COLOR={css:"#00000000",rgba:0},function(r){r.toCss=function(l,p,g,w){return w!==void 0?`#${h(l)}${h(p)}${h(g)}${h(w)}`:`#${h(l)}${h(p)}${h(g)}`},r.toRgba=function(l,p,g,w=255){return(l<<24|p<<16|g<<8|w)>>>0}}(_=c.channels||(c.channels={})),function(r){function l(p,g){return y=Math.round(255*g),[f,u,d]=t.toChannels(p.rgba),{css:_.toCss(f,u,d,y),rgba:_.toRgba(f,u,d,y)}}r.blend=function(p,g){if(y=(255&g.rgba)/255,y===1)return{css:g.css,rgba:g.rgba};const w=g.rgba>>24&255,v=g.rgba>>16&255,b=g.rgba>>8&255,L=p.rgba>>24&255,A=p.rgba>>16&255,T=p.rgba>>8&255;return f=L+Math.round((w-L)*y),u=A+Math.round((v-A)*y),d=T+Math.round((b-T)*y),{css:_.toCss(f,u,d),rgba:_.toRgba(f,u,d)}},r.isOpaque=function(p){return(255&p.rgba)==255},r.ensureContrastRatio=function(p,g,w){const v=t.ensureContrastRatio(p.rgba,g.rgba,w);if(v)return t.toColor(v>>24&255,v>>16&255,v>>8&255)},r.opaque=function(p){const g=(255|p.rgba)>>>0;return[f,u,d]=t.toChannels(g),{css:_.toCss(f,u,d),rgba:g}},r.opacity=l,r.multiplyOpacity=function(p,g){return y=255&p.rgba,l(p,y*g/255)},r.toColorRGB=function(p){return[p.rgba>>24&255,p.rgba>>16&255,p.rgba>>8&255]}}(c.color||(c.color={})),function(r){let l,p;if(!m.isNode){const g=document.createElement("canvas");g.width=1,g.height=1;const w=g.getContext("2d",{willReadFrequently:!0});w&&(l=w,l.globalCompositeOperation="copy",p=l.createLinearGradient(0,0,1,1))}r.toColor=function(g){if(g.match(/#[\da-f]{3,8}/i))switch(g.length){case 4:return f=parseInt(g.slice(1,2).repeat(2),16),u=parseInt(g.slice(2,3).repeat(2),16),d=parseInt(g.slice(3,4).repeat(2),16),t.toColor(f,u,d);case 5:return f=parseInt(g.slice(1,2).repeat(2),16),u=parseInt(g.slice(2,3).repeat(2),16),d=parseInt(g.slice(3,4).repeat(2),16),y=parseInt(g.slice(4,5).repeat(2),16),t.toColor(f,u,d,y);case 7:return{css:g,rgba:(parseInt(g.slice(1),16)<<8|255)>>>0};case 9:return{css:g,rgba:parseInt(g.slice(1),16)>>>0}}const w=g.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(w)return f=parseInt(w[1]),u=parseInt(w[2]),d=parseInt(w[3]),y=Math.round(255*(w[5]===void 0?1:parseFloat(w[5]))),t.toColor(f,u,d,y);if(!l||!p)throw new Error("css.toColor: Unsupported css format");if(l.fillStyle=p,l.fillStyle=g,typeof l.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(l.fillRect(0,0,1,1),[f,u,d,y]=l.getImageData(0,0,1,1).data,y!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:_.toRgba(f,u,d,y),css:g}}}(c.css||(c.css={})),function(r){function l(p,g,w){const v=p/255,b=g/255,L=w/255;return .2126*(v<=.03928?v/12.92:Math.pow((v+.055)/1.055,2.4))+.7152*(b<=.03928?b/12.92:Math.pow((b+.055)/1.055,2.4))+.0722*(L<=.03928?L/12.92:Math.pow((L+.055)/1.055,2.4))}r.relativeLuminance=function(p){return l(p>>16&255,p>>8&255,255&p)},r.relativeLuminance2=l}(o=c.rgb||(c.rgb={})),function(r){function l(g,w,v){const b=g>>24&255,L=g>>16&255,A=g>>8&255;let T=w>>24&255,B=w>>16&255,U=w>>8&255,D=s(o.relativeLuminance2(T,B,U),o.relativeLuminance2(b,L,A));for(;D<v&&(T>0||B>0||U>0);)T-=Math.max(0,Math.ceil(.1*T)),B-=Math.max(0,Math.ceil(.1*B)),U-=Math.max(0,Math.ceil(.1*U)),D=s(o.relativeLuminance2(T,B,U),o.relativeLuminance2(b,L,A));return(T<<24|B<<16|U<<8|255)>>>0}function p(g,w,v){const b=g>>24&255,L=g>>16&255,A=g>>8&255;let T=w>>24&255,B=w>>16&255,U=w>>8&255,D=s(o.relativeLuminance2(T,B,U),o.relativeLuminance2(b,L,A));for(;D<v&&(T<255||B<255||U<255);)T=Math.min(255,T+Math.ceil(.1*(255-T))),B=Math.min(255,B+Math.ceil(.1*(255-B))),U=Math.min(255,U+Math.ceil(.1*(255-U))),D=s(o.relativeLuminance2(T,B,U),o.relativeLuminance2(b,L,A));return(T<<24|B<<16|U<<8|255)>>>0}r.ensureContrastRatio=function(g,w,v){const b=o.relativeLuminance(g>>8),L=o.relativeLuminance(w>>8);if(s(b,L)<v){if(L<b){const B=l(g,w,v),U=s(b,o.relativeLuminance(B>>8));if(U<v){const D=p(g,w,v);return U>s(b,o.relativeLuminance(D>>8))?B:D}return B}const A=p(g,w,v),T=s(b,o.relativeLuminance(A>>8));if(T<v){const B=l(g,w,v);return T>s(b,o.relativeLuminance(B>>8))?A:B}return A}},r.reduceLuminance=l,r.increaseLuminance=p,r.toChannels=function(g){return[g>>24&255,g>>16&255,g>>8&255,255&g]},r.toColor=function(g,w,v,b){return{css:_.toCss(g,w,v,b),rgba:_.toRgba(g,w,v,b)}}}(t=c.rgba||(c.rgba={})),c.toPaddedHex=h,c.contrastRatio=s},8969:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CoreTerminal=void 0;const m=S(844),f=S(2585),u=S(4348),d=S(7866),y=S(744),_=S(7302),o=S(6975),t=S(8460),h=S(1753),s=S(1480),r=S(7994),l=S(9282),p=S(5435),g=S(5981),w=S(2660);let v=!1;class b extends m.Disposable{constructor(A){super(),this._onBinary=this.register(new t.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new t.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new t.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new t.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new t.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new t.EventEmitter),this._instantiationService=new u.InstantiationService,this.optionsService=this.register(new _.OptionsService(A)),this._instantiationService.setService(f.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(y.BufferService)),this._instantiationService.setService(f.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(d.LogService)),this._instantiationService.setService(f.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(o.CoreService)),this._instantiationService.setService(f.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(h.CoreMouseService)),this._instantiationService.setService(f.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(s.UnicodeService)),this._instantiationService.setService(f.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(r.CharsetService),this._instantiationService.setService(f.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(w.OscLinkService),this._instantiationService.setService(f.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new p.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,t.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,t.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,t.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,t.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onSpecificOptionChange("windowsMode",T=>this._handleWindowsModeOptionChange(T))),this.register(this._bufferService.onScroll(T=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(T=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new g.WriteBuffer((T,B)=>this._inputHandler.parse(T,B))),this.register((0,t.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed)),this.register((0,m.toDisposable)(()=>{var T;(T=this._windowsMode)===null||T===void 0||T.dispose(),this._windowsMode=void 0}))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new t.EventEmitter),this._onScroll.event(A=>{var T;(T=this._onScrollApi)===null||T===void 0||T.fire(A.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(A){for(const T in A)this.optionsService.options[T]=A[T]}write(A,T){this._writeBuffer.write(A,T)}writeSync(A,T){this._logService.logLevel<=f.LogLevelEnum.WARN&&!v&&(this._logService.warn("writeSync is unreliable and will be removed soon."),v=!0),this._writeBuffer.writeSync(A,T)}resize(A,T){isNaN(A)||isNaN(T)||(A=Math.max(A,y.MINIMUM_COLS),T=Math.max(T,y.MINIMUM_ROWS),this._bufferService.resize(A,T))}scroll(A,T=!1){this._bufferService.scroll(A,T)}scrollLines(A,T,B){this._bufferService.scrollLines(A,T,B)}scrollPages(A){this._bufferService.scrollPages(A)}scrollToTop(){this._bufferService.scrollToTop()}scrollToBottom(){this._bufferService.scrollToBottom()}scrollToLine(A){this._bufferService.scrollToLine(A)}registerEscHandler(A,T){return this._inputHandler.registerEscHandler(A,T)}registerDcsHandler(A,T){return this._inputHandler.registerDcsHandler(A,T)}registerCsiHandler(A,T){return this._inputHandler.registerCsiHandler(A,T)}registerOscHandler(A,T){return this._inputHandler.registerOscHandler(A,T)}_setup(){this.optionsService.rawOptions.windowsMode&&this._enableWindowsMode()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsModeOptionChange(A){var T;A?this._enableWindowsMode():((T=this._windowsMode)===null||T===void 0||T.dispose(),this._windowsMode=void 0)}_enableWindowsMode(){if(!this._windowsMode){const A=[];A.push(this.onLineFeed(l.updateWindowsModeWrappedState.bind(null,this._bufferService))),A.push(this.registerCsiHandler({final:"H"},()=>((0,l.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsMode={dispose:()=>{for(const T of A)T.dispose()}}}}}c.CoreTerminal=b},8460:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.forwardEvent=c.EventEmitter=void 0,c.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=S=>(this._listeners.push(S),{dispose:()=>{if(!this._disposed){for(let m=0;m<this._listeners.length;m++)if(this._listeners[m]===S)return void this._listeners.splice(m,1)}}})),this._event}fire(S,m){const f=[];for(let u=0;u<this._listeners.length;u++)f.push(this._listeners[u]);for(let u=0;u<f.length;u++)f[u].call(void 0,S,m)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},c.forwardEvent=function(S,m){return S(f=>m.fire(f))}},5435:function(q,c,S){var m=this&&this.__decorate||function(F,E,I,O){var P,J=arguments.length,j=J<3?E:O===null?O=Object.getOwnPropertyDescriptor(E,I):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")j=Reflect.decorate(F,E,I,O);else for(var X=F.length-1;X>=0;X--)(P=F[X])&&(j=(J<3?P(j):J>3?P(E,I,j):P(E,I))||j);return J>3&&j&&Object.defineProperty(E,I,j),j},f=this&&this.__param||function(F,E){return function(I,O){E(I,O,F)}};Object.defineProperty(c,"__esModule",{value:!0}),c.InputHandler=c.WindowsOptionsReportType=void 0;const u=S(2584),d=S(7116),y=S(2015),_=S(844),o=S(482),t=S(8437),h=S(8460),s=S(643),r=S(511),l=S(3734),p=S(2585),g=S(6242),w=S(6351),v=S(5941),b={"(":0,")":1,"*":2,"+":3,"-":1,".":2},L=131072;function A(F,E){if(F>24)return E.setWinLines||!1;switch(F){case 1:return!!E.restoreWin;case 2:return!!E.minimizeWin;case 3:return!!E.setWinPosition;case 4:return!!E.setWinSizePixels;case 5:return!!E.raiseWin;case 6:return!!E.lowerWin;case 7:return!!E.refreshWin;case 8:return!!E.setWinSizeChars;case 9:return!!E.maximizeWin;case 10:return!!E.fullscreenWin;case 11:return!!E.getWinState;case 13:return!!E.getWinPosition;case 14:return!!E.getWinSizePixels;case 15:return!!E.getScreenSizePixels;case 16:return!!E.getCellSizePixels;case 18:return!!E.getWinSizeChars;case 19:return!!E.getScreenSizeChars;case 20:return!!E.getIconTitle;case 21:return!!E.getWinTitle;case 22:return!!E.pushTitle;case 23:return!!E.popTitle;case 24:return!!E.setWinLines}return!1}var T;(function(F){F[F.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",F[F.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(T=c.WindowsOptionsReportType||(c.WindowsOptionsReportType={}));let B=0;class U extends _.Disposable{constructor(E,I,O,P,J,j,X,V,re=new y.EscapeSequenceParser){super(),this._bufferService=E,this._charsetService=I,this._coreService=O,this._logService=P,this._optionsService=J,this._oscLinkService=j,this._coreMouseService=X,this._unicodeService=V,this._parser=re,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new o.StringToUtf32,this._utf8Decoder=new o.Utf8ToUtf32,this._workCell=new r.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=t.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new h.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new h.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new h.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new h.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new h.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new h.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new h.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new h.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new h.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new h.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new h.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new h.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new h.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new D(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(G=>this._activeBuffer=G.activeBuffer)),this._parser.setCsiHandlerFallback((G,z)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(G),params:z.toArray()})}),this._parser.setEscHandlerFallback(G=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(G)})}),this._parser.setExecuteHandlerFallback(G=>{this._logService.debug("Unknown EXECUTE code: ",{code:G})}),this._parser.setOscHandlerFallback((G,z,W)=>{this._logService.debug("Unknown OSC code: ",{identifier:G,action:z,data:W})}),this._parser.setDcsHandlerFallback((G,z,W)=>{z==="HOOK"&&(W=W.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(G),action:z,payload:W})}),this._parser.setPrintHandler((G,z,W)=>this.print(G,z,W)),this._parser.registerCsiHandler({final:"@"},G=>this.insertChars(G)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},G=>this.scrollLeft(G)),this._parser.registerCsiHandler({final:"A"},G=>this.cursorUp(G)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},G=>this.scrollRight(G)),this._parser.registerCsiHandler({final:"B"},G=>this.cursorDown(G)),this._parser.registerCsiHandler({final:"C"},G=>this.cursorForward(G)),this._parser.registerCsiHandler({final:"D"},G=>this.cursorBackward(G)),this._parser.registerCsiHandler({final:"E"},G=>this.cursorNextLine(G)),this._parser.registerCsiHandler({final:"F"},G=>this.cursorPrecedingLine(G)),this._parser.registerCsiHandler({final:"G"},G=>this.cursorCharAbsolute(G)),this._parser.registerCsiHandler({final:"H"},G=>this.cursorPosition(G)),this._parser.registerCsiHandler({final:"I"},G=>this.cursorForwardTab(G)),this._parser.registerCsiHandler({final:"J"},G=>this.eraseInDisplay(G,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},G=>this.eraseInDisplay(G,!0)),this._parser.registerCsiHandler({final:"K"},G=>this.eraseInLine(G,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},G=>this.eraseInLine(G,!0)),this._parser.registerCsiHandler({final:"L"},G=>this.insertLines(G)),this._parser.registerCsiHandler({final:"M"},G=>this.deleteLines(G)),this._parser.registerCsiHandler({final:"P"},G=>this.deleteChars(G)),this._parser.registerCsiHandler({final:"S"},G=>this.scrollUp(G)),this._parser.registerCsiHandler({final:"T"},G=>this.scrollDown(G)),this._parser.registerCsiHandler({final:"X"},G=>this.eraseChars(G)),this._parser.registerCsiHandler({final:"Z"},G=>this.cursorBackwardTab(G)),this._parser.registerCsiHandler({final:"`"},G=>this.charPosAbsolute(G)),this._parser.registerCsiHandler({final:"a"},G=>this.hPositionRelative(G)),this._parser.registerCsiHandler({final:"b"},G=>this.repeatPrecedingCharacter(G)),this._parser.registerCsiHandler({final:"c"},G=>this.sendDeviceAttributesPrimary(G)),this._parser.registerCsiHandler({prefix:">",final:"c"},G=>this.sendDeviceAttributesSecondary(G)),this._parser.registerCsiHandler({final:"d"},G=>this.linePosAbsolute(G)),this._parser.registerCsiHandler({final:"e"},G=>this.vPositionRelative(G)),this._parser.registerCsiHandler({final:"f"},G=>this.hVPosition(G)),this._parser.registerCsiHandler({final:"g"},G=>this.tabClear(G)),this._parser.registerCsiHandler({final:"h"},G=>this.setMode(G)),this._parser.registerCsiHandler({prefix:"?",final:"h"},G=>this.setModePrivate(G)),this._parser.registerCsiHandler({final:"l"},G=>this.resetMode(G)),this._parser.registerCsiHandler({prefix:"?",final:"l"},G=>this.resetModePrivate(G)),this._parser.registerCsiHandler({final:"m"},G=>this.charAttributes(G)),this._parser.registerCsiHandler({final:"n"},G=>this.deviceStatus(G)),this._parser.registerCsiHandler({prefix:"?",final:"n"},G=>this.deviceStatusPrivate(G)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},G=>this.softReset(G)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},G=>this.setCursorStyle(G)),this._parser.registerCsiHandler({final:"r"},G=>this.setScrollRegion(G)),this._parser.registerCsiHandler({final:"s"},G=>this.saveCursor(G)),this._parser.registerCsiHandler({final:"t"},G=>this.windowOptions(G)),this._parser.registerCsiHandler({final:"u"},G=>this.restoreCursor(G)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},G=>this.insertColumns(G)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},G=>this.deleteColumns(G)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},G=>this.selectProtected(G)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},G=>this.requestMode(G,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},G=>this.requestMode(G,!1)),this._parser.setExecuteHandler(u.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(u.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(u.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(u.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(u.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(u.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(u.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(u.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(u.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(u.C1.IND,()=>this.index()),this._parser.setExecuteHandler(u.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(u.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new g.OscHandler(G=>(this.setTitle(G),this.setIconName(G),!0))),this._parser.registerOscHandler(1,new g.OscHandler(G=>this.setIconName(G))),this._parser.registerOscHandler(2,new g.OscHandler(G=>this.setTitle(G))),this._parser.registerOscHandler(4,new g.OscHandler(G=>this.setOrReportIndexedColor(G))),this._parser.registerOscHandler(8,new g.OscHandler(G=>this.setHyperlink(G))),this._parser.registerOscHandler(10,new g.OscHandler(G=>this.setOrReportFgColor(G))),this._parser.registerOscHandler(11,new g.OscHandler(G=>this.setOrReportBgColor(G))),this._parser.registerOscHandler(12,new g.OscHandler(G=>this.setOrReportCursorColor(G))),this._parser.registerOscHandler(104,new g.OscHandler(G=>this.restoreIndexedColor(G))),this._parser.registerOscHandler(110,new g.OscHandler(G=>this.restoreFgColor(G))),this._parser.registerOscHandler(111,new g.OscHandler(G=>this.restoreBgColor(G))),this._parser.registerOscHandler(112,new g.OscHandler(G=>this.restoreCursorColor(G))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const G in d.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:G},()=>this.selectCharset("("+G)),this._parser.registerEscHandler({intermediates:")",final:G},()=>this.selectCharset(")"+G)),this._parser.registerEscHandler({intermediates:"*",final:G},()=>this.selectCharset("*"+G)),this._parser.registerEscHandler({intermediates:"+",final:G},()=>this.selectCharset("+"+G)),this._parser.registerEscHandler({intermediates:"-",final:G},()=>this.selectCharset("-"+G)),this._parser.registerEscHandler({intermediates:".",final:G},()=>this.selectCharset("."+G)),this._parser.registerEscHandler({intermediates:"/",final:G},()=>this.selectCharset("/"+G));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(G=>(this._logService.error("Parsing error: ",G),G)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new w.DcsHandler((G,z)=>this.requestStatusString(G,z)))}getAttrData(){return this._curAttrData}_preserveStack(E,I,O,P){this._parseStack.paused=!0,this._parseStack.cursorStartX=E,this._parseStack.cursorStartY=I,this._parseStack.decodedLength=O,this._parseStack.position=P}_logSlowResolvingAsync(E){this._logService.logLevel<=p.LogLevelEnum.WARN&&Promise.race([E,new Promise((I,O)=>setTimeout(()=>O("#SLOW_TIMEOUT"),5e3))]).catch(I=>{if(I!=="#SLOW_TIMEOUT")throw I;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(E,I){let O,P=this._activeBuffer.x,J=this._activeBuffer.y,j=0;const X=this._parseStack.paused;if(X){if(O=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,I))return this._logSlowResolvingAsync(O),O;P=this._parseStack.cursorStartX,J=this._parseStack.cursorStartY,this._parseStack.paused=!1,E.length>L&&(j=this._parseStack.position+L)}if(this._logService.logLevel<=p.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof E=="string"?` "${E}"`:` "${Array.prototype.map.call(E,V=>String.fromCharCode(V)).join("")}"`),typeof E=="string"?E.split("").map(V=>V.charCodeAt(0)):E),this._parseBuffer.length<E.length&&this._parseBuffer.length<L&&(this._parseBuffer=new Uint32Array(Math.min(E.length,L))),X||this._dirtyRowTracker.clearRange(),E.length>L)for(let V=j;V<E.length;V+=L){const re=V+L<E.length?V+L:E.length,G=typeof E=="string"?this._stringDecoder.decode(E.substring(V,re),this._parseBuffer):this._utf8Decoder.decode(E.subarray(V,re),this._parseBuffer);if(O=this._parser.parse(this._parseBuffer,G))return this._preserveStack(P,J,G,V),this._logSlowResolvingAsync(O),O}else if(!X){const V=typeof E=="string"?this._stringDecoder.decode(E,this._parseBuffer):this._utf8Decoder.decode(E,this._parseBuffer);if(O=this._parser.parse(this._parseBuffer,V))return this._preserveStack(P,J,V,0),this._logSlowResolvingAsync(O),O}this._activeBuffer.x===P&&this._activeBuffer.y===J||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(E,I,O){let P,J;const j=this._charsetService.charset,X=this._optionsService.rawOptions.screenReaderMode,V=this._bufferService.cols,re=this._coreService.decPrivateModes.wraparound,G=this._coreService.modes.insertMode,z=this._curAttrData;let W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&O-I>0&&W.getWidth(this._activeBuffer.x-1)===2&&W.setCellFromCodePoint(this._activeBuffer.x-1,0,1,z.fg,z.bg,z.extended);for(let te=I;te<O;++te){if(P=E[te],J=this._unicodeService.wcwidth(P),P<127&&j){const ne=j[String.fromCharCode(P)];ne&&(P=ne.charCodeAt(0))}if(X&&this._onA11yChar.fire((0,o.stringFromCodePoint)(P)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),J||!this._activeBuffer.x){if(this._activeBuffer.x+J-1>=V){if(re){for(;this._activeBuffer.x<V;)W.setCellFromCodePoint(this._activeBuffer.x++,0,1,z.fg,z.bg,z.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=V-1,J===2)continue}if(G&&(W.insertCells(this._activeBuffer.x,J,this._activeBuffer.getNullCell(z),z),W.getWidth(V-1)===2&&W.setCellFromCodePoint(V-1,s.NULL_CELL_CODE,s.NULL_CELL_WIDTH,z.fg,z.bg,z.extended)),W.setCellFromCodePoint(this._activeBuffer.x++,P,J,z.fg,z.bg,z.extended),J>0)for(;--J;)W.setCellFromCodePoint(this._activeBuffer.x++,0,0,z.fg,z.bg,z.extended)}else W.getWidth(this._activeBuffer.x-1)?W.addCodepointToCell(this._activeBuffer.x-1,P):W.addCodepointToCell(this._activeBuffer.x-2,P)}O-I>0&&(W.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<V&&O-I>0&&W.getWidth(this._activeBuffer.x)===0&&!W.hasContent(this._activeBuffer.x)&&W.setCellFromCodePoint(this._activeBuffer.x,0,1,z.fg,z.bg,z.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(E,I){return E.final!=="t"||E.prefix||E.intermediates?this._parser.registerCsiHandler(E,I):this._parser.registerCsiHandler(E,O=>!A(O.params[0],this._optionsService.rawOptions.windowOptions)||I(O))}registerDcsHandler(E,I){return this._parser.registerDcsHandler(E,new w.DcsHandler(I))}registerEscHandler(E,I){return this._parser.registerEscHandler(E,I)}registerOscHandler(E,I){return this._parser.registerOscHandler(E,new g.OscHandler(I))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var E;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||E===void 0)&&E.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);I.hasWidth(this._activeBuffer.x)&&!I.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const E=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-E),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(E=this._bufferService.cols-1){this._activeBuffer.x=Math.min(E,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(E,I){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=E,this._activeBuffer.y=this._activeBuffer.scrollTop+I):(this._activeBuffer.x=E,this._activeBuffer.y=I),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(E,I){this._restrictCursor(),this._setCursor(this._activeBuffer.x+E,this._activeBuffer.y+I)}cursorUp(E){const I=this._activeBuffer.y-this._activeBuffer.scrollTop;return I>=0?this._moveCursor(0,-Math.min(I,E.params[0]||1)):this._moveCursor(0,-(E.params[0]||1)),!0}cursorDown(E){const I=this._activeBuffer.scrollBottom-this._activeBuffer.y;return I>=0?this._moveCursor(0,Math.min(I,E.params[0]||1)):this._moveCursor(0,E.params[0]||1),!0}cursorForward(E){return this._moveCursor(E.params[0]||1,0),!0}cursorBackward(E){return this._moveCursor(-(E.params[0]||1),0),!0}cursorNextLine(E){return this.cursorDown(E),this._activeBuffer.x=0,!0}cursorPrecedingLine(E){return this.cursorUp(E),this._activeBuffer.x=0,!0}cursorCharAbsolute(E){return this._setCursor((E.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(E){return this._setCursor(E.length>=2?(E.params[1]||1)-1:0,(E.params[0]||1)-1),!0}charPosAbsolute(E){return this._setCursor((E.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(E){return this._moveCursor(E.params[0]||1,0),!0}linePosAbsolute(E){return this._setCursor(this._activeBuffer.x,(E.params[0]||1)-1),!0}vPositionRelative(E){return this._moveCursor(0,E.params[0]||1),!0}hVPosition(E){return this.cursorPosition(E),!0}tabClear(E){const I=E.params[0];return I===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:I===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(E){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let I=E.params[0]||1;for(;I--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(E){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let I=E.params[0]||1;for(;I--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(E){const I=E.params[0];return I===1&&(this._curAttrData.bg|=536870912),I!==2&&I!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(E,I,O,P=!1,J=!1){const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);j.replaceCells(I,O,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),J),P&&(j.isWrapped=!1)}_resetBufferLine(E,I=!1){const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+E);O.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),I),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+E),O.isWrapped=!1}eraseInDisplay(E,I=!1){let O;switch(this._restrictCursor(this._bufferService.cols),E.params[0]){case 0:for(O=this._activeBuffer.y,this._dirtyRowTracker.markDirty(O),this._eraseInBufferLine(O++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,I);O<this._bufferService.rows;O++)this._resetBufferLine(O,I);this._dirtyRowTracker.markDirty(O);break;case 1:for(O=this._activeBuffer.y,this._dirtyRowTracker.markDirty(O),this._eraseInBufferLine(O,0,this._activeBuffer.x+1,!0,I),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(O+1).isWrapped=!1);O--;)this._resetBufferLine(O,I);this._dirtyRowTracker.markDirty(0);break;case 2:for(O=this._bufferService.rows,this._dirtyRowTracker.markDirty(O-1);O--;)this._resetBufferLine(O,I);this._dirtyRowTracker.markDirty(0);break;case 3:const P=this._activeBuffer.lines.length-this._bufferService.rows;P>0&&(this._activeBuffer.lines.trimStart(P),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-P,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-P,0),this._onScroll.fire(0))}return!0}eraseInLine(E,I=!1){switch(this._restrictCursor(this._bufferService.cols),E.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,I);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,I);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,I)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(E){this._restrictCursor();let I=E.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=this._activeBuffer.ybase+this._activeBuffer.y,P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,J=this._bufferService.rows-1+this._activeBuffer.ybase-P+1;for(;I--;)this._activeBuffer.lines.splice(J-1,1),this._activeBuffer.lines.splice(O,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(E){this._restrictCursor();let I=E.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=this._activeBuffer.ybase+this._activeBuffer.y;let P;for(P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,P=this._bufferService.rows-1+this._activeBuffer.ybase-P;I--;)this._activeBuffer.lines.splice(O,1),this._activeBuffer.lines.splice(P,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(E){this._restrictCursor();const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return I&&(I.insertCells(this._activeBuffer.x,E.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(E){this._restrictCursor();const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return I&&(I.deleteCells(this._activeBuffer.x,E.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(E){let I=E.params[0]||1;for(;I--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(E){let I=E.params[0]||1;for(;I--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(t.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=E.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);P.deleteCells(0,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=E.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);P.insertCells(0,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=E.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);P.insertCells(this._activeBuffer.x,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(E){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=E.params[0]||1;for(let O=this._activeBuffer.scrollTop;O<=this._activeBuffer.scrollBottom;++O){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+O);P.deleteCells(this._activeBuffer.x,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(E){this._restrictCursor();const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return I&&(I.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(E.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(E){if(!this._parser.precedingCodepoint)return!0;const I=E.params[0]||1,O=new Uint32Array(I);for(let P=0;P<I;++P)O[P]=this._parser.precedingCodepoint;return this.print(O,0,O.length),!0}sendDeviceAttributesPrimary(E){return E.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(u.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(u.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(E){return E.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(u.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(u.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(E.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(u.C0.ESC+"[>83;40003;0c")),!0}_is(E){return(this._optionsService.rawOptions.termName+"").indexOf(E)===0}setMode(E){for(let I=0;I<E.length;I++)switch(E.params[I]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(E){for(let I=0;I<E.length;I++)switch(E.params[I]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,d.DEFAULT_CHARSET),this._charsetService.setgCharset(1,d.DEFAULT_CHARSET),this._charsetService.setgCharset(2,d.DEFAULT_CHARSET),this._charsetService.setgCharset(3,d.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(E){for(let I=0;I<E.length;I++)switch(E.params[I]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(E){for(let I=0;I<E.length;I++)switch(E.params[I]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),E.params[I]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(E,I){const O=this._coreService.decPrivateModes,{activeProtocol:P,activeEncoding:J}=this._coreMouseService,j=this._coreService,{buffers:X,cols:V}=this._bufferService,{active:re,alt:G}=X,z=this._optionsService.rawOptions,W=ce=>ce?1:2,te=E.params[0];return ne=te,Se=I?te===2?4:te===4?W(j.modes.insertMode):te===12?3:te===20?W(z.convertEol):0:te===1?W(O.applicationCursorKeys):te===3?z.windowOptions.setWinLines?V===80?2:V===132?1:0:0:te===6?W(O.origin):te===7?W(O.wraparound):te===8?3:te===9?W(P==="X10"):te===12?W(z.cursorBlink):te===25?W(!j.isCursorHidden):te===45?W(O.reverseWraparound):te===66?W(O.applicationKeypad):te===67?4:te===1e3?W(P==="VT200"):te===1002?W(P==="DRAG"):te===1003?W(P==="ANY"):te===1004?W(O.sendFocus):te===1005?4:te===1006?W(J==="SGR"):te===1015?4:te===1016?W(J==="SGR_PIXELS"):te===1048?1:te===47||te===1047||te===1049?W(re===G):te===2004?W(O.bracketedPasteMode):0,j.triggerDataEvent(`${u.C0.ESC}[${I?"":"?"}${ne};${Se}$y`),!0;var ne,Se}_updateAttrColor(E,I,O,P,J){return I===2?(E|=50331648,E&=-16777216,E|=l.AttributeData.fromColorRGB([O,P,J])):I===5&&(E&=-50331904,E|=33554432|255&O),E}_extractColor(E,I,O){const P=[0,0,-1,0,0,0];let J=0,j=0;do{if(P[j+J]=E.params[I+j],E.hasSubParams(I+j)){const X=E.getSubParams(I+j);let V=0;do P[1]===5&&(J=1),P[j+V+1+J]=X[V];while(++V<X.length&&V+j+1+J<P.length);break}if(P[1]===5&&j+J>=2||P[1]===2&&j+J>=5)break;P[1]&&(J=1)}while(++j+I<E.length&&j+J<P.length);for(let X=2;X<P.length;++X)P[X]===-1&&(P[X]=0);switch(P[0]){case 38:O.fg=this._updateAttrColor(O.fg,P[1],P[3],P[4],P[5]);break;case 48:O.bg=this._updateAttrColor(O.bg,P[1],P[3],P[4],P[5]);break;case 58:O.extended=O.extended.clone(),O.extended.underlineColor=this._updateAttrColor(O.extended.underlineColor,P[1],P[3],P[4],P[5])}return j}_processUnderline(E,I){I.extended=I.extended.clone(),(!~E||E>5)&&(E=1),I.extended.underlineStyle=E,I.fg|=268435456,E===0&&(I.fg&=-268435457),I.updateExtended()}_processSGR0(E){E.fg=t.DEFAULT_ATTR_DATA.fg,E.bg=t.DEFAULT_ATTR_DATA.bg,E.extended=E.extended.clone(),E.extended.underlineStyle=0,E.extended.underlineColor&=-67108864,E.updateExtended()}charAttributes(E){if(E.length===1&&E.params[0]===0)return this._processSGR0(this._curAttrData),!0;const I=E.length;let O;const P=this._curAttrData;for(let J=0;J<I;J++)O=E.params[J],O>=30&&O<=37?(P.fg&=-50331904,P.fg|=16777216|O-30):O>=40&&O<=47?(P.bg&=-50331904,P.bg|=16777216|O-40):O>=90&&O<=97?(P.fg&=-50331904,P.fg|=16777224|O-90):O>=100&&O<=107?(P.bg&=-50331904,P.bg|=16777224|O-100):O===0?this._processSGR0(P):O===1?P.fg|=134217728:O===3?P.bg|=67108864:O===4?(P.fg|=268435456,this._processUnderline(E.hasSubParams(J)?E.getSubParams(J)[0]:1,P)):O===5?P.fg|=536870912:O===7?P.fg|=67108864:O===8?P.fg|=1073741824:O===9?P.fg|=2147483648:O===2?P.bg|=134217728:O===21?this._processUnderline(2,P):O===22?(P.fg&=-134217729,P.bg&=-134217729):O===23?P.bg&=-67108865:O===24?(P.fg&=-268435457,this._processUnderline(0,P)):O===25?P.fg&=-536870913:O===27?P.fg&=-67108865:O===28?P.fg&=-1073741825:O===29?P.fg&=2147483647:O===39?(P.fg&=-67108864,P.fg|=16777215&t.DEFAULT_ATTR_DATA.fg):O===49?(P.bg&=-67108864,P.bg|=16777215&t.DEFAULT_ATTR_DATA.bg):O===38||O===48||O===58?J+=this._extractColor(E,J,P):O===53?P.bg|=1073741824:O===55?P.bg&=-1073741825:O===59?(P.extended=P.extended.clone(),P.extended.underlineColor=-1,P.updateExtended()):O===100?(P.fg&=-67108864,P.fg|=16777215&t.DEFAULT_ATTR_DATA.fg,P.bg&=-67108864,P.bg|=16777215&t.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",O);return!0}deviceStatus(E){switch(E.params[0]){case 5:this._coreService.triggerDataEvent(`${u.C0.ESC}[0n`);break;case 6:const I=this._activeBuffer.y+1,O=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${u.C0.ESC}[${I};${O}R`)}return!0}deviceStatusPrivate(E){if(E.params[0]===6){const I=this._activeBuffer.y+1,O=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${u.C0.ESC}[?${I};${O}R`)}return!0}softReset(E){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(E){const I=E.params[0]||1;switch(I){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const O=I%2==1;return this._optionsService.options.cursorBlink=O,!0}setScrollRegion(E){const I=E.params[0]||1;let O;return(E.length<2||(O=E.params[1])>this._bufferService.rows||O===0)&&(O=this._bufferService.rows),O>I&&(this._activeBuffer.scrollTop=I-1,this._activeBuffer.scrollBottom=O-1,this._setCursor(0,0)),!0}windowOptions(E){if(!A(E.params[0],this._optionsService.rawOptions.windowOptions))return!0;const I=E.length>1?E.params[1]:0;switch(E.params[0]){case 14:I!==2&&this._onRequestWindowsOptionsReport.fire(T.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(T.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${u.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:I!==0&&I!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),I!==0&&I!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:I!==0&&I!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),I!==0&&I!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(E){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(E){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(E){return this._windowTitle=E,this._onTitleChange.fire(E),!0}setIconName(E){return this._iconName=E,!0}setOrReportIndexedColor(E){const I=[],O=E.split(";");for(;O.length>1;){const P=O.shift(),J=O.shift();if(/^\d+$/.exec(P)){const j=parseInt(P);if(0<=j&&j<256)if(J==="?")I.push({type:0,index:j});else{const X=(0,v.parseColor)(J);X&&I.push({type:1,index:j,color:X})}}}return I.length&&this._onColor.fire(I),!0}setHyperlink(E){const I=E.split(";");return!(I.length<2)&&(I[1]?this._createHyperlink(I[0],I[1]):!I[0]&&this._finishHyperlink())}_createHyperlink(E,I){this._getCurrentLinkId()&&this._finishHyperlink();const O=E.split(":");let P;const J=O.findIndex(j=>j.startsWith("id="));return J!==-1&&(P=O[J].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:P,uri:I}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(E,I){const O=E.split(";");for(let P=0;P<O.length&&!(I>=this._specialColors.length);++P,++I)if(O[P]==="?")this._onColor.fire([{type:0,index:this._specialColors[I]}]);else{const J=(0,v.parseColor)(O[P]);J&&this._onColor.fire([{type:1,index:this._specialColors[I],color:J}])}return!0}setOrReportFgColor(E){return this._setOrReportSpecialColor(E,0)}setOrReportBgColor(E){return this._setOrReportSpecialColor(E,1)}setOrReportCursorColor(E){return this._setOrReportSpecialColor(E,2)}restoreIndexedColor(E){if(!E)return this._onColor.fire([{type:2}]),!0;const I=[],O=E.split(";");for(let P=0;P<O.length;++P)if(/^\d+$/.exec(O[P])){const J=parseInt(O[P]);0<=J&&J<256&&I.push({type:2,index:J})}return I.length&&this._onColor.fire(I),!0}restoreFgColor(E){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(E){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(E){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,d.DEFAULT_CHARSET),!0}selectCharset(E){return E.length!==2?(this.selectDefaultCharset(),!0):(E[0]==="/"||this._charsetService.setgCharset(b[E[0]],d.CHARSETS[E[1]]||d.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const E=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,E,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=t.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=t.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(E){return this._charsetService.setgLevel(E),!0}screenAlignmentPattern(){const E=new r.CellData;E.content=4194304|"E".charCodeAt(0),E.fg=this._curAttrData.fg,E.bg=this._curAttrData.bg,this._setCursor(0,0);for(let I=0;I<this._bufferService.rows;++I){const O=this._activeBuffer.ybase+this._activeBuffer.y+I,P=this._activeBuffer.lines.get(O);P&&(P.fill(E),P.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(E,I){const O=this._bufferService.buffer,P=this._optionsService.rawOptions;return(J=>(this._coreService.triggerDataEvent(`${u.C0.ESC}${J}${u.C0.ESC}\\`),!0))(E==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:E==='"p'?'P1$r61;1"p':E==="r"?`P1$r${O.scrollTop+1};${O.scrollBottom+1}r`:E==="m"?"P1$r0m":E===" q"?`P1$r${{block:2,underline:4,bar:6}[P.cursorStyle]-(P.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(E,I){this._dirtyRowTracker.markRangeDirty(E,I)}}c.InputHandler=U;let D=class{constructor(F){this._bufferService=F,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(F){F<this.start?this.start=F:F>this.end&&(this.end=F)}markRangeDirty(F,E){F>E&&(B=F,F=E,E=B),F<this.start&&(this.start=F),E>this.end&&(this.end=E)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};D=m([f(0,p.IBufferService)],D)},844:(q,c)=>{function S(m){for(const f of m)f.dispose();m.length=0}Object.defineProperty(c,"__esModule",{value:!0}),c.getDisposeArrayDisposable=c.disposeArray=c.toDisposable=c.Disposable=void 0,c.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const m of this._disposables)m.dispose();this._disposables.length=0}register(m){return this._disposables.push(m),m}unregister(m){const f=this._disposables.indexOf(m);f!==-1&&this._disposables.splice(f,1)}},c.toDisposable=function(m){return{dispose:m}},c.disposeArray=S,c.getDisposeArrayDisposable=function(m){return{dispose:()=>S(m)}}},1505:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.FourKeyMap=c.TwoKeyMap=void 0;class S{constructor(){this._data={}}set(f,u,d){this._data[f]||(this._data[f]={}),this._data[f][u]=d}get(f,u){return this._data[f]?this._data[f][u]:void 0}clear(){this._data={}}}c.TwoKeyMap=S,c.FourKeyMap=class{constructor(){this._data=new S}set(m,f,u,d,y){this._data.get(m,f)||this._data.set(m,f,new S),this._data.get(m,f).set(u,d,y)}get(m,f,u,d){var y;return(y=this._data.get(m,f))===null||y===void 0?void 0:y.get(u,d)}clear(){this._data.clear()}}},6114:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.isChromeOS=c.isLinux=c.isWindows=c.isIphone=c.isIpad=c.isMac=c.getSafariVersion=c.isSafari=c.isLegacyEdge=c.isFirefox=c.isNode=void 0,c.isNode=typeof navigator>"u";const S=c.isNode?"node":navigator.userAgent,m=c.isNode?"node":navigator.platform;c.isFirefox=S.includes("Firefox"),c.isLegacyEdge=S.includes("Edge"),c.isSafari=/^((?!chrome|android).)*safari/i.test(S),c.getSafariVersion=function(){if(!c.isSafari)return 0;const f=S.match(/Version\/(\d+)/);return f===null||f.length<2?0:parseInt(f[1])},c.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(m),c.isIpad=m==="iPad",c.isIphone=m==="iPhone",c.isWindows=["Windows","Win16","Win32","WinCE"].includes(m),c.isLinux=m.indexOf("Linux")>=0,c.isChromeOS=/\bCrOS\b/.test(S)},6106:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SortedList=void 0;let S=0;c.SortedList=class{constructor(m){this._getKey=m,this._array=[]}clear(){this._array.length=0}insert(m){this._array.length!==0?(S=this._search(this._getKey(m),0,this._array.length-1),this._array.splice(S,0,m)):this._array.push(m)}delete(m){if(this._array.length===0)return!1;const f=this._getKey(m);if(f===void 0||(S=this._search(f,0,this._array.length-1),S===-1)||this._getKey(this._array[S])!==f)return!1;do if(this._array[S]===m)return this._array.splice(S,1),!0;while(++S<this._array.length&&this._getKey(this._array[S])===f);return!1}*getKeyIterator(m){if(this._array.length!==0&&(S=this._search(m,0,this._array.length-1),!(S<0||S>=this._array.length)&&this._getKey(this._array[S])===m))do yield this._array[S];while(++S<this._array.length&&this._getKey(this._array[S])===m)}forEachByKey(m,f){if(this._array.length!==0&&(S=this._search(m,0,this._array.length-1),!(S<0||S>=this._array.length)&&this._getKey(this._array[S])===m))do f(this._array[S]);while(++S<this._array.length&&this._getKey(this._array[S])===m)}values(){return this._array.values()}_search(m,f,u){if(u<f)return f;let d=Math.floor((f+u)/2);const y=this._getKey(this._array[d]);if(y>m)return this._search(m,f,d-1);if(y<m)return this._search(m,d+1,u);for(;d>0&&this._getKey(this._array[d-1])===m;)d--;return d}}},7226:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DebouncedIdleTask=c.IdleTaskQueue=c.PriorityTaskQueue=void 0;const m=S(6114);class f{constructor(){this._tasks=[],this._i=0}enqueue(y){this._tasks.push(y),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(y){this._idleCallback=void 0;let _=0,o=0,t=y.timeRemaining(),h=0;for(;this._i<this._tasks.length;){if(_=Date.now(),this._tasks[this._i]()||this._i++,_=Math.max(1,Date.now()-_),o=Math.max(_,o),h=y.timeRemaining(),1.5*o>h)return t-_<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(t-_))}ms`),void this._start();t=h}this.clear()}}class u extends f{_requestCallback(y){return setTimeout(()=>y(this._createDeadline(16)))}_cancelCallback(y){clearTimeout(y)}_createDeadline(y){const _=Date.now()+y;return{timeRemaining:()=>Math.max(0,_-Date.now())}}}c.PriorityTaskQueue=u,c.IdleTaskQueue=!m.isNode&&"requestIdleCallback"in window?class extends f{_requestCallback(d){return requestIdleCallback(d)}_cancelCallback(d){cancelIdleCallback(d)}}:u,c.DebouncedIdleTask=class{constructor(){this._queue=new c.IdleTaskQueue}set(d){this._queue.clear(),this._queue.enqueue(d)}flush(){this._queue.flush()}}},9282:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.updateWindowsModeWrappedState=void 0;const m=S(643);c.updateWindowsModeWrappedState=function(f){const u=f.buffer.lines.get(f.buffer.ybase+f.buffer.y-1),d=u==null?void 0:u.get(f.cols-1),y=f.buffer.lines.get(f.buffer.ybase+f.buffer.y);y&&d&&(y.isWrapped=d[m.CHAR_DATA_CODE_INDEX]!==m.NULL_CELL_CODE&&d[m.CHAR_DATA_CODE_INDEX]!==m.WHITESPACE_CELL_CODE)}},3734:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ExtendedAttrs=c.AttributeData=void 0;class S{constructor(){this.fg=0,this.bg=0,this.extended=new m}static toColorRGB(u){return[u>>>16&255,u>>>8&255,255&u]}static fromColorRGB(u){return(255&u[0])<<16|(255&u[1])<<8|255&u[2]}clone(){const u=new S;return u.fg=this.fg,u.bg=this.bg,u.extended=this.extended.clone(),u}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}c.AttributeData=S;class m{constructor(u=0,d=0){this._ext=0,this._urlId=0,this._ext=u,this._urlId=d}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(u){this._ext=u}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(u){this._ext&=-469762049,this._ext|=u<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(u){this._ext&=-67108864,this._ext|=67108863&u}get urlId(){return this._urlId}set urlId(u){this._urlId=u}clone(){return new m(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}c.ExtendedAttrs=m},9092:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Buffer=c.MAX_BUFFER_SIZE=void 0;const m=S(6349),f=S(8437),u=S(511),d=S(643),y=S(4634),_=S(4863),o=S(7116),t=S(3734),h=S(7226);c.MAX_BUFFER_SIZE=4294967295,c.Buffer=class{constructor(s,r,l){this._hasScrollback=s,this._optionsService=r,this._bufferService=l,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=f.DEFAULT_ATTR_DATA.clone(),this.savedCharset=o.DEFAULT_CHARSET,this.markers=[],this._nullCell=u.CellData.fromCharData([0,d.NULL_CELL_CHAR,d.NULL_CELL_WIDTH,d.NULL_CELL_CODE]),this._whitespaceCell=u.CellData.fromCharData([0,d.WHITESPACE_CELL_CHAR,d.WHITESPACE_CELL_WIDTH,d.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new h.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new m.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(s){return s?(this._nullCell.fg=s.fg,this._nullCell.bg=s.bg,this._nullCell.extended=s.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new t.ExtendedAttrs),this._nullCell}getWhitespaceCell(s){return s?(this._whitespaceCell.fg=s.fg,this._whitespaceCell.bg=s.bg,this._whitespaceCell.extended=s.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new t.ExtendedAttrs),this._whitespaceCell}getBlankLine(s,r){return new f.BufferLine(this._bufferService.cols,this.getNullCell(s),r)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const s=this.ybase+this.y-this.ydisp;return s>=0&&s<this._rows}_getCorrectBufferLength(s){if(!this._hasScrollback)return s;const r=s+this._optionsService.rawOptions.scrollback;return r>c.MAX_BUFFER_SIZE?c.MAX_BUFFER_SIZE:r}fillViewportRows(s){if(this.lines.length===0){s===void 0&&(s=f.DEFAULT_ATTR_DATA);let r=this._rows;for(;r--;)this.lines.push(this.getBlankLine(s))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new m.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(s,r){const l=this.getNullCell(f.DEFAULT_ATTR_DATA);let p=0;const g=this._getCorrectBufferLength(r);if(g>this.lines.maxLength&&(this.lines.maxLength=g),this.lines.length>0){if(this._cols<s)for(let v=0;v<this.lines.length;v++)p+=+this.lines.get(v).resize(s,l);let w=0;if(this._rows<r)for(let v=this._rows;v<r;v++)this.lines.length<r+this.ybase&&(this._optionsService.rawOptions.windowsMode?this.lines.push(new f.BufferLine(s,l)):this.ybase>0&&this.lines.length<=this.ybase+this.y+w+1?(this.ybase--,w++,this.ydisp>0&&this.ydisp--):this.lines.push(new f.BufferLine(s,l)));else for(let v=this._rows;v>r;v--)this.lines.length>r+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(g<this.lines.maxLength){const v=this.lines.length-g;v>0&&(this.lines.trimStart(v),this.ybase=Math.max(this.ybase-v,0),this.ydisp=Math.max(this.ydisp-v,0),this.savedY=Math.max(this.savedY-v,0)),this.lines.maxLength=g}this.x=Math.min(this.x,s-1),this.y=Math.min(this.y,r-1),w&&(this.y+=w),this.savedX=Math.min(this.savedX,s-1),this.scrollTop=0}if(this.scrollBottom=r-1,this._isReflowEnabled&&(this._reflow(s,r),this._cols>s))for(let w=0;w<this.lines.length;w++)p+=+this.lines.get(w).resize(s,l);this._cols=s,this._rows=r,this._memoryCleanupQueue.clear(),p>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let s=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,s=!1);let r=0;for(;this._memoryCleanupPosition<this.lines.length;)if(r+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),r>100)return!0;return s}get _isReflowEnabled(){return this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(s,r){this._cols!==s&&(s>this._cols?this._reflowLarger(s,r):this._reflowSmaller(s,r))}_reflowLarger(s,r){const l=(0,y.reflowLargerGetLinesToRemove)(this.lines,this._cols,s,this.ybase+this.y,this.getNullCell(f.DEFAULT_ATTR_DATA));if(l.length>0){const p=(0,y.reflowLargerCreateNewLayout)(this.lines,l);(0,y.reflowLargerApplyNewLayout)(this.lines,p.layout),this._reflowLargerAdjustViewport(s,r,p.countRemoved)}}_reflowLargerAdjustViewport(s,r,l){const p=this.getNullCell(f.DEFAULT_ATTR_DATA);let g=l;for(;g-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<r&&this.lines.push(new f.BufferLine(s,p))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-l,0)}_reflowSmaller(s,r){const l=this.getNullCell(f.DEFAULT_ATTR_DATA),p=[];let g=0;for(let w=this.lines.length-1;w>=0;w--){let v=this.lines.get(w);if(!v||!v.isWrapped&&v.getTrimmedLength()<=s)continue;const b=[v];for(;v.isWrapped&&w>0;)v=this.lines.get(--w),b.unshift(v);const L=this.ybase+this.y;if(L>=w&&L<w+b.length)continue;const A=b[b.length-1].getTrimmedLength(),T=(0,y.reflowSmallerGetNewLineLengths)(b,this._cols,s),B=T.length-b.length;let U;U=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+B):Math.max(0,this.lines.length-this.lines.maxLength+B);const D=[];for(let J=0;J<B;J++){const j=this.getBlankLine(f.DEFAULT_ATTR_DATA,!0);D.push(j)}D.length>0&&(p.push({start:w+b.length+g,newLines:D}),g+=D.length),b.push(...D);let F=T.length-1,E=T[F];E===0&&(F--,E=T[F]);let I=b.length-B-1,O=A;for(;I>=0;){const J=Math.min(O,E);if(b[F]===void 0)break;if(b[F].copyCellsFrom(b[I],O-J,E-J,J,!0),E-=J,E===0&&(F--,E=T[F]),O-=J,O===0){I--;const j=Math.max(I,0);O=(0,y.getWrappedLineTrimmedLength)(b,j,this._cols)}}for(let J=0;J<b.length;J++)T[J]<s&&b[J].setCell(T[J],l);let P=B-U;for(;P-- >0;)this.ybase===0?this.y<r-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+g)-r&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+B,this.ybase+r-1)}if(p.length>0){const w=[],v=[];for(let F=0;F<this.lines.length;F++)v.push(this.lines.get(F));const b=this.lines.length;let L=b-1,A=0,T=p[A];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+g);let B=0;for(let F=Math.min(this.lines.maxLength-1,b+g-1);F>=0;F--)if(T&&T.start>L+B){for(let E=T.newLines.length-1;E>=0;E--)this.lines.set(F--,T.newLines[E]);F++,w.push({index:L+1,amount:T.newLines.length}),B+=T.newLines.length,T=p[++A]}else this.lines.set(F,v[L--]);let U=0;for(let F=w.length-1;F>=0;F--)w[F].index+=U,this.lines.onInsertEmitter.fire(w[F]),U+=w[F].amount;const D=Math.max(0,b+g-this.lines.maxLength);D>0&&this.lines.onTrimEmitter.fire(D)}}translateBufferLineToString(s,r,l=0,p){const g=this.lines.get(s);return g?g.translateToString(r,l,p):""}getWrappedRangeForLine(s){let r=s,l=s;for(;r>0&&this.lines.get(r).isWrapped;)r--;for(;l+1<this.lines.length&&this.lines.get(l+1).isWrapped;)l++;return{first:r,last:l}}setupTabStops(s){for(s!=null?this.tabs[s]||(s=this.prevStop(s)):(this.tabs={},s=0);s<this._cols;s+=this._optionsService.rawOptions.tabStopWidth)this.tabs[s]=!0}prevStop(s){for(s==null&&(s=this.x);!this.tabs[--s]&&s>0;);return s>=this._cols?this._cols-1:s<0?0:s}nextStop(s){for(s==null&&(s=this.x);!this.tabs[++s]&&s<this._cols;);return s>=this._cols?this._cols-1:s<0?0:s}clearMarkers(s){this._isClearing=!0;for(let r=0;r<this.markers.length;r++)this.markers[r].line===s&&(this.markers[r].dispose(),this.markers.splice(r--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let s=0;s<this.markers.length;s++)this.markers[s].dispose(),this.markers.splice(s--,1);this._isClearing=!1}addMarker(s){const r=new _.Marker(s);return this.markers.push(r),r.register(this.lines.onTrim(l=>{r.line-=l,r.line<0&&r.dispose()})),r.register(this.lines.onInsert(l=>{r.line>=l.index&&(r.line+=l.amount)})),r.register(this.lines.onDelete(l=>{r.line>=l.index&&r.line<l.index+l.amount&&r.dispose(),r.line>l.index&&(r.line-=l.amount)})),r.register(r.onDispose(()=>this._removeMarker(r))),r}_removeMarker(s){this._isClearing||this.markers.splice(this.markers.indexOf(s),1)}}},8437:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferLine=c.DEFAULT_ATTR_DATA=void 0;const m=S(482),f=S(643),u=S(511),d=S(3734);c.DEFAULT_ATTR_DATA=Object.freeze(new d.AttributeData);let y=0;class _{constructor(t,h,s=!1){this.isWrapped=s,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*t);const r=h||u.CellData.fromCharData([0,f.NULL_CELL_CHAR,f.NULL_CELL_WIDTH,f.NULL_CELL_CODE]);for(let l=0;l<t;++l)this.setCell(l,r);this.length=t}get(t){const h=this._data[3*t+0],s=2097151&h;return[this._data[3*t+1],2097152&h?this._combined[t]:s?(0,m.stringFromCodePoint)(s):"",h>>22,2097152&h?this._combined[t].charCodeAt(this._combined[t].length-1):s]}set(t,h){this._data[3*t+1]=h[f.CHAR_DATA_ATTR_INDEX],h[f.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[t]=h[1],this._data[3*t+0]=2097152|t|h[f.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*t+0]=h[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|h[f.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(t){return this._data[3*t+0]>>22}hasWidth(t){return 12582912&this._data[3*t+0]}getFg(t){return this._data[3*t+1]}getBg(t){return this._data[3*t+2]}hasContent(t){return 4194303&this._data[3*t+0]}getCodePoint(t){const h=this._data[3*t+0];return 2097152&h?this._combined[t].charCodeAt(this._combined[t].length-1):2097151&h}isCombined(t){return 2097152&this._data[3*t+0]}getString(t){const h=this._data[3*t+0];return 2097152&h?this._combined[t]:2097151&h?(0,m.stringFromCodePoint)(2097151&h):""}isProtected(t){return 536870912&this._data[3*t+2]}loadCell(t,h){return y=3*t,h.content=this._data[y+0],h.fg=this._data[y+1],h.bg=this._data[y+2],2097152&h.content&&(h.combinedData=this._combined[t]),268435456&h.bg&&(h.extended=this._extendedAttrs[t]),h}setCell(t,h){2097152&h.content&&(this._combined[t]=h.combinedData),268435456&h.bg&&(this._extendedAttrs[t]=h.extended),this._data[3*t+0]=h.content,this._data[3*t+1]=h.fg,this._data[3*t+2]=h.bg}setCellFromCodePoint(t,h,s,r,l,p){268435456&l&&(this._extendedAttrs[t]=p),this._data[3*t+0]=h|s<<22,this._data[3*t+1]=r,this._data[3*t+2]=l}addCodepointToCell(t,h){let s=this._data[3*t+0];2097152&s?this._combined[t]+=(0,m.stringFromCodePoint)(h):(2097151&s?(this._combined[t]=(0,m.stringFromCodePoint)(2097151&s)+(0,m.stringFromCodePoint)(h),s&=-2097152,s|=2097152):s=h|4194304,this._data[3*t+0]=s)}insertCells(t,h,s,r){if((t%=this.length)&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new d.ExtendedAttrs),h<this.length-t){const l=new u.CellData;for(let p=this.length-t-h-1;p>=0;--p)this.setCell(t+h+p,this.loadCell(t+p,l));for(let p=0;p<h;++p)this.setCell(t+p,s)}else for(let l=t;l<this.length;++l)this.setCell(l,s);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new d.ExtendedAttrs)}deleteCells(t,h,s,r){if(t%=this.length,h<this.length-t){const l=new u.CellData;for(let p=0;p<this.length-t-h;++p)this.setCell(t+p,this.loadCell(t+h+p,l));for(let p=this.length-h;p<this.length;++p)this.setCell(p,s)}else for(let l=t;l<this.length;++l)this.setCell(l,s);t&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new d.ExtendedAttrs),this.getWidth(t)!==0||this.hasContent(t)||this.setCellFromCodePoint(t,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new d.ExtendedAttrs)}replaceCells(t,h,s,r,l=!1){if(l)for(t&&this.getWidth(t-1)===2&&!this.isProtected(t-1)&&this.setCellFromCodePoint(t-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new d.ExtendedAttrs),h<this.length&&this.getWidth(h-1)===2&&!this.isProtected(h)&&this.setCellFromCodePoint(h,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new d.ExtendedAttrs);t<h&&t<this.length;)this.isProtected(t)||this.setCell(t,s),t++;else for(t&&this.getWidth(t-1)===2&&this.setCellFromCodePoint(t-1,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new d.ExtendedAttrs),h<this.length&&this.getWidth(h-1)===2&&this.setCellFromCodePoint(h,0,1,(r==null?void 0:r.fg)||0,(r==null?void 0:r.bg)||0,(r==null?void 0:r.extended)||new d.ExtendedAttrs);t<h&&t<this.length;)this.setCell(t++,s)}resize(t,h){if(t===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const s=3*t;if(t>this.length){if(this._data.buffer.byteLength>=4*s)this._data=new Uint32Array(this._data.buffer,0,s);else{const r=new Uint32Array(s);r.set(this._data),this._data=r}for(let r=this.length;r<t;++r)this.setCell(r,h)}else{this._data=this._data.subarray(0,s);const r=Object.keys(this._combined);for(let p=0;p<r.length;p++){const g=parseInt(r[p],10);g>=t&&delete this._combined[g]}const l=Object.keys(this._extendedAttrs);for(let p=0;p<l.length;p++){const g=parseInt(l[p],10);g>=t&&delete this._extendedAttrs[g]}}return this.length=t,4*s*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const t=new Uint32Array(this._data.length);return t.set(this._data),this._data=t,1}return 0}fill(t,h=!1){if(h)for(let s=0;s<this.length;++s)this.isProtected(s)||this.setCell(s,t);else{this._combined={},this._extendedAttrs={};for(let s=0;s<this.length;++s)this.setCell(s,t)}}copyFrom(t){this.length!==t.length?this._data=new Uint32Array(t._data):this._data.set(t._data),this.length=t.length,this._combined={};for(const h in t._combined)this._combined[h]=t._combined[h];this._extendedAttrs={};for(const h in t._extendedAttrs)this._extendedAttrs[h]=t._extendedAttrs[h];this.isWrapped=t.isWrapped}clone(){const t=new _(0);t._data=new Uint32Array(this._data),t.length=this.length;for(const h in this._combined)t._combined[h]=this._combined[h];for(const h in this._extendedAttrs)t._extendedAttrs[h]=this._extendedAttrs[h];return t.isWrapped=this.isWrapped,t}getTrimmedLength(){for(let t=this.length-1;t>=0;--t)if(4194303&this._data[3*t+0])return t+(this._data[3*t+0]>>22);return 0}copyCellsFrom(t,h,s,r,l){const p=t._data;if(l)for(let w=r-1;w>=0;w--){for(let v=0;v<3;v++)this._data[3*(s+w)+v]=p[3*(h+w)+v];268435456&p[3*(h+w)+2]&&(this._extendedAttrs[s+w]=t._extendedAttrs[h+w])}else for(let w=0;w<r;w++){for(let v=0;v<3;v++)this._data[3*(s+w)+v]=p[3*(h+w)+v];268435456&p[3*(h+w)+2]&&(this._extendedAttrs[s+w]=t._extendedAttrs[h+w])}const g=Object.keys(t._combined);for(let w=0;w<g.length;w++){const v=parseInt(g[w],10);v>=h&&(this._combined[v-h+s]=t._combined[v])}}translateToString(t=!1,h=0,s=this.length){t&&(s=Math.min(s,this.getTrimmedLength()));let r="";for(;h<s;){const l=this._data[3*h+0],p=2097151&l;r+=2097152&l?this._combined[h]:p?(0,m.stringFromCodePoint)(p):f.WHITESPACE_CELL_CHAR,h+=l>>22||1}return r}}c.BufferLine=_},4841:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.getRangeLength=void 0,c.getRangeLength=function(S,m){if(S.start.y>S.end.y)throw new Error(`Buffer range end (${S.end.x}, ${S.end.y}) cannot be before start (${S.start.x}, ${S.start.y})`);return m*(S.end.y-S.start.y)+(S.end.x-S.start.x+1)}},4634:(q,c)=>{function S(m,f,u){if(f===m.length-1)return m[f].getTrimmedLength();const d=!m[f].hasContent(u-1)&&m[f].getWidth(u-1)===1,y=m[f+1].getWidth(0)===2;return d&&y?u-1:u}Object.defineProperty(c,"__esModule",{value:!0}),c.getWrappedLineTrimmedLength=c.reflowSmallerGetNewLineLengths=c.reflowLargerApplyNewLayout=c.reflowLargerCreateNewLayout=c.reflowLargerGetLinesToRemove=void 0,c.reflowLargerGetLinesToRemove=function(m,f,u,d,y){const _=[];for(let o=0;o<m.length-1;o++){let t=o,h=m.get(++t);if(!h.isWrapped)continue;const s=[m.get(o)];for(;t<m.length&&h.isWrapped;)s.push(h),h=m.get(++t);if(d>=o&&d<t){o+=s.length-1;continue}let r=0,l=S(s,r,f),p=1,g=0;for(;p<s.length;){const v=S(s,p,f),b=v-g,L=u-l,A=Math.min(b,L);s[r].copyCellsFrom(s[p],g,l,A,!1),l+=A,l===u&&(r++,l=0),g+=A,g===v&&(p++,g=0),l===0&&r!==0&&s[r-1].getWidth(u-1)===2&&(s[r].copyCellsFrom(s[r-1],u-1,l++,1,!1),s[r-1].setCell(u-1,y))}s[r].replaceCells(l,u,y);let w=0;for(let v=s.length-1;v>0&&(v>r||s[v].getTrimmedLength()===0);v--)w++;w>0&&(_.push(o+s.length-w),_.push(w)),o+=s.length-1}return _},c.reflowLargerCreateNewLayout=function(m,f){const u=[];let d=0,y=f[d],_=0;for(let o=0;o<m.length;o++)if(y===o){const t=f[++d];m.onDeleteEmitter.fire({index:o-_,amount:t}),o+=t-1,_+=t,y=f[++d]}else u.push(o);return{layout:u,countRemoved:_}},c.reflowLargerApplyNewLayout=function(m,f){const u=[];for(let d=0;d<f.length;d++)u.push(m.get(f[d]));for(let d=0;d<u.length;d++)m.set(d,u[d]);m.length=f.length},c.reflowSmallerGetNewLineLengths=function(m,f,u){const d=[],y=m.map((h,s)=>S(m,s,f)).reduce((h,s)=>h+s);let _=0,o=0,t=0;for(;t<y;){if(y-t<u){d.push(y-t);break}_+=u;const h=S(m,o,f);_>h&&(_-=h,o++);const s=m[o].getWidth(_-1)===2;s&&_--;const r=s?u-1:u;d.push(r),t+=r}return d},c.getWrappedLineTrimmedLength=S},5295:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferSet=void 0;const m=S(9092),f=S(8460),u=S(844);class d extends u.Disposable{constructor(_,o){super(),this._optionsService=_,this._bufferService=o,this._onBufferActivate=this.register(new f.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new m.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new m.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(_){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(_),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(_,o){this._normal.resize(_,o),this._alt.resize(_,o),this.setupTabStops(_)}setupTabStops(_){this._normal.setupTabStops(_),this._alt.setupTabStops(_)}}c.BufferSet=d},511:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CellData=void 0;const m=S(482),f=S(643),u=S(3734);class d extends u.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new u.ExtendedAttrs,this.combinedData=""}static fromCharData(_){const o=new d;return o.setFromCharData(_),o}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,m.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(_){this.fg=_[f.CHAR_DATA_ATTR_INDEX],this.bg=0;let o=!1;if(_[f.CHAR_DATA_CHAR_INDEX].length>2)o=!0;else if(_[f.CHAR_DATA_CHAR_INDEX].length===2){const t=_[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=t&&t<=56319){const h=_[f.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=h&&h<=57343?this.content=1024*(t-55296)+h-56320+65536|_[f.CHAR_DATA_WIDTH_INDEX]<<22:o=!0}else o=!0}else this.content=_[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|_[f.CHAR_DATA_WIDTH_INDEX]<<22;o&&(this.combinedData=_[f.CHAR_DATA_CHAR_INDEX],this.content=2097152|_[f.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.CellData=d},643:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.WHITESPACE_CELL_CODE=c.WHITESPACE_CELL_WIDTH=c.WHITESPACE_CELL_CHAR=c.NULL_CELL_CODE=c.NULL_CELL_WIDTH=c.NULL_CELL_CHAR=c.CHAR_DATA_CODE_INDEX=c.CHAR_DATA_WIDTH_INDEX=c.CHAR_DATA_CHAR_INDEX=c.CHAR_DATA_ATTR_INDEX=c.DEFAULT_EXT=c.DEFAULT_ATTR=c.DEFAULT_COLOR=void 0,c.DEFAULT_COLOR=0,c.DEFAULT_ATTR=256|c.DEFAULT_COLOR<<9,c.DEFAULT_EXT=0,c.CHAR_DATA_ATTR_INDEX=0,c.CHAR_DATA_CHAR_INDEX=1,c.CHAR_DATA_WIDTH_INDEX=2,c.CHAR_DATA_CODE_INDEX=3,c.NULL_CELL_CHAR="",c.NULL_CELL_WIDTH=1,c.NULL_CELL_CODE=0,c.WHITESPACE_CELL_CHAR=" ",c.WHITESPACE_CELL_WIDTH=1,c.WHITESPACE_CELL_CODE=32},4863:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Marker=void 0;const m=S(8460),f=S(844);class u{constructor(y){this.line=y,this.isDisposed=!1,this._disposables=[],this._id=u._nextId++,this._onDispose=this.register(new m.EventEmitter),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,f.disposeArray)(this._disposables),this._disposables.length=0)}register(y){return this._disposables.push(y),y}}c.Marker=u,u._nextId=1},7116:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DEFAULT_CHARSET=c.CHARSETS=void 0,c.CHARSETS={},c.DEFAULT_CHARSET=c.CHARSETS.B,c.CHARSETS[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""},c.CHARSETS.A={"#":""},c.CHARSETS.B=void 0,c.CHARSETS[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""},c.CHARSETS.C=c.CHARSETS[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},c.CHARSETS.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},c.CHARSETS.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.E=c.CHARSETS[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""},c.CHARSETS.H=c.CHARSETS[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""}},2584:(q,c)=>{var S,m;Object.defineProperty(c,"__esModule",{value:!0}),c.C1_ESCAPED=c.C1=c.C0=void 0,function(f){f.NUL="\0",f.SOH="",f.STX="",f.ETX="",f.EOT="",f.ENQ="",f.ACK="",f.BEL="\x07",f.BS="\b",f.HT="	",f.LF=`
`,f.VT="\v",f.FF="\f",f.CR="\r",f.SO="",f.SI="",f.DLE="",f.DC1="",f.DC2="",f.DC3="",f.DC4="",f.NAK="",f.SYN="",f.ETB="",f.CAN="",f.EM="",f.SUB="",f.ESC="\x1B",f.FS="",f.GS="",f.RS="",f.US="",f.SP=" ",f.DEL=""}(S=c.C0||(c.C0={})),(m=c.C1||(c.C1={})).PAD="",m.HOP="",m.BPH="",m.NBH="",m.IND="",m.NEL="",m.SSA="",m.ESA="",m.HTS="",m.HTJ="",m.VTS="",m.PLD="",m.PLU="",m.RI="",m.SS2="",m.SS3="",m.DCS="",m.PU1="",m.PU2="",m.STS="",m.CCH="",m.MW="",m.SPA="",m.EPA="",m.SOS="",m.SGCI="",m.SCI="",m.CSI="",m.ST="",m.OSC="",m.PM="",m.APC="",(c.C1_ESCAPED||(c.C1_ESCAPED={})).ST=`${S.ESC}\\`},7399:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.evaluateKeyboardEvent=void 0;const m=S(2584),f={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};c.evaluateKeyboardEvent=function(u,d,y,_){const o={type:0,cancel:!1,key:void 0},t=(u.shiftKey?1:0)|(u.altKey?2:0)|(u.ctrlKey?4:0)|(u.metaKey?8:0);switch(u.keyCode){case 0:u.key==="UIKeyInputUpArrow"?o.key=d?m.C0.ESC+"OA":m.C0.ESC+"[A":u.key==="UIKeyInputLeftArrow"?o.key=d?m.C0.ESC+"OD":m.C0.ESC+"[D":u.key==="UIKeyInputRightArrow"?o.key=d?m.C0.ESC+"OC":m.C0.ESC+"[C":u.key==="UIKeyInputDownArrow"&&(o.key=d?m.C0.ESC+"OB":m.C0.ESC+"[B");break;case 8:if(u.altKey){o.key=m.C0.ESC+m.C0.DEL;break}o.key=m.C0.DEL;break;case 9:if(u.shiftKey){o.key=m.C0.ESC+"[Z";break}o.key=m.C0.HT,o.cancel=!0;break;case 13:o.key=u.altKey?m.C0.ESC+m.C0.CR:m.C0.CR,o.cancel=!0;break;case 27:o.key=m.C0.ESC,u.altKey&&(o.key=m.C0.ESC+m.C0.ESC),o.cancel=!0;break;case 37:if(u.metaKey)break;t?(o.key=m.C0.ESC+"[1;"+(t+1)+"D",o.key===m.C0.ESC+"[1;3D"&&(o.key=m.C0.ESC+(y?"b":"[1;5D"))):o.key=d?m.C0.ESC+"OD":m.C0.ESC+"[D";break;case 39:if(u.metaKey)break;t?(o.key=m.C0.ESC+"[1;"+(t+1)+"C",o.key===m.C0.ESC+"[1;3C"&&(o.key=m.C0.ESC+(y?"f":"[1;5C"))):o.key=d?m.C0.ESC+"OC":m.C0.ESC+"[C";break;case 38:if(u.metaKey)break;t?(o.key=m.C0.ESC+"[1;"+(t+1)+"A",y||o.key!==m.C0.ESC+"[1;3A"||(o.key=m.C0.ESC+"[1;5A")):o.key=d?m.C0.ESC+"OA":m.C0.ESC+"[A";break;case 40:if(u.metaKey)break;t?(o.key=m.C0.ESC+"[1;"+(t+1)+"B",y||o.key!==m.C0.ESC+"[1;3B"||(o.key=m.C0.ESC+"[1;5B")):o.key=d?m.C0.ESC+"OB":m.C0.ESC+"[B";break;case 45:u.shiftKey||u.ctrlKey||(o.key=m.C0.ESC+"[2~");break;case 46:o.key=t?m.C0.ESC+"[3;"+(t+1)+"~":m.C0.ESC+"[3~";break;case 36:o.key=t?m.C0.ESC+"[1;"+(t+1)+"H":d?m.C0.ESC+"OH":m.C0.ESC+"[H";break;case 35:o.key=t?m.C0.ESC+"[1;"+(t+1)+"F":d?m.C0.ESC+"OF":m.C0.ESC+"[F";break;case 33:u.shiftKey?o.type=2:u.ctrlKey?o.key=m.C0.ESC+"[5;"+(t+1)+"~":o.key=m.C0.ESC+"[5~";break;case 34:u.shiftKey?o.type=3:u.ctrlKey?o.key=m.C0.ESC+"[6;"+(t+1)+"~":o.key=m.C0.ESC+"[6~";break;case 112:o.key=t?m.C0.ESC+"[1;"+(t+1)+"P":m.C0.ESC+"OP";break;case 113:o.key=t?m.C0.ESC+"[1;"+(t+1)+"Q":m.C0.ESC+"OQ";break;case 114:o.key=t?m.C0.ESC+"[1;"+(t+1)+"R":m.C0.ESC+"OR";break;case 115:o.key=t?m.C0.ESC+"[1;"+(t+1)+"S":m.C0.ESC+"OS";break;case 116:o.key=t?m.C0.ESC+"[15;"+(t+1)+"~":m.C0.ESC+"[15~";break;case 117:o.key=t?m.C0.ESC+"[17;"+(t+1)+"~":m.C0.ESC+"[17~";break;case 118:o.key=t?m.C0.ESC+"[18;"+(t+1)+"~":m.C0.ESC+"[18~";break;case 119:o.key=t?m.C0.ESC+"[19;"+(t+1)+"~":m.C0.ESC+"[19~";break;case 120:o.key=t?m.C0.ESC+"[20;"+(t+1)+"~":m.C0.ESC+"[20~";break;case 121:o.key=t?m.C0.ESC+"[21;"+(t+1)+"~":m.C0.ESC+"[21~";break;case 122:o.key=t?m.C0.ESC+"[23;"+(t+1)+"~":m.C0.ESC+"[23~";break;case 123:o.key=t?m.C0.ESC+"[24;"+(t+1)+"~":m.C0.ESC+"[24~";break;default:if(!u.ctrlKey||u.shiftKey||u.altKey||u.metaKey)if(y&&!_||!u.altKey||u.metaKey)!y||u.altKey||u.ctrlKey||u.shiftKey||!u.metaKey?u.key&&!u.ctrlKey&&!u.altKey&&!u.metaKey&&u.keyCode>=48&&u.key.length===1?o.key=u.key:u.key&&u.ctrlKey&&(u.key==="_"&&(o.key=m.C0.US),u.key==="@"&&(o.key=m.C0.NUL)):u.keyCode===65&&(o.type=1);else{const h=f[u.keyCode],s=h==null?void 0:h[u.shiftKey?1:0];if(s)o.key=m.C0.ESC+s;else if(u.keyCode>=65&&u.keyCode<=90){const r=u.ctrlKey?u.keyCode-64:u.keyCode+32;let l=String.fromCharCode(r);u.shiftKey&&(l=l.toUpperCase()),o.key=m.C0.ESC+l}else if(u.keyCode===32)o.key=m.C0.ESC+(u.ctrlKey?m.C0.NUL:" ");else if(u.key==="Dead"&&u.code.startsWith("Key")){let r=u.code.slice(3,4);u.shiftKey||(r=r.toLowerCase()),o.key=m.C0.ESC+r,o.cancel=!0}}else u.keyCode>=65&&u.keyCode<=90?o.key=String.fromCharCode(u.keyCode-64):u.keyCode===32?o.key=m.C0.NUL:u.keyCode>=51&&u.keyCode<=55?o.key=String.fromCharCode(u.keyCode-51+27):u.keyCode===56?o.key=m.C0.DEL:u.keyCode===219?o.key=m.C0.ESC:u.keyCode===220?o.key=m.C0.FS:u.keyCode===221&&(o.key=m.C0.GS)}return o}},482:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Utf8ToUtf32=c.StringToUtf32=c.utf32ToString=c.stringFromCodePoint=void 0,c.stringFromCodePoint=function(S){return S>65535?(S-=65536,String.fromCharCode(55296+(S>>10))+String.fromCharCode(S%1024+56320)):String.fromCharCode(S)},c.utf32ToString=function(S,m=0,f=S.length){let u="";for(let d=m;d<f;++d){let y=S[d];y>65535?(y-=65536,u+=String.fromCharCode(55296+(y>>10))+String.fromCharCode(y%1024+56320)):u+=String.fromCharCode(y)}return u},c.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(S,m){const f=S.length;if(!f)return 0;let u=0,d=0;if(this._interim){const y=S.charCodeAt(d++);56320<=y&&y<=57343?m[u++]=1024*(this._interim-55296)+y-56320+65536:(m[u++]=this._interim,m[u++]=y),this._interim=0}for(let y=d;y<f;++y){const _=S.charCodeAt(y);if(55296<=_&&_<=56319){if(++y>=f)return this._interim=_,u;const o=S.charCodeAt(y);56320<=o&&o<=57343?m[u++]=1024*(_-55296)+o-56320+65536:(m[u++]=_,m[u++]=o)}else _!==65279&&(m[u++]=_)}return u}},c.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(S,m){const f=S.length;if(!f)return 0;let u,d,y,_,o=0,t=0,h=0;if(this.interim[0]){let l=!1,p=this.interim[0];p&=(224&p)==192?31:(240&p)==224?15:7;let g,w=0;for(;(g=63&this.interim[++w])&&w<4;)p<<=6,p|=g;const v=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,b=v-w;for(;h<b;){if(h>=f)return 0;if(g=S[h++],(192&g)!=128){h--,l=!0;break}this.interim[w++]=g,p<<=6,p|=63&g}l||(v===2?p<128?h--:m[o++]=p:v===3?p<2048||p>=55296&&p<=57343||p===65279||(m[o++]=p):p<65536||p>1114111||(m[o++]=p)),this.interim.fill(0)}const s=f-4;let r=h;for(;r<f;){for(;!(!(r<s)||128&(u=S[r])||128&(d=S[r+1])||128&(y=S[r+2])||128&(_=S[r+3]));)m[o++]=u,m[o++]=d,m[o++]=y,m[o++]=_,r+=4;if(u=S[r++],u<128)m[o++]=u;else if((224&u)==192){if(r>=f)return this.interim[0]=u,o;if(d=S[r++],(192&d)!=128){r--;continue}if(t=(31&u)<<6|63&d,t<128){r--;continue}m[o++]=t}else if((240&u)==224){if(r>=f)return this.interim[0]=u,o;if(d=S[r++],(192&d)!=128){r--;continue}if(r>=f)return this.interim[0]=u,this.interim[1]=d,o;if(y=S[r++],(192&y)!=128){r--;continue}if(t=(15&u)<<12|(63&d)<<6|63&y,t<2048||t>=55296&&t<=57343||t===65279)continue;m[o++]=t}else if((248&u)==240){if(r>=f)return this.interim[0]=u,o;if(d=S[r++],(192&d)!=128){r--;continue}if(r>=f)return this.interim[0]=u,this.interim[1]=d,o;if(y=S[r++],(192&y)!=128){r--;continue}if(r>=f)return this.interim[0]=u,this.interim[1]=d,this.interim[2]=y,o;if(_=S[r++],(192&_)!=128){r--;continue}if(t=(7&u)<<18|(63&d)<<12|(63&y)<<6|63&_,t<65536||t>1114111)continue;m[o++]=t}}return o}}},225:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.UnicodeV6=void 0;const S=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],m=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let f;c.UnicodeV6=class{constructor(){if(this.version="6",!f){f=new Uint8Array(65536),f.fill(1),f[0]=0,f.fill(0,1,32),f.fill(0,127,160),f.fill(2,4352,4448),f[9001]=2,f[9002]=2,f.fill(2,11904,42192),f[12351]=1,f.fill(2,44032,55204),f.fill(2,63744,64256),f.fill(2,65040,65050),f.fill(2,65072,65136),f.fill(2,65280,65377),f.fill(2,65504,65511);for(let u=0;u<S.length;++u)f.fill(0,S[u][0],S[u][1]+1)}}wcwidth(u){return u<32?0:u<127?1:u<65536?f[u]:function(d,y){let _,o=0,t=y.length-1;if(d<y[0][0]||d>y[t][1])return!1;for(;t>=o;)if(_=o+t>>1,d>y[_][1])o=_+1;else{if(!(d<y[_][0]))return!0;t=_-1}return!1}(u,m)?0:u>=131072&&u<=196605||u>=196608&&u<=262141?2:1}}},5981:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.WriteBuffer=void 0;const m=S(8460),f=S(844);class u extends f.Disposable{constructor(y){super(),this._action=y,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new m.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(y,_){if(_!==void 0&&this._syncCalls>_)return void(this._syncCalls=0);if(this._pendingData+=y.length,this._writeBuffer.push(y),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let o;for(this._isSyncWriting=!0;o=this._writeBuffer.shift();){this._action(o);const t=this._callbacks.shift();t&&t()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(y,_){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=y.length,this._writeBuffer.push(y),this._callbacks.push(_),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=y.length,this._writeBuffer.push(y),this._callbacks.push(_)}_innerWrite(y=0,_=!0){const o=y||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const t=this._writeBuffer[this._bufferOffset],h=this._action(t,_);if(h){const r=l=>Date.now()-o>=12?setTimeout(()=>this._innerWrite(0,l)):this._innerWrite(o,l);return void h.catch(l=>(queueMicrotask(()=>{throw l}),Promise.resolve(!1))).then(r)}const s=this._callbacks[this._bufferOffset];if(s&&s(),this._bufferOffset++,this._pendingData-=t.length,Date.now()-o>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}c.WriteBuffer=u},5941:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.toRgbString=c.parseColor=void 0;const S=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,m=/^[\da-f]+$/;function f(u,d){const y=u.toString(16),_=y.length<2?"0"+y:y;switch(d){case 4:return y[0];case 8:return _;case 12:return(_+_).slice(0,3);default:return _+_}}c.parseColor=function(u){if(!u)return;let d=u.toLowerCase();if(d.indexOf("rgb:")===0){d=d.slice(4);const y=S.exec(d);if(y){const _=y[1]?15:y[4]?255:y[7]?4095:65535;return[Math.round(parseInt(y[1]||y[4]||y[7]||y[10],16)/_*255),Math.round(parseInt(y[2]||y[5]||y[8]||y[11],16)/_*255),Math.round(parseInt(y[3]||y[6]||y[9]||y[12],16)/_*255)]}}else if(d.indexOf("#")===0&&(d=d.slice(1),m.exec(d)&&[3,6,9,12].includes(d.length))){const y=d.length/3,_=[0,0,0];for(let o=0;o<3;++o){const t=parseInt(d.slice(y*o,y*o+y),16);_[o]=y===1?t<<4:y===2?t:y===3?t>>4:t>>8}return _}},c.toRgbString=function(u,d=16){const[y,_,o]=u;return`rgb:${f(y,d)}/${f(_,d)}/${f(o,d)}`}},5770:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PAYLOAD_LIMIT=void 0,c.PAYLOAD_LIMIT=1e7},6351:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DcsHandler=c.DcsParser=void 0;const m=S(482),f=S(8742),u=S(5770),d=[];c.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=d,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=d}registerHandler(_,o){this._handlers[_]===void 0&&(this._handlers[_]=[]);const t=this._handlers[_];return t.push(o),{dispose:()=>{const h=t.indexOf(o);h!==-1&&t.splice(h,1)}}}clearHandler(_){this._handlers[_]&&delete this._handlers[_]}setHandlerFallback(_){this._handlerFb=_}reset(){if(this._active.length)for(let _=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;_>=0;--_)this._active[_].unhook(!1);this._stack.paused=!1,this._active=d,this._ident=0}hook(_,o){if(this.reset(),this._ident=_,this._active=this._handlers[_]||d,this._active.length)for(let t=this._active.length-1;t>=0;t--)this._active[t].hook(o);else this._handlerFb(this._ident,"HOOK",o)}put(_,o,t){if(this._active.length)for(let h=this._active.length-1;h>=0;h--)this._active[h].put(_,o,t);else this._handlerFb(this._ident,"PUT",(0,m.utf32ToString)(_,o,t))}unhook(_,o=!0){if(this._active.length){let t=!1,h=this._active.length-1,s=!1;if(this._stack.paused&&(h=this._stack.loopPosition-1,t=o,s=this._stack.fallThrough,this._stack.paused=!1),!s&&t===!1){for(;h>=0&&(t=this._active[h].unhook(_),t!==!0);h--)if(t instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=h,this._stack.fallThrough=!1,t;h--}for(;h>=0;h--)if(t=this._active[h].unhook(!1),t instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=h,this._stack.fallThrough=!0,t}else this._handlerFb(this._ident,"UNHOOK",_);this._active=d,this._ident=0}};const y=new f.Params;y.addParam(0),c.DcsHandler=class{constructor(_){this._handler=_,this._data="",this._params=y,this._hitLimit=!1}hook(_){this._params=_.length>1||_.params[0]?_.clone():y,this._data="",this._hitLimit=!1}put(_,o,t){this._hitLimit||(this._data+=(0,m.utf32ToString)(_,o,t),this._data.length>u.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(_){let o=!1;if(this._hitLimit)o=!1;else if(_&&(o=this._handler(this._data,this._params),o instanceof Promise))return o.then(t=>(this._params=y,this._data="",this._hitLimit=!1,t));return this._params=y,this._data="",this._hitLimit=!1,o}}},2015:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.EscapeSequenceParser=c.VT500_TRANSITION_TABLE=c.TransitionTable=void 0;const m=S(844),f=S(8742),u=S(6242),d=S(6351);class y{constructor(h){this.table=new Uint8Array(h)}setDefault(h,s){this.table.fill(h<<4|s)}add(h,s,r,l){this.table[s<<8|h]=r<<4|l}addMany(h,s,r,l){for(let p=0;p<h.length;p++)this.table[s<<8|h[p]]=r<<4|l}}c.TransitionTable=y;const _=160;c.VT500_TRANSITION_TABLE=function(){const t=new y(4095),h=Array.apply(null,Array(256)).map((w,v)=>v),s=(w,v)=>h.slice(w,v),r=s(32,127),l=s(0,24);l.push(25),l.push.apply(l,s(28,32));const p=s(0,14);let g;for(g in t.setDefault(1,0),t.addMany(r,0,2,0),p)t.addMany([24,26,153,154],g,3,0),t.addMany(s(128,144),g,3,0),t.addMany(s(144,152),g,3,0),t.add(156,g,0,0),t.add(27,g,11,1),t.add(157,g,4,8),t.addMany([152,158,159],g,0,7),t.add(155,g,11,3),t.add(144,g,11,9);return t.addMany(l,0,3,0),t.addMany(l,1,3,1),t.add(127,1,0,1),t.addMany(l,8,0,8),t.addMany(l,3,3,3),t.add(127,3,0,3),t.addMany(l,4,3,4),t.add(127,4,0,4),t.addMany(l,6,3,6),t.addMany(l,5,3,5),t.add(127,5,0,5),t.addMany(l,2,3,2),t.add(127,2,0,2),t.add(93,1,4,8),t.addMany(r,8,5,8),t.add(127,8,5,8),t.addMany([156,27,24,26,7],8,6,0),t.addMany(s(28,32),8,0,8),t.addMany([88,94,95],1,0,7),t.addMany(r,7,0,7),t.addMany(l,7,0,7),t.add(156,7,0,0),t.add(127,7,0,7),t.add(91,1,11,3),t.addMany(s(64,127),3,7,0),t.addMany(s(48,60),3,8,4),t.addMany([60,61,62,63],3,9,4),t.addMany(s(48,60),4,8,4),t.addMany(s(64,127),4,7,0),t.addMany([60,61,62,63],4,0,6),t.addMany(s(32,64),6,0,6),t.add(127,6,0,6),t.addMany(s(64,127),6,0,0),t.addMany(s(32,48),3,9,5),t.addMany(s(32,48),5,9,5),t.addMany(s(48,64),5,0,6),t.addMany(s(64,127),5,7,0),t.addMany(s(32,48),4,9,5),t.addMany(s(32,48),1,9,2),t.addMany(s(32,48),2,9,2),t.addMany(s(48,127),2,10,0),t.addMany(s(48,80),1,10,0),t.addMany(s(81,88),1,10,0),t.addMany([89,90,92],1,10,0),t.addMany(s(96,127),1,10,0),t.add(80,1,11,9),t.addMany(l,9,0,9),t.add(127,9,0,9),t.addMany(s(28,32),9,0,9),t.addMany(s(32,48),9,9,12),t.addMany(s(48,60),9,8,10),t.addMany([60,61,62,63],9,9,10),t.addMany(l,11,0,11),t.addMany(s(32,128),11,0,11),t.addMany(s(28,32),11,0,11),t.addMany(l,10,0,10),t.add(127,10,0,10),t.addMany(s(28,32),10,0,10),t.addMany(s(48,60),10,8,10),t.addMany([60,61,62,63],10,0,11),t.addMany(s(32,48),10,9,12),t.addMany(l,12,0,12),t.add(127,12,0,12),t.addMany(s(28,32),12,0,12),t.addMany(s(32,48),12,9,12),t.addMany(s(48,64),12,0,11),t.addMany(s(64,127),12,12,13),t.addMany(s(64,127),10,12,13),t.addMany(s(64,127),9,12,13),t.addMany(l,13,13,13),t.addMany(r,13,13,13),t.add(127,13,0,13),t.addMany([27,156,24,26],13,14,0),t.add(_,0,2,0),t.add(_,8,5,8),t.add(_,6,0,6),t.add(_,11,0,11),t.add(_,13,13,13),t}();class o extends m.Disposable{constructor(h=c.VT500_TRANSITION_TABLE){super(),this._transitions=h,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new f.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(s,r,l)=>{},this._executeHandlerFb=s=>{},this._csiHandlerFb=(s,r)=>{},this._escHandlerFb=s=>{},this._errorHandlerFb=s=>s,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,m.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new u.OscParser),this._dcsParser=this.register(new d.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(h,s=[64,126]){let r=0;if(h.prefix){if(h.prefix.length>1)throw new Error("only one byte as prefix supported");if(r=h.prefix.charCodeAt(0),r&&60>r||r>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(h.intermediates){if(h.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let p=0;p<h.intermediates.length;++p){const g=h.intermediates.charCodeAt(p);if(32>g||g>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");r<<=8,r|=g}}if(h.final.length!==1)throw new Error("final must be a single byte");const l=h.final.charCodeAt(0);if(s[0]>l||l>s[1])throw new Error(`final must be in range ${s[0]} .. ${s[1]}`);return r<<=8,r|=l,r}identToString(h){const s=[];for(;h;)s.push(String.fromCharCode(255&h)),h>>=8;return s.reverse().join("")}setPrintHandler(h){this._printHandler=h}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(h,s){const r=this._identifier(h,[48,126]);this._escHandlers[r]===void 0&&(this._escHandlers[r]=[]);const l=this._escHandlers[r];return l.push(s),{dispose:()=>{const p=l.indexOf(s);p!==-1&&l.splice(p,1)}}}clearEscHandler(h){this._escHandlers[this._identifier(h,[48,126])]&&delete this._escHandlers[this._identifier(h,[48,126])]}setEscHandlerFallback(h){this._escHandlerFb=h}setExecuteHandler(h,s){this._executeHandlers[h.charCodeAt(0)]=s}clearExecuteHandler(h){this._executeHandlers[h.charCodeAt(0)]&&delete this._executeHandlers[h.charCodeAt(0)]}setExecuteHandlerFallback(h){this._executeHandlerFb=h}registerCsiHandler(h,s){const r=this._identifier(h);this._csiHandlers[r]===void 0&&(this._csiHandlers[r]=[]);const l=this._csiHandlers[r];return l.push(s),{dispose:()=>{const p=l.indexOf(s);p!==-1&&l.splice(p,1)}}}clearCsiHandler(h){this._csiHandlers[this._identifier(h)]&&delete this._csiHandlers[this._identifier(h)]}setCsiHandlerFallback(h){this._csiHandlerFb=h}registerDcsHandler(h,s){return this._dcsParser.registerHandler(this._identifier(h),s)}clearDcsHandler(h){this._dcsParser.clearHandler(this._identifier(h))}setDcsHandlerFallback(h){this._dcsParser.setHandlerFallback(h)}registerOscHandler(h,s){return this._oscParser.registerHandler(h,s)}clearOscHandler(h){this._oscParser.clearHandler(h)}setOscHandlerFallback(h){this._oscParser.setHandlerFallback(h)}setErrorHandler(h){this._errorHandler=h}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(h,s,r,l,p){this._parseStack.state=h,this._parseStack.handlers=s,this._parseStack.handlerPos=r,this._parseStack.transition=l,this._parseStack.chunkPos=p}parse(h,s,r){let l,p=0,g=0,w=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,w=this._parseStack.chunkPos+1;else{if(r===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const v=this._parseStack.handlers;let b=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(r===!1&&b>-1){for(;b>=0&&(l=v[b](this._params),l!==!0);b--)if(l instanceof Promise)return this._parseStack.handlerPos=b,l}this._parseStack.handlers=[];break;case 4:if(r===!1&&b>-1){for(;b>=0&&(l=v[b](),l!==!0);b--)if(l instanceof Promise)return this._parseStack.handlerPos=b,l}this._parseStack.handlers=[];break;case 6:if(p=h[this._parseStack.chunkPos],l=this._dcsParser.unhook(p!==24&&p!==26,r),l)return l;p===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(p=h[this._parseStack.chunkPos],l=this._oscParser.end(p!==24&&p!==26,r),l)return l;p===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,w=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let v=w;v<s;++v){switch(p=h[v],g=this._transitions.table[this.currentState<<8|(p<160?p:_)],g>>4){case 2:for(let B=v+1;;++B){if(B>=s||(p=h[B])<32||p>126&&p<_){this._printHandler(h,v,B),v=B-1;break}if(++B>=s||(p=h[B])<32||p>126&&p<_){this._printHandler(h,v,B),v=B-1;break}if(++B>=s||(p=h[B])<32||p>126&&p<_){this._printHandler(h,v,B),v=B-1;break}if(++B>=s||(p=h[B])<32||p>126&&p<_){this._printHandler(h,v,B),v=B-1;break}}break;case 3:this._executeHandlers[p]?this._executeHandlers[p]():this._executeHandlerFb(p),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:v,code:p,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const b=this._csiHandlers[this._collect<<8|p];let L=b?b.length-1:-1;for(;L>=0&&(l=b[L](this._params),l!==!0);L--)if(l instanceof Promise)return this._preserveStack(3,b,L,g,v),l;L<0&&this._csiHandlerFb(this._collect<<8|p,this._params),this.precedingCodepoint=0;break;case 8:do switch(p){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(p-48)}while(++v<s&&(p=h[v])>47&&p<60);v--;break;case 9:this._collect<<=8,this._collect|=p;break;case 10:const A=this._escHandlers[this._collect<<8|p];let T=A?A.length-1:-1;for(;T>=0&&(l=A[T](),l!==!0);T--)if(l instanceof Promise)return this._preserveStack(4,A,T,g,v),l;T<0&&this._escHandlerFb(this._collect<<8|p),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|p,this._params);break;case 13:for(let B=v+1;;++B)if(B>=s||(p=h[B])===24||p===26||p===27||p>127&&p<_){this._dcsParser.put(h,v,B),v=B-1;break}break;case 14:if(l=this._dcsParser.unhook(p!==24&&p!==26),l)return this._preserveStack(6,[],0,g,v),l;p===27&&(g|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let B=v+1;;B++)if(B>=s||(p=h[B])<32||p>127&&p<_){this._oscParser.put(h,v,B),v=B-1;break}break;case 6:if(l=this._oscParser.end(p!==24&&p!==26),l)return this._preserveStack(5,[],0,g,v),l;p===27&&(g|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&g}}}c.EscapeSequenceParser=o},6242:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.OscHandler=c.OscParser=void 0;const m=S(5770),f=S(482),u=[];c.OscParser=class{constructor(){this._state=0,this._active=u,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(d,y){this._handlers[d]===void 0&&(this._handlers[d]=[]);const _=this._handlers[d];return _.push(y),{dispose:()=>{const o=_.indexOf(y);o!==-1&&_.splice(o,1)}}}clearHandler(d){this._handlers[d]&&delete this._handlers[d]}setHandlerFallback(d){this._handlerFb=d}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=u}reset(){if(this._state===2)for(let d=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;d>=0;--d)this._active[d].end(!1);this._stack.paused=!1,this._active=u,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||u,this._active.length)for(let d=this._active.length-1;d>=0;d--)this._active[d].start();else this._handlerFb(this._id,"START")}_put(d,y,_){if(this._active.length)for(let o=this._active.length-1;o>=0;o--)this._active[o].put(d,y,_);else this._handlerFb(this._id,"PUT",(0,f.utf32ToString)(d,y,_))}start(){this.reset(),this._state=1}put(d,y,_){if(this._state!==3){if(this._state===1)for(;y<_;){const o=d[y++];if(o===59){this._state=2,this._start();break}if(o<48||57<o)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+o-48}this._state===2&&_-y>0&&this._put(d,y,_)}}end(d,y=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let _=!1,o=this._active.length-1,t=!1;if(this._stack.paused&&(o=this._stack.loopPosition-1,_=y,t=this._stack.fallThrough,this._stack.paused=!1),!t&&_===!1){for(;o>=0&&(_=this._active[o].end(d),_!==!0);o--)if(_ instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!1,_;o--}for(;o>=0;o--)if(_=this._active[o].end(!1),_ instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!0,_}else this._handlerFb(this._id,"END",d);this._active=u,this._id=-1,this._state=0}}},c.OscHandler=class{constructor(d){this._handler=d,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(d,y,_){this._hitLimit||(this._data+=(0,f.utf32ToString)(d,y,_),this._data.length>m.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(d){let y=!1;if(this._hitLimit)y=!1;else if(d&&(y=this._handler(this._data),y instanceof Promise))return y.then(_=>(this._data="",this._hitLimit=!1,_));return this._data="",this._hitLimit=!1,y}}},8742:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Params=void 0;const S=2147483647;class m{constructor(u=32,d=32){if(this.maxLength=u,this.maxSubParamsLength=d,d>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(u),this.length=0,this._subParams=new Int32Array(d),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(u),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(u){const d=new m;if(!u.length)return d;for(let y=Array.isArray(u[0])?1:0;y<u.length;++y){const _=u[y];if(Array.isArray(_))for(let o=0;o<_.length;++o)d.addSubParam(_[o]);else d.addParam(_)}return d}clone(){const u=new m(this.maxLength,this.maxSubParamsLength);return u.params.set(this.params),u.length=this.length,u._subParams.set(this._subParams),u._subParamsLength=this._subParamsLength,u._subParamsIdx.set(this._subParamsIdx),u._rejectDigits=this._rejectDigits,u._rejectSubDigits=this._rejectSubDigits,u._digitIsSub=this._digitIsSub,u}toArray(){const u=[];for(let d=0;d<this.length;++d){u.push(this.params[d]);const y=this._subParamsIdx[d]>>8,_=255&this._subParamsIdx[d];_-y>0&&u.push(Array.prototype.slice.call(this._subParams,y,_))}return u}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(u){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(u<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=u>S?S:u}}addSubParam(u){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(u<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=u>S?S:u,this._subParamsIdx[this.length-1]++}}hasSubParams(u){return(255&this._subParamsIdx[u])-(this._subParamsIdx[u]>>8)>0}getSubParams(u){const d=this._subParamsIdx[u]>>8,y=255&this._subParamsIdx[u];return y-d>0?this._subParams.subarray(d,y):null}getSubParamsAll(){const u={};for(let d=0;d<this.length;++d){const y=this._subParamsIdx[d]>>8,_=255&this._subParamsIdx[d];_-y>0&&(u[d]=this._subParams.slice(y,_))}return u}addDigit(u){let d;if(this._rejectDigits||!(d=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const y=this._digitIsSub?this._subParams:this.params,_=y[d-1];y[d-1]=~_?Math.min(10*_+u,S):u}}c.Params=m},5741:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.AddonManager=void 0,c.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let S=this._addons.length-1;S>=0;S--)this._addons[S].instance.dispose()}loadAddon(S,m){const f={instance:m,dispose:m.dispose,isDisposed:!1};this._addons.push(f),m.dispose=()=>this._wrappedAddonDispose(f),m.activate(S)}_wrappedAddonDispose(S){if(S.isDisposed)return;let m=-1;for(let f=0;f<this._addons.length;f++)if(this._addons[f]===S){m=f;break}if(m===-1)throw new Error("Could not dispose an addon that has not been loaded");S.isDisposed=!0,S.dispose.apply(S.instance),this._addons.splice(m,1)}}},8771:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferApiView=void 0;const m=S(3785),f=S(511);c.BufferApiView=class{constructor(u,d){this._buffer=u,this.type=d}init(u){return this._buffer=u,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(u){const d=this._buffer.lines.get(u);if(d)return new m.BufferLineApiView(d)}getNullCell(){return new f.CellData}}},3785:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferLineApiView=void 0;const m=S(511);c.BufferLineApiView=class{constructor(f){this._line=f}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(f,u){if(!(f<0||f>=this._line.length))return u?(this._line.loadCell(f,u),u):this._line.loadCell(f,new m.CellData)}translateToString(f,u,d){return this._line.translateToString(f,u,d)}}},8285:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferNamespaceApi=void 0;const m=S(8771),f=S(8460);c.BufferNamespaceApi=class{constructor(u){this._core=u,this._onBufferChange=new f.EventEmitter,this.onBufferChange=this._onBufferChange.event,this._normal=new m.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new m.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}},7975:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ParserApi=void 0,c.ParserApi=class{constructor(S){this._core=S}registerCsiHandler(S,m){return this._core.registerCsiHandler(S,f=>m(f.toArray()))}addCsiHandler(S,m){return this.registerCsiHandler(S,m)}registerDcsHandler(S,m){return this._core.registerDcsHandler(S,(f,u)=>m(f,u.toArray()))}addDcsHandler(S,m){return this.registerDcsHandler(S,m)}registerEscHandler(S,m){return this._core.registerEscHandler(S,m)}addEscHandler(S,m){return this.registerEscHandler(S,m)}registerOscHandler(S,m){return this._core.registerOscHandler(S,m)}addOscHandler(S,m){return this.registerOscHandler(S,m)}}},7090:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.UnicodeApi=void 0,c.UnicodeApi=class{constructor(S){this._core=S}register(S){this._core.unicodeService.register(S)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(S){this._core.unicodeService.activeVersion=S}}},744:function(q,c,S){var m=this&&this.__decorate||function(t,h,s,r){var l,p=arguments.length,g=p<3?h:r===null?r=Object.getOwnPropertyDescriptor(h,s):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(t,h,s,r);else for(var w=t.length-1;w>=0;w--)(l=t[w])&&(g=(p<3?l(g):p>3?l(h,s,g):l(h,s))||g);return p>3&&g&&Object.defineProperty(h,s,g),g},f=this&&this.__param||function(t,h){return function(s,r){h(s,r,t)}};Object.defineProperty(c,"__esModule",{value:!0}),c.BufferService=c.MINIMUM_ROWS=c.MINIMUM_COLS=void 0;const u=S(2585),d=S(5295),y=S(8460),_=S(844);c.MINIMUM_COLS=2,c.MINIMUM_ROWS=1;let o=class extends _.Disposable{constructor(t){super(),this.isUserScrolling=!1,this._onResize=this.register(new y.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new y.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(t.rawOptions.cols||0,c.MINIMUM_COLS),this.rows=Math.max(t.rawOptions.rows||0,c.MINIMUM_ROWS),this.buffers=this.register(new d.BufferSet(t,this))}get buffer(){return this.buffers.active}resize(t,h){this.cols=t,this.rows=h,this.buffers.resize(t,h),this._onResize.fire({cols:t,rows:h})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(t,h=!1){const s=this.buffer;let r;r=this._cachedBlankLine,r&&r.length===this.cols&&r.getFg(0)===t.fg&&r.getBg(0)===t.bg||(r=s.getBlankLine(t,h),this._cachedBlankLine=r),r.isWrapped=h;const l=s.ybase+s.scrollTop,p=s.ybase+s.scrollBottom;if(s.scrollTop===0){const g=s.lines.isFull;p===s.lines.length-1?g?s.lines.recycle().copyFrom(r):s.lines.push(r.clone()):s.lines.splice(p+1,0,r.clone()),g?this.isUserScrolling&&(s.ydisp=Math.max(s.ydisp-1,0)):(s.ybase++,this.isUserScrolling||s.ydisp++)}else{const g=p-l+1;s.lines.shiftElements(l+1,g-1,-1),s.lines.set(p,r.clone())}this.isUserScrolling||(s.ydisp=s.ybase),this._onScroll.fire(s.ydisp)}scrollLines(t,h,s){const r=this.buffer;if(t<0){if(r.ydisp===0)return;this.isUserScrolling=!0}else t+r.ydisp>=r.ybase&&(this.isUserScrolling=!1);const l=r.ydisp;r.ydisp=Math.max(Math.min(r.ydisp+t,r.ybase),0),l!==r.ydisp&&(h||this._onScroll.fire(r.ydisp))}scrollPages(t){this.scrollLines(t*(this.rows-1))}scrollToTop(){this.scrollLines(-this.buffer.ydisp)}scrollToBottom(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)}scrollToLine(t){const h=t-this.buffer.ydisp;h!==0&&this.scrollLines(h)}};o=m([f(0,u.IOptionsService)],o),c.BufferService=o},7994:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CharsetService=void 0,c.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(S){this.glevel=S,this.charset=this._charsets[S]}setgCharset(S,m){this._charsets[S]=m,this.glevel===S&&(this.charset=m)}}},1753:function(q,c,S){var m=this&&this.__decorate||function(r,l,p,g){var w,v=arguments.length,b=v<3?l:g===null?g=Object.getOwnPropertyDescriptor(l,p):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(r,l,p,g);else for(var L=r.length-1;L>=0;L--)(w=r[L])&&(b=(v<3?w(b):v>3?w(l,p,b):w(l,p))||b);return v>3&&b&&Object.defineProperty(l,p,b),b},f=this&&this.__param||function(r,l){return function(p,g){l(p,g,r)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CoreMouseService=void 0;const u=S(2585),d=S(8460),y=S(844),_={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:r=>r.button!==4&&r.action===1&&(r.ctrl=!1,r.alt=!1,r.shift=!1,!0)},VT200:{events:19,restrict:r=>r.action!==32},DRAG:{events:23,restrict:r=>r.action!==32||r.button!==3},ANY:{events:31,restrict:r=>!0}};function o(r,l){let p=(r.ctrl?16:0)|(r.shift?4:0)|(r.alt?8:0);return r.button===4?(p|=64,p|=r.action):(p|=3&r.button,4&r.button&&(p|=64),8&r.button&&(p|=128),r.action===32?p|=32:r.action!==0||l||(p|=3)),p}const t=String.fromCharCode,h={DEFAULT:r=>{const l=[o(r,!1)+32,r.col+32,r.row+32];return l[0]>255||l[1]>255||l[2]>255?"":`\x1B[M${t(l[0])}${t(l[1])}${t(l[2])}`},SGR:r=>{const l=r.action===0&&r.button!==4?"m":"M";return`\x1B[<${o(r,!0)};${r.col};${r.row}${l}`},SGR_PIXELS:r=>{const l=r.action===0&&r.button!==4?"m":"M";return`\x1B[<${o(r,!0)};${r.x};${r.y}${l}`}};let s=class extends y.Disposable{constructor(r,l){super(),this._bufferService=r,this._coreService=l,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new d.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const p of Object.keys(_))this.addProtocol(p,_[p]);for(const p of Object.keys(h))this.addEncoding(p,h[p]);this.reset()}addProtocol(r,l){this._protocols[r]=l}addEncoding(r,l){this._encodings[r]=l}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(r){if(!this._protocols[r])throw new Error(`unknown protocol "${r}"`);this._activeProtocol=r,this._onProtocolChange.fire(this._protocols[r].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(r){if(!this._encodings[r])throw new Error(`unknown encoding "${r}"`);this._activeEncoding=r}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(r){if(r.col<0||r.col>=this._bufferService.cols||r.row<0||r.row>=this._bufferService.rows||r.button===4&&r.action===32||r.button===3&&r.action!==32||r.button!==4&&(r.action===2||r.action===3)||(r.col++,r.row++,r.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,r,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(r))return!1;const l=this._encodings[this._activeEncoding](r);return l&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(l):this._coreService.triggerDataEvent(l,!0)),this._lastEvent=r,!0}explainEvents(r){return{down:!!(1&r),up:!!(2&r),drag:!!(4&r),move:!!(8&r),wheel:!!(16&r)}}_equalEvents(r,l,p){if(p){if(r.x!==l.x||r.y!==l.y)return!1}else if(r.col!==l.col||r.row!==l.row)return!1;return r.button===l.button&&r.action===l.action&&r.ctrl===l.ctrl&&r.alt===l.alt&&r.shift===l.shift}};s=m([f(0,u.IBufferService),f(1,u.ICoreService)],s),c.CoreMouseService=s},6975:function(q,c,S){var m=this&&this.__decorate||function(s,r,l,p){var g,w=arguments.length,v=w<3?r:p===null?p=Object.getOwnPropertyDescriptor(r,l):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(s,r,l,p);else for(var b=s.length-1;b>=0;b--)(g=s[b])&&(v=(w<3?g(v):w>3?g(r,l,v):g(r,l))||v);return w>3&&v&&Object.defineProperty(r,l,v),v},f=this&&this.__param||function(s,r){return function(l,p){r(l,p,s)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CoreService=void 0;const u=S(2585),d=S(8460),y=S(1439),_=S(844),o=Object.freeze({insertMode:!1}),t=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let h=class extends _.Disposable{constructor(s,r,l){super(),this._bufferService=s,this._logService=r,this._optionsService=l,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new d.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new d.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new d.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new d.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,y.clone)(o),this.decPrivateModes=(0,y.clone)(t)}reset(){this.modes=(0,y.clone)(o),this.decPrivateModes=(0,y.clone)(t)}triggerDataEvent(s,r=!1){if(this._optionsService.rawOptions.disableStdin)return;const l=this._bufferService.buffer;r&&this._optionsService.rawOptions.scrollOnUserInput&&l.ybase!==l.ydisp&&this._onRequestScrollToBottom.fire(),r&&this._onUserInput.fire(),this._logService.debug(`sending data "${s}"`,()=>s.split("").map(p=>p.charCodeAt(0))),this._onData.fire(s)}triggerBinaryEvent(s){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${s}"`,()=>s.split("").map(r=>r.charCodeAt(0))),this._onBinary.fire(s))}};h=m([f(0,u.IBufferService),f(1,u.ILogService),f(2,u.IOptionsService)],h),c.CoreService=h},9074:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DecorationService=void 0;const m=S(8055),f=S(8460),u=S(844),d=S(6106);let y=0,_=0;class o extends u.Disposable{constructor(){super(),this._decorations=new d.SortedList(s=>s==null?void 0:s.marker.line),this._onDecorationRegistered=this.register(new f.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new f.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,u.toDisposable)(()=>{for(const s of this._decorations.values())this._onDecorationRemoved.fire(s);this.reset()}))}get decorations(){return this._decorations.values()}registerDecoration(s){if(s.marker.isDisposed)return;const r=new t(s);if(r){const l=r.marker.onDispose(()=>r.dispose());r.onDispose(()=>{r&&(this._decorations.delete(r)&&this._onDecorationRemoved.fire(r),l.dispose())}),this._decorations.insert(r),this._onDecorationRegistered.fire(r)}return r}reset(){for(const s of this._decorations.values())s.dispose();this._decorations.clear()}*getDecorationsAtCell(s,r,l){var p,g,w;let v=0,b=0;for(const L of this._decorations.getKeyIterator(r))v=(p=L.options.x)!==null&&p!==void 0?p:0,b=v+((g=L.options.width)!==null&&g!==void 0?g:1),s>=v&&s<b&&(!l||((w=L.options.layer)!==null&&w!==void 0?w:"bottom")===l)&&(yield L)}forEachDecorationAtCell(s,r,l,p){this._decorations.forEachByKey(r,g=>{var w,v,b;y=(w=g.options.x)!==null&&w!==void 0?w:0,_=y+((v=g.options.width)!==null&&v!==void 0?v:1),s>=y&&s<_&&(!l||((b=g.options.layer)!==null&&b!==void 0?b:"bottom")===l)&&p(g)})}dispose(){for(const s of this._decorations.values())this._onDecorationRemoved.fire(s);this.reset()}}c.DecorationService=o;class t extends u.Disposable{constructor(s){super(),this.options=s,this.onRenderEmitter=this.register(new f.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new f.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=s.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=m.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=m.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.InstantiationService=c.ServiceCollection=void 0;const m=S(2585),f=S(8343);class u{constructor(...y){this._entries=new Map;for(const[_,o]of y)this.set(_,o)}set(y,_){const o=this._entries.get(y);return this._entries.set(y,_),o}forEach(y){for(const[_,o]of this._entries.entries())y(_,o)}has(y){return this._entries.has(y)}get(y){return this._entries.get(y)}}c.ServiceCollection=u,c.InstantiationService=class{constructor(){this._services=new u,this._services.set(m.IInstantiationService,this)}setService(d,y){this._services.set(d,y)}getService(d){return this._services.get(d)}createInstance(d,...y){const _=(0,f.getServiceDependencies)(d).sort((h,s)=>h.index-s.index),o=[];for(const h of _){const s=this._services.get(h.id);if(!s)throw new Error(`[createInstance] ${d.name} depends on UNKNOWN service ${h.id}.`);o.push(s)}const t=_.length>0?_[0].index:y.length;if(y.length!==t)throw new Error(`[createInstance] First service dependency of ${d.name} at position ${t+1} conflicts with ${y.length} static arguments`);return new d(...y,...o)}}},7866:function(q,c,S){var m=this&&this.__decorate||function(o,t,h,s){var r,l=arguments.length,p=l<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,h):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(o,t,h,s);else for(var g=o.length-1;g>=0;g--)(r=o[g])&&(p=(l<3?r(p):l>3?r(t,h,p):r(t,h))||p);return l>3&&p&&Object.defineProperty(t,h,p),p},f=this&&this.__param||function(o,t){return function(h,s){t(h,s,o)}};Object.defineProperty(c,"__esModule",{value:!0}),c.LogService=void 0;const u=S(844),d=S(2585),y={debug:d.LogLevelEnum.DEBUG,info:d.LogLevelEnum.INFO,warn:d.LogLevelEnum.WARN,error:d.LogLevelEnum.ERROR,off:d.LogLevelEnum.OFF};let _=class extends u.Disposable{constructor(o){super(),this._optionsService=o,this.logLevel=d.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}_updateLogLevel(){this.logLevel=y[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(o){for(let t=0;t<o.length;t++)typeof o[t]=="function"&&(o[t]=o[t]())}_log(o,t,h){this._evalLazyOptionalParams(h),o.call(console,"xterm.js: "+t,...h)}debug(o,...t){this.logLevel<=d.LogLevelEnum.DEBUG&&this._log(console.log,o,t)}info(o,...t){this.logLevel<=d.LogLevelEnum.INFO&&this._log(console.info,o,t)}warn(o,...t){this.logLevel<=d.LogLevelEnum.WARN&&this._log(console.warn,o,t)}error(o,...t){this.logLevel<=d.LogLevelEnum.ERROR&&this._log(console.error,o,t)}};_=m([f(0,d.IOptionsService)],_),c.LogService=_},7302:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.OptionsService=c.DEFAULT_OPTIONS=void 0;const m=S(8460),f=S(6114),u=S(844);c.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:f.isMac,windowOptions:{},windowsMode:!1,wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const d=["normal","bold","100","200","300","400","500","600","700","800","900"];class y extends u.Disposable{constructor(o){super(),this._onOptionChange=this.register(new m.EventEmitter),this.onOptionChange=this._onOptionChange.event;const t=Object.assign({},c.DEFAULT_OPTIONS);for(const h in o)if(h in t)try{const s=o[h];t[h]=this._sanitizeAndValidateOption(h,s)}catch(s){console.error(s)}this.rawOptions=t,this.options=Object.assign({},t),this._setupOptions()}onSpecificOptionChange(o,t){return this.onOptionChange(h=>{h===o&&t(this.rawOptions[o])})}onMultipleOptionChange(o,t){return this.onOptionChange(h=>{o.indexOf(h)!==-1&&t()})}_setupOptions(){const o=h=>{if(!(h in c.DEFAULT_OPTIONS))throw new Error(`No option with key "${h}"`);return this.rawOptions[h]},t=(h,s)=>{if(!(h in c.DEFAULT_OPTIONS))throw new Error(`No option with key "${h}"`);s=this._sanitizeAndValidateOption(h,s),this.rawOptions[h]!==s&&(this.rawOptions[h]=s,this._onOptionChange.fire(h))};for(const h in this.rawOptions){const s={get:o.bind(this,h),set:t.bind(this,h)};Object.defineProperty(this.options,h,s)}}_sanitizeAndValidateOption(o,t){switch(o){case"cursorStyle":if(t||(t=c.DEFAULT_OPTIONS[o]),!function(h){return h==="block"||h==="underline"||h==="bar"}(t))throw new Error(`"${t}" is not a valid value for ${o}`);break;case"wordSeparator":t||(t=c.DEFAULT_OPTIONS[o]);break;case"fontWeight":case"fontWeightBold":if(typeof t=="number"&&1<=t&&t<=1e3)break;t=d.includes(t)?t:c.DEFAULT_OPTIONS[o];break;case"cursorWidth":t=Math.floor(t);case"lineHeight":case"tabStopWidth":if(t<1)throw new Error(`${o} cannot be less than 1, value: ${t}`);break;case"minimumContrastRatio":t=Math.max(1,Math.min(21,Math.round(10*t)/10));break;case"scrollback":if((t=Math.min(t,4294967295))<0)throw new Error(`${o} cannot be less than 0, value: ${t}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(t<=0)throw new Error(`${o} cannot be less than or equal to 0, value: ${t}`);case"rows":case"cols":if(!t&&t!==0)throw new Error(`${o} must be numeric, value: ${t}`)}return t}}c.OptionsService=y},2660:function(q,c,S){var m=this&&this.__decorate||function(y,_,o,t){var h,s=arguments.length,r=s<3?_:t===null?t=Object.getOwnPropertyDescriptor(_,o):t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(y,_,o,t);else for(var l=y.length-1;l>=0;l--)(h=y[l])&&(r=(s<3?h(r):s>3?h(_,o,r):h(_,o))||r);return s>3&&r&&Object.defineProperty(_,o,r),r},f=this&&this.__param||function(y,_){return function(o,t){_(o,t,y)}};Object.defineProperty(c,"__esModule",{value:!0}),c.OscLinkService=void 0;const u=S(2585);let d=class{constructor(y){this._bufferService=y,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(y){const _=this._bufferService.buffer;if(y.id===void 0){const l=_.addMarker(_.ybase+_.y),p={data:y,id:this._nextId++,lines:[l]};return l.onDispose(()=>this._removeMarkerFromLink(p,l)),this._dataByLinkId.set(p.id,p),p.id}const o=y,t=this._getEntryIdKey(o),h=this._entriesWithId.get(t);if(h)return this.addLineToLink(h.id,_.ybase+_.y),h.id;const s=_.addMarker(_.ybase+_.y),r={id:this._nextId++,key:this._getEntryIdKey(o),data:o,lines:[s]};return s.onDispose(()=>this._removeMarkerFromLink(r,s)),this._entriesWithId.set(r.key,r),this._dataByLinkId.set(r.id,r),r.id}addLineToLink(y,_){const o=this._dataByLinkId.get(y);if(o&&o.lines.every(t=>t.line!==_)){const t=this._bufferService.buffer.addMarker(_);o.lines.push(t),t.onDispose(()=>this._removeMarkerFromLink(o,t))}}getLinkData(y){var _;return(_=this._dataByLinkId.get(y))===null||_===void 0?void 0:_.data}_getEntryIdKey(y){return`${y.id};;${y.uri}`}_removeMarkerFromLink(y,_){const o=y.lines.indexOf(_);o!==-1&&(y.lines.splice(o,1),y.lines.length===0&&(y.data.id!==void 0&&this._entriesWithId.delete(y.key),this._dataByLinkId.delete(y.id)))}};d=m([f(0,u.IBufferService)],d),c.OscLinkService=d},8343:(q,c)=>{function S(m,f,u){f.di$target===f?f.di$dependencies.push({id:m,index:u}):(f.di$dependencies=[{id:m,index:u}],f.di$target=f)}Object.defineProperty(c,"__esModule",{value:!0}),c.createDecorator=c.getServiceDependencies=c.serviceRegistry=void 0,c.serviceRegistry=new Map,c.getServiceDependencies=function(m){return m.di$dependencies||[]},c.createDecorator=function(m){if(c.serviceRegistry.has(m))return c.serviceRegistry.get(m);const f=function(u,d,y){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");S(f,u,y)};return f.toString=()=>m,c.serviceRegistry.set(m,f),f}},2585:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.IDecorationService=c.IUnicodeService=c.IOscLinkService=c.IOptionsService=c.ILogService=c.LogLevelEnum=c.IInstantiationService=c.ICharsetService=c.ICoreService=c.ICoreMouseService=c.IBufferService=void 0;const m=S(8343);var f;c.IBufferService=(0,m.createDecorator)("BufferService"),c.ICoreMouseService=(0,m.createDecorator)("CoreMouseService"),c.ICoreService=(0,m.createDecorator)("CoreService"),c.ICharsetService=(0,m.createDecorator)("CharsetService"),c.IInstantiationService=(0,m.createDecorator)("InstantiationService"),(f=c.LogLevelEnum||(c.LogLevelEnum={}))[f.DEBUG=0]="DEBUG",f[f.INFO=1]="INFO",f[f.WARN=2]="WARN",f[f.ERROR=3]="ERROR",f[f.OFF=4]="OFF",c.ILogService=(0,m.createDecorator)("LogService"),c.IOptionsService=(0,m.createDecorator)("OptionsService"),c.IOscLinkService=(0,m.createDecorator)("OscLinkService"),c.IUnicodeService=(0,m.createDecorator)("UnicodeService"),c.IDecorationService=(0,m.createDecorator)("DecorationService")},1480:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.UnicodeService=void 0;const m=S(8460),f=S(225);c.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new m.EventEmitter,this.onChange=this._onChange.event;const u=new f.UnicodeV6;this.register(u),this._active=u.version,this._activeProvider=u}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(u){if(!this._providers[u])throw new Error(`unknown Unicode version "${u}"`);this._active=u,this._activeProvider=this._providers[u],this._onChange.fire(u)}register(u){this._providers[u.version]=u}wcwidth(u){return this._activeProvider.wcwidth(u)}getStringCellWidth(u){let d=0;const y=u.length;for(let _=0;_<y;++_){let o=u.charCodeAt(_);if(55296<=o&&o<=56319){if(++_>=y)return d+this.wcwidth(o);const t=u.charCodeAt(_);56320<=t&&t<=57343?o=1024*(o-55296)+t-56320+65536:d+=this.wcwidth(t)}d+=this.wcwidth(o)}return d}}}},se={};function pe(q){var c=se[q];if(c!==void 0)return c.exports;var S=se[q]={exports:{}};return ee[q].call(S.exports,S,S.exports,pe),S.exports}var he={};return(()=>{var q=he;Object.defineProperty(q,"__esModule",{value:!0}),q.Terminal=void 0;const c=pe(3236),S=pe(9042),m=pe(7975),f=pe(7090),u=pe(5741),d=pe(8285),y=["cols","rows"];q.Terminal=class{constructor(_){this._core=new c.Terminal(_),this._addonManager=new u.AddonManager,this._publicOptions=Object.assign({},this._core.options);const o=h=>this._core.options[h],t=(h,s)=>{this._checkReadonlyOptions(h),this._core.options[h]=s};for(const h in this._core.options){const s={get:o.bind(this,h),set:t.bind(this,h)};Object.defineProperty(this._publicOptions,h,s)}}_checkReadonlyOptions(_){if(y.includes(_))throw new Error(`Option "${_}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new m.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new f.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=new d.BufferNamespaceApi(this._core)),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const _=this._core.coreService.decPrivateModes;let o="none";switch(this._core.coreMouseService.activeProtocol){case"X10":o="x10";break;case"VT200":o="vt200";break;case"DRAG":o="drag";break;case"ANY":o="any"}return{applicationCursorKeysMode:_.applicationCursorKeys,applicationKeypadMode:_.applicationKeypad,bracketedPasteMode:_.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:o,originMode:_.origin,reverseWraparoundMode:_.reverseWraparound,sendFocusMode:_.sendFocus,wraparoundMode:_.wraparound}}get options(){return this._publicOptions}set options(_){for(const o in _)this._publicOptions[o]=_[o]}blur(){this._core.blur()}focus(){this._core.focus()}resize(_,o){this._verifyIntegers(_,o),this._core.resize(_,o)}open(_){this._core.open(_)}attachCustomKeyEventHandler(_){this._core.attachCustomKeyEventHandler(_)}registerLinkProvider(_){return this._core.registerLinkProvider(_)}registerCharacterJoiner(_){return this._checkProposedApi(),this._core.registerCharacterJoiner(_)}deregisterCharacterJoiner(_){this._checkProposedApi(),this._core.deregisterCharacterJoiner(_)}registerMarker(_=0){return this._verifyIntegers(_),this._core.addMarker(_)}registerDecoration(_){var o,t,h;return this._checkProposedApi(),this._verifyPositiveIntegers((o=_.x)!==null&&o!==void 0?o:0,(t=_.width)!==null&&t!==void 0?t:0,(h=_.height)!==null&&h!==void 0?h:0),this._core.registerDecoration(_)}hasSelection(){return this._core.hasSelection()}select(_,o,t){this._verifyIntegers(_,o,t),this._core.select(_,o,t)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(_,o){this._verifyIntegers(_,o),this._core.selectLines(_,o)}dispose(){this._addonManager.dispose(),this._core.dispose()}scrollLines(_){this._verifyIntegers(_),this._core.scrollLines(_)}scrollPages(_){this._verifyIntegers(_),this._core.scrollPages(_)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(_){this._verifyIntegers(_),this._core.scrollToLine(_)}clear(){this._core.clear()}write(_,o){this._core.write(_,o)}writeln(_,o){this._core.write(_),this._core.write(`\r
`,o)}paste(_){this._core.paste(_)}refresh(_,o){this._verifyIntegers(_,o),this._core.refresh(_,o)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(_){return this._addonManager.loadAddon(this,_)}static get strings(){return S}_verifyIntegers(..._){for(const o of _)if(o===1/0||isNaN(o)||o%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(..._){for(const o of _)if(o&&(o===1/0||isNaN(o)||o%1!=0||o<0))throw new Error("This API only accepts positive integers")}}})(),he})())})(jr);var on=jr.exports,$r={exports:{}};(function(K,H){(function(ee,se){K.exports=se()})(self,function(){return(()=>{var ee={903:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BaseRenderLayer=void 0;const m=S(503),f=S(627),u=S(237),d=S(860),y=S(374),_=S(296),o=S(855),t=S(274),h=S(859),s=S(399),r=S(345);class l extends h.Disposable{constructor(w,v,b,L,A,T,B,U,D,F){super(),this._terminal=w,this._container=v,this._alpha=A,this._themeService=T,this._bufferService=B,this._optionsService=U,this._decorationService=D,this._coreBrowserService=F,this._deviceCharWidth=0,this._deviceCharHeight=0,this._deviceCellWidth=0,this._deviceCellHeight=0,this._deviceCharLeft=0,this._deviceCharTop=0,this._selectionModel=(0,_.createSelectionRenderModel)(),this._bitmapGenerator=[],this._onAddTextureAtlasCanvas=this.register(new r.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._cellColorResolver=new t.CellColorResolver(this._terminal,this._selectionModel,this._decorationService,this._coreBrowserService,this._themeService),this._canvas=document.createElement("canvas"),this._canvas.classList.add(`xterm-${b}-layer`),this._canvas.style.zIndex=L.toString(),this._initCanvas(),this._container.appendChild(this._canvas),this._refreshCharAtlas(this._themeService.colors),this.register(this._themeService.onChangeColors(E=>{this._refreshCharAtlas(E),this.reset()})),this.register((0,h.toDisposable)(()=>{var E;(0,m.removeElementFromParent)(this._canvas),(E=this._charAtlas)===null||E===void 0||E.dispose()}))}get canvas(){return this._canvas}get cacheCanvas(){var w;return(w=this._charAtlas)===null||w===void 0?void 0:w.pages[0].canvas}_initCanvas(){this._ctx=(0,y.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()}handleBlur(){}handleFocus(){}handleCursorMove(){}handleGridChanged(w,v){}handleSelectionChanged(w,v,b=!1){this._selectionModel.update(this._terminal,w,v,b)}_setTransparency(w){if(w===this._alpha)return;const v=this._canvas;this._alpha=w,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,v),this._refreshCharAtlas(this._themeService.colors),this.handleGridChanged(0,this._bufferService.rows-1)}_refreshCharAtlas(w){var v;if(!(this._deviceCharWidth<=0&&this._deviceCharHeight<=0)){(v=this._charAtlasDisposable)===null||v===void 0||v.dispose(),this._charAtlas=(0,f.acquireTextureAtlas)(this._terminal,this._optionsService.rawOptions,w,this._deviceCellWidth,this._deviceCellHeight,this._deviceCharWidth,this._deviceCharHeight,this._coreBrowserService.dpr),this._charAtlasDisposable=(0,r.forwardEvent)(this._charAtlas.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas),this._charAtlas.warmUp();for(let b=0;b<this._charAtlas.pages.length;b++)this._bitmapGenerator[b]=new p(this._charAtlas.pages[b].canvas)}}resize(w){this._deviceCellWidth=w.device.cell.width,this._deviceCellHeight=w.device.cell.height,this._deviceCharWidth=w.device.char.width,this._deviceCharHeight=w.device.char.height,this._deviceCharLeft=w.device.char.left,this._deviceCharTop=w.device.char.top,this._canvas.width=w.device.canvas.width,this._canvas.height=w.device.canvas.height,this._canvas.style.width=`${w.css.canvas.width}px`,this._canvas.style.height=`${w.css.canvas.height}px`,this._alpha||this._clearAll(),this._refreshCharAtlas(this._themeService.colors)}clearTextureAtlas(){var w;(w=this._charAtlas)===null||w===void 0||w.clearTexture()}_fillCells(w,v,b,L){this._ctx.fillRect(w*this._deviceCellWidth,v*this._deviceCellHeight,b*this._deviceCellWidth,L*this._deviceCellHeight)}_fillMiddleLineAtCells(w,v,b=1){const L=Math.ceil(.5*this._deviceCellHeight);this._ctx.fillRect(w*this._deviceCellWidth,(v+1)*this._deviceCellHeight-L-this._coreBrowserService.dpr,b*this._deviceCellWidth,this._coreBrowserService.dpr)}_fillBottomLineAtCells(w,v,b=1,L=0){this._ctx.fillRect(w*this._deviceCellWidth,(v+1)*this._deviceCellHeight+L-this._coreBrowserService.dpr-1,b*this._deviceCellWidth,this._coreBrowserService.dpr)}_curlyUnderlineAtCell(w,v,b=1){this._ctx.save(),this._ctx.beginPath(),this._ctx.strokeStyle=this._ctx.fillStyle;const L=this._coreBrowserService.dpr;this._ctx.lineWidth=L;for(let A=0;A<b;A++){const T=(w+A)*this._deviceCellWidth,B=(w+A+.5)*this._deviceCellWidth,U=(w+A+1)*this._deviceCellWidth,D=(v+1)*this._deviceCellHeight-L-1,F=D-L,E=D+L;this._ctx.moveTo(T,D),this._ctx.bezierCurveTo(T,F,B,F,B,D),this._ctx.bezierCurveTo(B,E,U,E,U,D)}this._ctx.stroke(),this._ctx.restore()}_dottedUnderlineAtCell(w,v,b=1){this._ctx.save(),this._ctx.beginPath(),this._ctx.strokeStyle=this._ctx.fillStyle;const L=this._coreBrowserService.dpr;this._ctx.lineWidth=L,this._ctx.setLineDash([2*L,L]);const A=w*this._deviceCellWidth,T=(v+1)*this._deviceCellHeight-L-1;this._ctx.moveTo(A,T);for(let B=0;B<b;B++){const U=(w+b+B)*this._deviceCellWidth;this._ctx.lineTo(U,T)}this._ctx.stroke(),this._ctx.closePath(),this._ctx.restore()}_dashedUnderlineAtCell(w,v,b=1){this._ctx.save(),this._ctx.beginPath(),this._ctx.strokeStyle=this._ctx.fillStyle;const L=this._coreBrowserService.dpr;this._ctx.lineWidth=L,this._ctx.setLineDash([4*L,3*L]);const A=w*this._deviceCellWidth,T=(w+b)*this._deviceCellWidth,B=(v+1)*this._deviceCellHeight-L-1;this._ctx.moveTo(A,B),this._ctx.lineTo(T,B),this._ctx.stroke(),this._ctx.closePath(),this._ctx.restore()}_fillLeftLineAtCell(w,v,b){this._ctx.fillRect(w*this._deviceCellWidth,v*this._deviceCellHeight,this._coreBrowserService.dpr*b,this._deviceCellHeight)}_strokeRectAtCell(w,v,b,L){const A=this._coreBrowserService.dpr;this._ctx.lineWidth=A,this._ctx.strokeRect(w*this._deviceCellWidth+A/2,v*this._deviceCellHeight+A/2,b*this._deviceCellWidth-A,L*this._deviceCellHeight-A)}_clearAll(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}_clearCells(w,v,b,L){this._alpha?this._ctx.clearRect(w*this._deviceCellWidth,v*this._deviceCellHeight,b*this._deviceCellWidth,L*this._deviceCellHeight):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(w*this._deviceCellWidth,v*this._deviceCellHeight,b*this._deviceCellWidth,L*this._deviceCellHeight))}_fillCharTrueColor(w,v,b){this._ctx.font=this._getFont(!1,!1),this._ctx.textBaseline=u.TEXT_BASELINE,this._clipRow(b);let L=!1;this._optionsService.rawOptions.customGlyphs!==!1&&(L=(0,d.tryDrawCustomChar)(this._ctx,w.getChars(),v*this._deviceCellWidth,b*this._deviceCellHeight,this._deviceCellWidth,this._deviceCellHeight,this._optionsService.rawOptions.fontSize,this._coreBrowserService.dpr)),L||this._ctx.fillText(w.getChars(),v*this._deviceCellWidth+this._deviceCharLeft,b*this._deviceCellHeight+this._deviceCharTop+this._deviceCharHeight)}_drawChars(w,v,b){var L,A;const T=w.getChars();let B;this._cellColorResolver.resolve(w,v,this._bufferService.buffer.ydisp+b),B=T&&T.length>1?this._charAtlas.getRasterizedGlyphCombinedChar(T,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext):this._charAtlas.getRasterizedGlyph(w.getCode()||o.WHITESPACE_CELL_CODE,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext),B.size.x&&B.size.y&&(this._ctx.save(),this._clipRow(b),this._charAtlas.pages[B.texturePage].version!==((L=this._bitmapGenerator[B.texturePage])===null||L===void 0?void 0:L.version)&&(this._bitmapGenerator[B.texturePage]||(this._bitmapGenerator[B.texturePage]=new p(this._charAtlas.pages[B.texturePage].canvas)),this._bitmapGenerator[B.texturePage].refresh(),this._bitmapGenerator[B.texturePage].version=this._charAtlas.pages[B.texturePage].version),this._ctx.drawImage(((A=this._bitmapGenerator[B.texturePage])===null||A===void 0?void 0:A.bitmap)||this._charAtlas.pages[B.texturePage].canvas,B.texturePosition.x,B.texturePosition.y,B.size.x,B.size.y,v*this._deviceCellWidth+this._deviceCharLeft-B.offset.x,b*this._deviceCellHeight+this._deviceCharTop-B.offset.y,B.size.x,B.size.y),this._ctx.restore())}_clipRow(w){this._ctx.beginPath(),this._ctx.rect(0,w*this._deviceCellHeight,this._bufferService.cols*this._deviceCellWidth,this._deviceCellHeight),this._ctx.clip()}_getFont(w,v){return`${v?"italic":""} ${w?this._optionsService.rawOptions.fontWeightBold:this._optionsService.rawOptions.fontWeight} ${this._optionsService.rawOptions.fontSize*this._coreBrowserService.dpr}px ${this._optionsService.rawOptions.fontFamily}`}}c.BaseRenderLayer=l;class p{constructor(w){this._canvas=w,this._state=0,this._commitTimeout=void 0,this._bitmap=void 0,this.version=-1}get bitmap(){return this._bitmap}refresh(){this._bitmap=void 0,s.isSafari||(this._commitTimeout===void 0&&(this._commitTimeout=window.setTimeout(()=>this._generate(),100)),this._state===1&&(this._state=2))}_generate(){this._state===0&&(this._bitmap=void 0,this._state=1,window.createImageBitmap(this._canvas).then(w=>{this._state===2?this.refresh():this._bitmap=w,this._state=0}),this._commitTimeout&&(this._commitTimeout=void 0))}}},949:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CanvasRenderer=void 0;const m=S(627),f=S(56),u=S(374),d=S(345),y=S(859),_=S(873),o=S(43),t=S(630),h=S(744);class s extends y.Disposable{constructor(l,p,g,w,v,b,L,A,T,B,U){super(),this._terminal=l,this._screenElement=p,this._bufferService=w,this._charSizeService=v,this._optionsService=b,this._coreBrowserService=T,this._themeService=U,this._onRequestRedraw=this.register(new d.EventEmitter),this.onRequestRedraw=this._onRequestRedraw.event,this._onChangeTextureAtlas=this.register(new d.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new d.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event;const D=this._optionsService.rawOptions.allowTransparency;this._renderLayers=[new h.TextRenderLayer(this._terminal,this._screenElement,0,D,this._bufferService,this._optionsService,L,B,this._coreBrowserService,U),new t.SelectionRenderLayer(this._terminal,this._screenElement,1,this._bufferService,this._coreBrowserService,B,this._optionsService,U),new o.LinkRenderLayer(this._terminal,this._screenElement,2,g,this._bufferService,this._optionsService,B,this._coreBrowserService,U),new _.CursorRenderLayer(this._terminal,this._screenElement,3,this._onRequestRedraw,this._bufferService,this._optionsService,A,this._coreBrowserService,B,U)];for(const F of this._renderLayers)(0,d.forwardEvent)(F.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas);this.dimensions=(0,u.createRenderDimensions)(),this._devicePixelRatio=this._coreBrowserService.dpr,this._updateDimensions(),this.register((0,f.observeDevicePixelDimensions)(this._renderLayers[0].canvas,this._coreBrowserService.window,(F,E)=>this._setCanvasDevicePixelDimensions(F,E))),this.register((0,y.toDisposable)(()=>{for(const F of this._renderLayers)F.dispose();(0,m.removeTerminalFromCache)(this._terminal)}))}get textureAtlas(){return this._renderLayers[0].cacheCanvas}handleDevicePixelRatioChange(){this._devicePixelRatio!==this._coreBrowserService.dpr&&(this._devicePixelRatio=this._coreBrowserService.dpr,this.handleResize(this._bufferService.cols,this._bufferService.rows))}handleResize(l,p){this._updateDimensions();for(const g of this._renderLayers)g.resize(this.dimensions);this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}handleCharSizeChanged(){this.handleResize(this._bufferService.cols,this._bufferService.rows)}handleBlur(){this._runOperation(l=>l.handleBlur())}handleFocus(){this._runOperation(l=>l.handleFocus())}handleSelectionChanged(l,p,g=!1){this._runOperation(w=>w.handleSelectionChanged(l,p,g)),this._themeService.colors.selectionForeground&&this._onRequestRedraw.fire({start:0,end:this._bufferService.rows-1})}handleCursorMove(){this._runOperation(l=>l.handleCursorMove())}clear(){this._runOperation(l=>l.reset())}_runOperation(l){for(const p of this._renderLayers)l(p)}renderRows(l,p){for(const g of this._renderLayers)g.handleGridChanged(l,p)}clearTextureAtlas(){for(const l of this._renderLayers)l.clearTextureAtlas()}_updateDimensions(){if(!this._charSizeService.hasValidSize)return;const l=this._coreBrowserService.dpr;this.dimensions.device.char.width=Math.floor(this._charSizeService.width*l),this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*l),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.top=this._optionsService.rawOptions.lineHeight===1?0:Math.round((this.dimensions.device.cell.height-this.dimensions.device.char.height)/2),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.char.left=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.device.canvas.height=this._bufferService.rows*this.dimensions.device.cell.height,this.dimensions.device.canvas.width=this._bufferService.cols*this.dimensions.device.cell.width,this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/l),this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/l),this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows,this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols}_setCanvasDevicePixelDimensions(l,p){this.dimensions.device.canvas.height=p,this.dimensions.device.canvas.width=l;for(const g of this._renderLayers)g.resize(this.dimensions);this._requestRedrawViewport()}_requestRedrawViewport(){this._onRequestRedraw.fire({start:0,end:this._bufferService.rows-1})}}c.CanvasRenderer=s},873:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CursorRenderLayer=void 0;const m=S(903),f=S(782),u=S(859);class d extends m.BaseRenderLayer{constructor(o,t,h,s,r,l,p,g,w,v){super(o,t,"cursor",h,!0,v,r,l,w,g),this._onRequestRedraw=s,this._coreService=p,this._cell=new f.CellData,this._state={x:0,y:0,isFocused:!1,style:"",width:0},this._cursorRenderers={bar:this._renderBarCursor.bind(this),block:this._renderBlockCursor.bind(this),underline:this._renderUnderlineCursor.bind(this)},this.register(l.onOptionChange(()=>this._handleOptionsChanged())),this.register((0,u.toDisposable)(()=>{var b;(b=this._cursorBlinkStateManager)===null||b===void 0||b.dispose(),this._cursorBlinkStateManager=void 0}))}resize(o){super.resize(o),this._state={x:0,y:0,isFocused:!1,style:"",width:0}}reset(){var o;this._clearCursor(),(o=this._cursorBlinkStateManager)===null||o===void 0||o.restartBlinkAnimation(),this._handleOptionsChanged()}handleBlur(){var o;(o=this._cursorBlinkStateManager)===null||o===void 0||o.pause(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})}handleFocus(){var o;(o=this._cursorBlinkStateManager)===null||o===void 0||o.resume(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})}_handleOptionsChanged(){var o;this._optionsService.rawOptions.cursorBlink?this._cursorBlinkStateManager||(this._cursorBlinkStateManager=new y(this._coreBrowserService.isFocused,()=>{this._render(!0)},this._coreBrowserService)):((o=this._cursorBlinkStateManager)===null||o===void 0||o.dispose(),this._cursorBlinkStateManager=void 0),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})}handleCursorMove(){var o;(o=this._cursorBlinkStateManager)===null||o===void 0||o.restartBlinkAnimation()}handleGridChanged(o,t){!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isPaused?this._render(!1):this._cursorBlinkStateManager.restartBlinkAnimation()}_render(o){if(!this._coreService.isCursorInitialized||this._coreService.isCursorHidden)return void this._clearCursor();const t=this._bufferService.buffer.ybase+this._bufferService.buffer.y,h=t-this._bufferService.buffer.ydisp;if(h<0||h>=this._bufferService.rows)return void this._clearCursor();const s=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1);if(this._bufferService.buffer.lines.get(t).loadCell(s,this._cell),this._cell.content!==void 0){if(!this._coreBrowserService.isFocused){this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css;const r=this._optionsService.rawOptions.cursorStyle;return r&&r!=="block"?this._cursorRenderers[r](s,h,this._cell):this._renderBlurCursor(s,h,this._cell),this._ctx.restore(),this._state.x=s,this._state.y=h,this._state.isFocused=!1,this._state.style=r,void(this._state.width=this._cell.getWidth())}if(!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isCursorVisible){if(this._state){if(this._state.x===s&&this._state.y===h&&this._state.isFocused===this._coreBrowserService.isFocused&&this._state.style===this._optionsService.rawOptions.cursorStyle&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save(),this._cursorRenderers[this._optionsService.rawOptions.cursorStyle||"block"](s,h,this._cell),this._ctx.restore(),this._state.x=s,this._state.y=h,this._state.isFocused=!1,this._state.style=this._optionsService.rawOptions.cursorStyle,this._state.width=this._cell.getWidth()}else this._clearCursor()}}_clearCursor(){this._state&&(this._coreBrowserService.dpr<1?this._clearAll():this._clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:0,y:0,isFocused:!1,style:"",width:0})}_renderBarCursor(o,t,h){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillLeftLineAtCell(o,t,this._optionsService.rawOptions.cursorWidth),this._ctx.restore()}_renderBlockCursor(o,t,h){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillCells(o,t,h.getWidth(),1),this._ctx.fillStyle=this._themeService.colors.cursorAccent.css,this._fillCharTrueColor(h,o,t),this._ctx.restore()}_renderUnderlineCursor(o,t,h){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillBottomLineAtCells(o,t),this._ctx.restore()}_renderBlurCursor(o,t,h){this._ctx.save(),this._ctx.strokeStyle=this._themeService.colors.cursor.css,this._strokeRectAtCell(o,t,h.getWidth(),1),this._ctx.restore()}}c.CursorRenderLayer=d;class y{constructor(o,t,h){this._renderCallback=t,this._coreBrowserService=h,this.isCursorVisible=!0,o&&this._restartInterval()}get isPaused(){return!(this._blinkStartTimeout||this._blinkInterval)}dispose(){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}restartBlinkAnimation(){this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})))}_restartInterval(o=600){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=this._coreBrowserService.window.setTimeout(()=>{if(this._animationTimeRestarted){const t=600-(Date.now()-this._animationTimeRestarted);if(this._animationTimeRestarted=void 0,t>0)return void this._restartInterval(t)}this.isCursorVisible=!1,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0}),this._blinkInterval=this._coreBrowserService.window.setInterval(()=>{if(this._animationTimeRestarted){const t=600-(Date.now()-this._animationTimeRestarted);return this._animationTimeRestarted=void 0,void this._restartInterval(t)}this.isCursorVisible=!this.isCursorVisible,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})},600)},o)}pause(){this.isCursorVisible=!0,this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}resume(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()}}},574:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GridCache=void 0,c.GridCache=class{constructor(){this.cache=[]}resize(S,m){for(let f=0;f<S;f++){this.cache.length<=f&&this.cache.push([]);for(let u=this.cache[f].length;u<m;u++)this.cache[f].push(void 0);this.cache[f].length=m}this.cache.length=S}clear(){for(let S=0;S<this.cache.length;S++)for(let m=0;m<this.cache[S].length;m++)this.cache[S][m]=void 0}}},43:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.LinkRenderLayer=void 0;const m=S(903),f=S(237),u=S(197);class d extends m.BaseRenderLayer{constructor(_,o,t,h,s,r,l,p,g){super(_,o,"link",t,!0,g,s,r,l,p),this.register(h.onShowLinkUnderline(w=>this._handleShowLinkUnderline(w))),this.register(h.onHideLinkUnderline(w=>this._handleHideLinkUnderline(w)))}resize(_){super.resize(_),this._state=void 0}reset(){this._clearCurrentLink()}_clearCurrentLink(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);const _=this._state.y2-this._state.y1-1;_>0&&this._clearCells(0,this._state.y1+1,this._state.cols,_),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}}_handleShowLinkUnderline(_){if(_.fg===f.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._themeService.colors.background.css:_.fg&&(0,u.is256Color)(_.fg)?this._ctx.fillStyle=this._themeService.colors.ansi[_.fg].css:this._ctx.fillStyle=this._themeService.colors.foreground.css,_.y1===_.y2)this._fillBottomLineAtCells(_.x1,_.y1,_.x2-_.x1);else{this._fillBottomLineAtCells(_.x1,_.y1,_.cols-_.x1);for(let o=_.y1+1;o<_.y2;o++)this._fillBottomLineAtCells(0,o,_.cols);this._fillBottomLineAtCells(0,_.y2,_.x2)}this._state=_}_handleHideLinkUnderline(_){this._clearCurrentLink()}}c.LinkRenderLayer=d},630:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SelectionRenderLayer=void 0;const m=S(903);class f extends m.BaseRenderLayer{constructor(d,y,_,o,t,h,s,r){super(d,y,"selection",_,!0,r,o,s,h,t),this._clearState()}_clearState(){this._state={start:void 0,end:void 0,columnSelectMode:void 0,ydisp:void 0}}resize(d){super.resize(d),this._selectionModel.selectionStart&&this._selectionModel.selectionEnd&&this._redrawSelection(this._selectionModel.selectionStart,this._selectionModel.selectionEnd,this._selectionModel.columnSelectMode)}reset(){this._state.start&&this._state.end&&(this._clearState(),this._clearAll())}handleBlur(){this.reset(),this._redrawSelection(this._selectionModel.selectionStart,this._selectionModel.selectionEnd,this._selectionModel.columnSelectMode)}handleFocus(){this.reset(),this._redrawSelection(this._selectionModel.selectionStart,this._selectionModel.selectionEnd,this._selectionModel.columnSelectMode)}handleSelectionChanged(d,y,_){super.handleSelectionChanged(d,y,_),this._redrawSelection(d,y,_)}_redrawSelection(d,y,_){if(!this._didStateChange(d,y,_,this._bufferService.buffer.ydisp))return;if(this._clearAll(),!d||!y)return void this._clearState();const o=d[1]-this._bufferService.buffer.ydisp,t=y[1]-this._bufferService.buffer.ydisp,h=Math.max(o,0),s=Math.min(t,this._bufferService.rows-1);if(h>=this._bufferService.rows||s<0)this._state.ydisp=this._bufferService.buffer.ydisp;else{if(this._ctx.fillStyle=(this._coreBrowserService.isFocused?this._themeService.colors.selectionBackgroundTransparent:this._themeService.colors.selectionInactiveBackgroundTransparent).css,_){const r=d[0],l=y[0]-r,p=s-h+1;this._fillCells(r,h,l,p)}else{const r=o===h?d[0]:0,l=h===t?y[0]:this._bufferService.cols;this._fillCells(r,h,l-r,1);const p=Math.max(s-h-1,0);if(this._fillCells(0,h+1,this._bufferService.cols,p),h!==s){const g=t===s?y[0]:this._bufferService.cols;this._fillCells(0,s,g,1)}}this._state.start=[d[0],d[1]],this._state.end=[y[0],y[1]],this._state.columnSelectMode=_,this._state.ydisp=this._bufferService.buffer.ydisp}}_didStateChange(d,y,_,o){return!this._areCoordinatesEqual(d,this._state.start)||!this._areCoordinatesEqual(y,this._state.end)||_!==this._state.columnSelectMode||o!==this._state.ydisp}_areCoordinatesEqual(d,y){return!(!d||!y)&&d[0]===y[0]&&d[1]===y[1]}}c.SelectionRenderLayer=f},744:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TextRenderLayer=void 0;const m=S(574),f=S(903),u=S(147),d=S(855),y=S(782),_=S(577),o=S(160);class t extends f.BaseRenderLayer{constructor(s,r,l,p,g,w,v,b,L,A){super(s,r,"text",l,p,A,g,w,b,L),this._characterJoinerService=v,this._characterWidth=0,this._characterFont="",this._characterOverlapCache={},this._workCell=new y.CellData,this._state=new m.GridCache,this.register(w.onSpecificOptionChange("allowTransparency",T=>this._setTransparency(T)))}resize(s){super.resize(s);const r=this._getFont(!1,!1);this._characterWidth===s.device.char.width&&this._characterFont===r||(this._characterWidth=s.device.char.width,this._characterFont=r,this._characterOverlapCache={}),this._state.clear(),this._state.resize(this._bufferService.cols,this._bufferService.rows)}reset(){this._state.clear(),this._clearAll()}_forEachCell(s,r,l){for(let p=s;p<=r;p++){const g=p+this._bufferService.buffer.ydisp,w=this._bufferService.buffer.lines.get(g),v=this._characterJoinerService.getJoinedCharacters(g);for(let b=0;b<this._bufferService.cols;b++){w.loadCell(b,this._workCell);let L=this._workCell,A=!1,T=b;if(L.getWidth()===0)continue;const B=L.getCode();if(B!==0&&B!==32){if(v.length>0&&b===v[0][0]){A=!0;const U=v.shift();L=new _.JoinedCellData(this._workCell,w.translateToString(!0,U[0],U[1]),U[1]-U[0]),T=U[1]-1}!A&&this._isOverlapping(L)&&T<w.length-1&&w.getCodePoint(T+1)===d.NULL_CELL_CODE&&(L.content&=-12582913,L.content|=8388608),l(L,b,p),b=T}}}}_drawBackground(s,r){const l=this._ctx,p=this._bufferService.cols;let g=0,w=0,v=null;l.save(),this._forEachCell(s,r,(b,L,A)=>{let T=null;b.isInverse()?T=b.isFgDefault()?this._themeService.colors.foreground.css:b.isFgRGB()?`rgb(${u.AttributeData.toColorRGB(b.getFgColor()).join(",")})`:this._themeService.colors.ansi[b.getFgColor()].css:b.isBgRGB()?T=`rgb(${u.AttributeData.toColorRGB(b.getBgColor()).join(",")})`:b.isBgPalette()&&(T=this._themeService.colors.ansi[b.getBgColor()].css),T&&b.isDim()&&(T=o.color.multiplyOpacity(o.css.toColor(T),.5).css);let B=!1;this._decorationService.forEachDecorationAtCell(L,this._bufferService.buffer.ydisp+A,void 0,U=>{U.options.layer!=="top"&&B||(U.backgroundColorRGB&&(T=U.backgroundColorRGB.css),B=U.options.layer==="top")}),v===null&&(g=L,w=A),A!==w?(l.fillStyle=v||"",this._fillCells(g,w,p-g,1),g=L,w=A):v!==T&&(l.fillStyle=v||"",this._fillCells(g,w,L-g,1),g=L,w=A),v=T}),v!==null&&(l.fillStyle=v,this._fillCells(g,w,p-g,1)),l.restore()}_drawForeground(s,r){this._forEachCell(s,r,(l,p,g)=>this._drawChars(l,p,g))}handleGridChanged(s,r){this._state.cache.length!==0&&(this._charAtlas&&this._charAtlas.beginFrame(),this._clearCells(0,s,this._bufferService.cols,r-s+1),this._drawBackground(s,r),this._drawForeground(s,r))}_isOverlapping(s){if(s.getWidth()!==1||s.getCode()<256)return!1;const r=s.getChars();if(this._characterOverlapCache.hasOwnProperty(r))return this._characterOverlapCache[r];this._ctx.save(),this._ctx.font=this._characterFont;const l=Math.floor(this._ctx.measureText(r).width)>this._characterWidth;return this._ctx.restore(),this._characterOverlapCache[r]=l,l}}c.TextRenderLayer=t},503:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.removeElementFromParent=void 0,c.removeElementFromParent=function(...S){var m;for(const f of S)(m=f==null?void 0:f.parentElement)===null||m===void 0||m.removeChild(f)}},274:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CellColorResolver=void 0;let S,m=0,f=0,u=!1,d=!1,y=!1;c.CellColorResolver=class{constructor(_,o,t,h,s){this._terminal=_,this._selectionRenderModel=o,this._decorationService=t,this._coreBrowserService=h,this._themeService=s,this.result={fg:0,bg:0,ext:0}}resolve(_,o,t){this.result.bg=_.bg,this.result.fg=_.fg,this.result.ext=268435456&_.bg?_.extended.ext:0,f=0,m=0,d=!1,u=!1,y=!1,S=this._themeService.colors,this._decorationService.forEachDecorationAtCell(o,t,"bottom",h=>{h.backgroundColorRGB&&(f=h.backgroundColorRGB.rgba>>8&16777215,d=!0),h.foregroundColorRGB&&(m=h.foregroundColorRGB.rgba>>8&16777215,u=!0)}),y=this._selectionRenderModel.isCellSelected(this._terminal,o,t),y&&(f=(this._coreBrowserService.isFocused?S.selectionBackgroundOpaque:S.selectionInactiveBackgroundOpaque).rgba>>8&16777215,d=!0,S.selectionForeground&&(m=S.selectionForeground.rgba>>8&16777215,u=!0)),this._decorationService.forEachDecorationAtCell(o,t,"top",h=>{h.backgroundColorRGB&&(f=h.backgroundColorRGB.rgba>>8&16777215,d=!0),h.foregroundColorRGB&&(m=h.foregroundColorRGB.rgba>>8&16777215,u=!0)}),d&&(f=y?-16777216&_.bg&-134217729|f|50331648:-16777216&_.bg|f|50331648),u&&(m=-16777216&_.fg&-67108865|m|50331648),67108864&this.result.fg&&(d&&!u&&(m=50331648&this.result.bg?-134217728&this.result.fg|67108863&this.result.bg:-134217728&this.result.fg|16777215&S.background.rgba>>8|50331648,u=!0),!d&&u&&(f=50331648&this.result.fg?-67108864&this.result.bg|67108863&this.result.fg:-67108864&this.result.bg|16777215&S.foreground.rgba>>8|50331648,d=!0)),S=void 0,this.result.bg=d?f:this.result.bg,this.result.fg=u?m:this.result.fg}}},627:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.removeTerminalFromCache=c.acquireTextureAtlas=void 0;const m=S(509),f=S(197),u=[];c.acquireTextureAtlas=function(d,y,_,o,t,h,s,r){const l=(0,f.generateConfig)(o,t,h,s,y,_,r);for(let w=0;w<u.length;w++){const v=u[w],b=v.ownedBy.indexOf(d);if(b>=0){if((0,f.configEquals)(v.config,l))return v.atlas;v.ownedBy.length===1?(v.atlas.dispose(),u.splice(w,1)):v.ownedBy.splice(b,1);break}}for(let w=0;w<u.length;w++){const v=u[w];if((0,f.configEquals)(v.config,l))return v.ownedBy.push(d),v.atlas}const p=d._core,g={atlas:new m.TextureAtlas(document,l,p.unicodeService),config:l,ownedBy:[d]};return u.push(g),g.atlas},c.removeTerminalFromCache=function(d){for(let y=0;y<u.length;y++){const _=u[y].ownedBy.indexOf(d);if(_!==-1){u[y].ownedBy.length===1?(u[y].atlas.dispose(),u.splice(y,1)):u[y].ownedBy.splice(_,1);break}}}},197:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.is256Color=c.configEquals=c.generateConfig=void 0;const m=S(160);c.generateConfig=function(f,u,d,y,_,o,t){const h={foreground:o.foreground,background:o.background,cursor:m.NULL_COLOR,cursorAccent:m.NULL_COLOR,selectionForeground:m.NULL_COLOR,selectionBackgroundTransparent:m.NULL_COLOR,selectionBackgroundOpaque:m.NULL_COLOR,selectionInactiveBackgroundTransparent:m.NULL_COLOR,selectionInactiveBackgroundOpaque:m.NULL_COLOR,ansi:o.ansi.slice(),contrastCache:o.contrastCache};return{customGlyphs:_.customGlyphs,devicePixelRatio:t,letterSpacing:_.letterSpacing,lineHeight:_.lineHeight,deviceCellWidth:f,deviceCellHeight:u,deviceCharWidth:d,deviceCharHeight:y,fontFamily:_.fontFamily,fontSize:_.fontSize,fontWeight:_.fontWeight,fontWeightBold:_.fontWeightBold,allowTransparency:_.allowTransparency,drawBoldTextInBrightColors:_.drawBoldTextInBrightColors,minimumContrastRatio:_.minimumContrastRatio,colors:h}},c.configEquals=function(f,u){for(let d=0;d<f.colors.ansi.length;d++)if(f.colors.ansi[d].rgba!==u.colors.ansi[d].rgba)return!1;return f.devicePixelRatio===u.devicePixelRatio&&f.customGlyphs===u.customGlyphs&&f.lineHeight===u.lineHeight&&f.letterSpacing===u.letterSpacing&&f.fontFamily===u.fontFamily&&f.fontSize===u.fontSize&&f.fontWeight===u.fontWeight&&f.fontWeightBold===u.fontWeightBold&&f.allowTransparency===u.allowTransparency&&f.deviceCharWidth===u.deviceCharWidth&&f.deviceCharHeight===u.deviceCharHeight&&f.drawBoldTextInBrightColors===u.drawBoldTextInBrightColors&&f.minimumContrastRatio===u.minimumContrastRatio&&f.colors.foreground.rgba===u.colors.foreground.rgba&&f.colors.background.rgba===u.colors.background.rgba},c.is256Color=function(f){return(50331648&f)==16777216||(50331648&f)==33554432}},237:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TEXT_BASELINE=c.DIM_OPACITY=c.INVERTED_DEFAULT_COLOR=void 0;const m=S(399);c.INVERTED_DEFAULT_COLOR=257,c.DIM_OPACITY=.5,c.TEXT_BASELINE=m.isFirefox||m.isLegacyEdge?"bottom":"ideographic"},860:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.tryDrawCustomChar=c.powerlineDefinitions=c.boxDrawingDefinitions=c.blockElementDefinitions=void 0;const m=S(374);c.blockElementDefinitions={"":[{x:0,y:0,w:8,h:4}],"":[{x:0,y:7,w:8,h:1}],"":[{x:0,y:6,w:8,h:2}],"":[{x:0,y:5,w:8,h:3}],"":[{x:0,y:4,w:8,h:4}],"":[{x:0,y:3,w:8,h:5}],"":[{x:0,y:2,w:8,h:6}],"":[{x:0,y:1,w:8,h:7}],"":[{x:0,y:0,w:8,h:8}],"":[{x:0,y:0,w:7,h:8}],"":[{x:0,y:0,w:6,h:8}],"":[{x:0,y:0,w:5,h:8}],"":[{x:0,y:0,w:4,h:8}],"":[{x:0,y:0,w:3,h:8}],"":[{x:0,y:0,w:2,h:8}],"":[{x:0,y:0,w:1,h:8}],"":[{x:4,y:0,w:4,h:8}],"":[{x:0,y:0,w:8,h:1}],"":[{x:7,y:0,w:1,h:8}],"":[{x:0,y:4,w:4,h:4}],"":[{x:4,y:4,w:4,h:4}],"":[{x:0,y:0,w:4,h:4}],"":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"":[{x:0,y:0,w:4,h:8},{x:4,y:0,w:4,h:4}],"":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"":[{x:4,y:0,w:4,h:4}],"":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"":[{x:1,y:0,w:1,h:8}],"":[{x:2,y:0,w:1,h:8}],"":[{x:3,y:0,w:1,h:8}],"":[{x:4,y:0,w:1,h:8}],"":[{x:5,y:0,w:1,h:8}],"":[{x:6,y:0,w:1,h:8}],"":[{x:0,y:1,w:8,h:1}],"":[{x:0,y:2,w:8,h:1}],"":[{x:0,y:3,w:8,h:1}],"":[{x:0,y:4,w:8,h:1}],"":[{x:0,y:5,w:8,h:1}],"":[{x:0,y:6,w:8,h:1}],"":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:2}],"":[{x:0,y:0,w:8,h:3}],"":[{x:0,y:0,w:8,h:5}],"":[{x:0,y:0,w:8,h:6}],"":[{x:0,y:0,w:8,h:7}],"":[{x:6,y:0,w:2,h:8}],"":[{x:5,y:0,w:3,h:8}],"":[{x:3,y:0,w:5,h:8}],"":[{x:2,y:0,w:6,h:8}],"":[{x:1,y:0,w:7,h:8}],"":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};const f={"":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"":[[1,0],[0,0],[0,1],[0,0]],"":[[0,1],[1,1],[1,0],[1,1]]};c.boxDrawingDefinitions={"":{1:"M0,.5 L1,.5"},"":{3:"M0,.5 L1,.5"},"":{1:"M.5,0 L.5,1"},"":{3:"M.5,0 L.5,1"},"":{1:"M0.5,1 L.5,.5 L1,.5"},"":{3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M0,.5 L.5,.5 L.5,1"},"":{3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M.5,0 L.5,.5 L1,.5"},"":{3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,.5 L0,.5"},"":{3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L1,.5"},"":{3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L0,.5"},"":{3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"":{1:"M0,.5 L1,.5 M.5,.5 L.5,1"},"":{3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"":{1:"M0,.5 L1,.5 M.5,.5 L.5,0"},"":{3:"M0,.5 L1,.5 M.5,.5 L.5,0"},"":{1:"M0,.5 L1,.5 M.5,0 L.5,1"},"":{3:"M0,.5 L1,.5 M.5,0 L.5,1"},"":{1:"M.5,.5 L0,.5"},"":{3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L.5,0"},"":{3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L1,.5"},"":{3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,1"},"":{3:"M.5,.5 L.5,1"},"":{1:(o,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"":{1:(o,t)=>`M${.5-o},0 L${.5-o},1 M${.5+o},0 L${.5+o},1`},"":{1:(o,t)=>`M.5,1 L.5,${.5-t} L1,${.5-t} M.5,${.5+t} L1,${.5+t}`},"":{1:(o,t)=>`M${.5-o},1 L${.5-o},.5 L1,.5 M${.5+o},.5 L${.5+o},1`},"":{1:(o,t)=>`M1,${.5-t} L${.5-o},${.5-t} L${.5-o},1 M1,${.5+t} L${.5+o},${.5+t} L${.5+o},1`},"":{1:(o,t)=>`M0,${.5-t} L.5,${.5-t} L.5,1 M0,${.5+t} L.5,${.5+t}`},"":{1:(o,t)=>`M${.5+o},1 L${.5+o},.5 L0,.5 M${.5-o},.5 L${.5-o},1`},"":{1:(o,t)=>`M0,${.5+t} L${.5-o},${.5+t} L${.5-o},1 M0,${.5-t} L${.5+o},${.5-t} L${.5+o},1`},"":{1:(o,t)=>`M.5,0 L.5,${.5+t} L1,${.5+t} M.5,${.5-t} L1,${.5-t}`},"":{1:(o,t)=>`M1,.5 L${.5-o},.5 L${.5-o},0 M${.5+o},.5 L${.5+o},0`},"":{1:(o,t)=>`M1,${.5-t} L${.5+o},${.5-t} L${.5+o},0 M1,${.5+t} L${.5-o},${.5+t} L${.5-o},0`},"":{1:(o,t)=>`M0,${.5+t} L.5,${.5+t} L.5,0 M0,${.5-t} L.5,${.5-t}`},"":{1:(o,t)=>`M0,.5 L${.5+o},.5 L${.5+o},0 M${.5-o},.5 L${.5-o},0`},"":{1:(o,t)=>`M0,${.5-t} L${.5-o},${.5-t} L${.5-o},0 M0,${.5+t} L${.5+o},${.5+t} L${.5+o},0`},"":{1:(o,t)=>`M.5,0 L.5,1 M.5,${.5-t} L1,${.5-t} M.5,${.5+t} L1,${.5+t}`},"":{1:(o,t)=>`M${.5-o},0 L${.5-o},1 M${.5+o},0 L${.5+o},1 M${.5+o},.5 L1,.5`},"":{1:(o,t)=>`M${.5-o},0 L${.5-o},1 M1,${.5+t} L${.5+o},${.5+t} L${.5+o},1 M1,${.5-t} L${.5+o},${.5-t} L${.5+o},0`},"":{1:(o,t)=>`M.5,0 L.5,1 M0,${.5-t} L.5,${.5-t} M0,${.5+t} L.5,${.5+t}`},"":{1:(o,t)=>`M0,.5 L${.5-o},.5 M${.5-o},0 L${.5-o},1 M${.5+o},0 L${.5+o},1`},"":{1:(o,t)=>`M${.5+o},0 L${.5+o},1 M0,${.5+t} L${.5-o},${.5+t} L${.5-o},1 M0,${.5-t} L${.5-o},${.5-t} L${.5-o},0`},"":{1:(o,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t} M.5,${.5+t} L.5,1`},"":{1:(o,t)=>`M0,.5 L1,.5 M${.5-o},.5 L${.5-o},1 M${.5+o},.5 L${.5+o},1`},"":{1:(o,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L${.5-o},${.5+t} L${.5-o},1 M1,${.5+t} L${.5+o},${.5+t} L${.5+o},1`},"":{1:(o,t)=>`M.5,0 L.5,${.5-t} M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"":{1:(o,t)=>`M0,.5 L1,.5 M${.5-o},.5 L${.5-o},0 M${.5+o},.5 L${.5+o},0`},"":{1:(o,t)=>`M0,${.5+t} L1,${.5+t} M0,${.5-t} L${.5-o},${.5-t} L${.5-o},0 M1,${.5-t} L${.5+o},${.5-t} L${.5+o},0`},"":{1:(o,t)=>`M.5,0 L.5,1 M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"":{1:(o,t)=>`M0,.5 L1,.5 M${.5-o},0 L${.5-o},1 M${.5+o},0 L${.5+o},1`},"":{1:(o,t)=>`M0,${.5+t} L${.5-o},${.5+t} L${.5-o},1 M1,${.5+t} L${.5+o},${.5+t} L${.5+o},1 M0,${.5-t} L${.5-o},${.5-t} L${.5-o},0 M1,${.5-t} L${.5+o},${.5-t} L${.5+o},0`},"":{1:"M1,0 L0,1"},"":{1:"M0,0 L1,1"},"":{1:"M1,0 L0,1 M0,0 L1,1"},"":{1:"M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L.5,0",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L.5,0",3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,0 L.5,1",3:"M.5,.5 L1,.5"},"":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1"},"":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1",3:"M.5,.5 L0,.5"},"":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1"},"":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M.5,.5 L.5,0",3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,1",3:"M0,.5 L1,.5"},"":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5"},"":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1",3:"M0,.5 L1,.5"},"":{1:"M0,.5 L1,.5 M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L.5,0 M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M0,.5 L1,.5",3:"M.5,0 L.5,1"},"":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M.5,0 L.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0 M0,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"":{1:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"":{3:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"":{1:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"":{3:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"":{1:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"":{3:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"":{1:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"":{3:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"":{1:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"":{3:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"":{1:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"":{3:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"":{1:(o,t)=>`M.5,1 L.5,${.5+t/.15*.5} C.5,${.5+t/.15*.5},.5,.5,1,.5`},"":{1:(o,t)=>`M.5,1 L.5,${.5+t/.15*.5} C.5,${.5+t/.15*.5},.5,.5,0,.5`},"":{1:(o,t)=>`M.5,0 L.5,${.5-t/.15*.5} C.5,${.5-t/.15*.5},.5,.5,0,.5`},"":{1:(o,t)=>`M.5,0 L.5,${.5-t/.15*.5} C.5,${.5-t/.15*.5},.5,.5,1,.5`}},c.powerlineDefinitions={"":{d:"M0,0 L1,.5 L0,1",type:0,rightPadding:2},"":{d:"M-1,-.5 L1,.5 L-1,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M1,0 L0,.5 L1,1",type:0,leftPadding:2},"":{d:"M2,-.5 L0,.5 L2,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:0,rightPadding:1},"":{d:"M0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:1,rightPadding:1},"":{d:"M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:0,leftPadding:1},"":{d:"M1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:1,leftPadding:1},"":{d:"M-.5,-.5 L1.5,1.5 L-.5,1.5",type:0},"":{d:"M-.5,-.5 L1.5,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M1.5,-.5 L-.5,1.5 L1.5,1.5",type:0},"":{d:"M1.5,-.5 L-.5,1.5 L-.5,-.5",type:0},"":{d:"M1.5,-.5 L-.5,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M-.5,-.5 L1.5,1.5 L1.5,-.5",type:0}},c.powerlineDefinitions[""]=c.powerlineDefinitions[""],c.powerlineDefinitions[""]=c.powerlineDefinitions[""],c.tryDrawCustomChar=function(o,t,h,s,r,l,p,g){const w=c.blockElementDefinitions[t];if(w)return function(A,T,B,U,D,F){for(let E=0;E<T.length;E++){const I=T[E],O=D/8,P=F/8;A.fillRect(B+I.x*O,U+I.y*P,I.w*O,I.h*P)}}(o,w,h,s,r,l),!0;const v=f[t];if(v)return function(A,T,B,U,D,F){let E=u.get(T);E||(E=new Map,u.set(T,E));const I=A.fillStyle;if(typeof I!="string")throw new Error(`Unexpected fillStyle type "${I}"`);let O=E.get(I);if(!O){const P=T[0].length,J=T.length,j=document.createElement("canvas");j.width=P,j.height=J;const X=(0,m.throwIfFalsy)(j.getContext("2d")),V=new ImageData(P,J);let re,G,z,W;if(I.startsWith("#"))re=parseInt(I.slice(1,3),16),G=parseInt(I.slice(3,5),16),z=parseInt(I.slice(5,7),16),W=I.length>7&&parseInt(I.slice(7,9),16)||1;else{if(!I.startsWith("rgba"))throw new Error(`Unexpected fillStyle color format "${I}" when drawing pattern glyph`);[re,G,z,W]=I.substring(5,I.length-1).split(",").map(te=>parseFloat(te))}for(let te=0;te<J;te++)for(let ne=0;ne<P;ne++)V.data[4*(te*P+ne)]=re,V.data[4*(te*P+ne)+1]=G,V.data[4*(te*P+ne)+2]=z,V.data[4*(te*P+ne)+3]=T[te][ne]*(255*W);X.putImageData(V,0,0),O=(0,m.throwIfFalsy)(A.createPattern(j,null)),E.set(I,O)}A.fillStyle=O,A.fillRect(B,U,D,F)}(o,v,h,s,r,l),!0;const b=c.boxDrawingDefinitions[t];if(b)return function(A,T,B,U,D,F,E){A.strokeStyle=A.fillStyle;for(const[I,O]of Object.entries(T)){let P;A.beginPath(),A.lineWidth=E*Number.parseInt(I),P=typeof O=="function"?O(.15,.15/F*D):O;for(const J of P.split(" ")){const j=J[0],X=y[j];if(!X){console.error(`Could not find drawing instructions for "${j}"`);continue}const V=J.substring(1).split(",");V[0]&&V[1]&&X(A,_(V,D,F,B,U,!0,E))}A.stroke(),A.closePath()}}(o,b,h,s,r,l,g),!0;const L=c.powerlineDefinitions[t];return!!L&&(function(A,T,B,U,D,F,E,I){var O,P;const J=new Path2D;J.rect(B,U,D,F),A.clip(J),A.beginPath();const j=E/12;A.lineWidth=I*j;for(const X of T.d.split(" ")){const V=X[0],re=y[V];if(!re){console.error(`Could not find drawing instructions for "${V}"`);continue}const G=X.substring(1).split(",");G[0]&&G[1]&&re(A,_(G,D,F,B,U,!1,I,((O=T.leftPadding)!==null&&O!==void 0?O:0)*(j/2),((P=T.rightPadding)!==null&&P!==void 0?P:0)*(j/2)))}T.type===1?(A.strokeStyle=A.fillStyle,A.stroke()):A.fill(),A.closePath()}(o,L,h,s,r,l,p,g),!0)};const u=new Map;function d(o,t,h=0){return Math.max(Math.min(o,t),h)}const y={C:(o,t)=>o.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5]),L:(o,t)=>o.lineTo(t[0],t[1]),M:(o,t)=>o.moveTo(t[0],t[1])};function _(o,t,h,s,r,l,p,g=0,w=0){const v=o.map(b=>parseFloat(b)||parseInt(b));if(v.length<2)throw new Error("Too few arguments for instruction");for(let b=0;b<v.length;b+=2)v[b]*=t-g*p-w*p,l&&v[b]!==0&&(v[b]=d(Math.round(v[b]+.5)-.5,t,0)),v[b]+=s+g*p;for(let b=1;b<v.length;b+=2)v[b]*=h,l&&v[b]!==0&&(v[b]=d(Math.round(v[b]+.5)-.5,h,0)),v[b]+=r;return v}},56:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.observeDevicePixelDimensions=void 0;const m=S(859);c.observeDevicePixelDimensions=function(f,u,d){let y=new u.ResizeObserver(_=>{const o=_.find(s=>s.target===f);if(!o)return;if(!("devicePixelContentBoxSize"in o))return y==null||y.disconnect(),void(y=void 0);const t=o.devicePixelContentBoxSize[0].inlineSize,h=o.devicePixelContentBoxSize[0].blockSize;t>0&&h>0&&d(t,h)});try{y.observe(f,{box:["device-pixel-content-box"]})}catch{y.disconnect(),y=void 0}return(0,m.toDisposable)(()=>y==null?void 0:y.disconnect())}},374:(q,c)=>{function S(m){return 57508<=m&&m<=57558}Object.defineProperty(c,"__esModule",{value:!0}),c.createRenderDimensions=c.excludeFromContrastRatioDemands=c.isRestrictedPowerlineGlyph=c.isPowerlineGlyph=c.throwIfFalsy=void 0,c.throwIfFalsy=function(m){if(!m)throw new Error("value must not be falsy");return m},c.isPowerlineGlyph=S,c.isRestrictedPowerlineGlyph=function(m){return 57520<=m&&m<=57527},c.excludeFromContrastRatioDemands=function(m){return S(m)||function(f){return 9472<=f&&f<=9631}(m)},c.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},296:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.createSelectionRenderModel=void 0;class S{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(f,u,d,y=!1){if(this.selectionStart=u,this.selectionEnd=d,!u||!d||u[0]===d[0]&&u[1]===d[1])return void this.clear();const _=u[1]-f.buffer.active.viewportY,o=d[1]-f.buffer.active.viewportY,t=Math.max(_,0),h=Math.min(o,f.rows-1);t>=f.rows||h<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=y,this.viewportStartRow=_,this.viewportEndRow=o,this.viewportCappedStartRow=t,this.viewportCappedEndRow=h,this.startCol=u[0],this.endCol=d[0])}isCellSelected(f,u,d){return!!this.hasSelection&&(d-=f.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?u>=this.startCol&&d>=this.viewportCappedStartRow&&u<this.endCol&&d<=this.viewportCappedEndRow:u<this.startCol&&d>=this.viewportCappedStartRow&&u>=this.endCol&&d<=this.viewportCappedEndRow:d>this.viewportStartRow&&d<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&d===this.viewportStartRow&&u>=this.startCol&&u<this.endCol||this.viewportStartRow<this.viewportEndRow&&d===this.viewportEndRow&&u<this.endCol||this.viewportStartRow<this.viewportEndRow&&d===this.viewportStartRow&&u>=this.startCol)}}c.createSelectionRenderModel=function(){return new S}},509:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TextureAtlas=void 0;const m=S(237),f=S(855),u=S(147),d=S(160),y=S(860),_=S(374),o=S(485),t=S(385),h=S(345),s={texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},offset:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}};let r;class l{constructor(b,L,A){this._document=b,this._config=L,this._unicodeService=A,this._didWarmUp=!1,this._cacheMap=new o.FourKeyMap,this._cacheMapCombined=new o.FourKeyMap,this._pages=[],this._activePages=[],this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new u.AttributeData,this._textureSize=512,this._onAddTextureAtlasCanvas=new h.EventEmitter,this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=new h.EventEmitter,this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._requestClearModel=!1,this._createNewPage(),this._tmpCanvas=w(b,4*this._config.deviceCellWidth+4,this._config.deviceCellHeight+4),this._tmpCtx=(0,_.throwIfFalsy)(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency,willReadFrequently:!0}))}get pages(){return this._pages}dispose(){for(const b of this.pages)b.canvas.remove();this._onAddTextureAtlasCanvas.dispose()}warmUp(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)}_doWarmUp(){const b=new t.IdleTaskQueue;for(let L=33;L<126;L++)b.enqueue(()=>{if(!this._cacheMap.get(L,f.DEFAULT_COLOR,f.DEFAULT_COLOR,f.DEFAULT_EXT)){const A=this._drawToCache(L,f.DEFAULT_COLOR,f.DEFAULT_COLOR,f.DEFAULT_EXT);this._cacheMap.set(L,f.DEFAULT_COLOR,f.DEFAULT_COLOR,f.DEFAULT_EXT,A)}})}beginFrame(){return this._requestClearModel}clearTexture(){if(this._pages[0].currentRow.x!==0||this._pages[0].currentRow.y!==0){for(const b of this._pages)b.clear();this._cacheMap.clear(),this._cacheMapCombined.clear(),this._didWarmUp=!1}}_createNewPage(){l.maxAtlasPages&&this._pages.length>=Math.max(4,l.maxAtlasPages/2)&&queueMicrotask(()=>{const L=this._pages.filter(E=>2*E.canvas.width<=(l.maxTextureSize||4096)).sort((E,I)=>I.canvas.width!==E.canvas.width?I.canvas.width-E.canvas.width:I.percentageUsed-E.percentageUsed);let A=-1,T=0;for(let E=0;E<L.length;E++)if(L[E].canvas.width!==T)A=E,T=L[E].canvas.width;else if(E-A==3)break;const B=L.slice(A,A+4),U=B.map(E=>E.glyphs[0].texturePage).sort((E,I)=>E>I?1:-1),D=U[0],F=this._mergePages(B,D);F.version++,this._pages[D]=F;for(let E=U.length-1;E>=1;E--)this._deletePage(U[E]);this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(F.canvas)});const b=new p(this._document,this._textureSize);return this._pages.push(b),this._activePages.push(b),this._onAddTextureAtlasCanvas.fire(b.canvas),b}_mergePages(b,L){const A=2*b[0].canvas.width,T=new p(this._document,A,b);for(const[B,U]of b.entries()){const D=B*U.canvas.width%A,F=Math.floor(B/2)*U.canvas.height;T.ctx.drawImage(U.canvas,D,F);for(const I of U.glyphs)I.texturePage=L,I.sizeClipSpace.x=I.size.x/A,I.sizeClipSpace.y=I.size.y/A,I.texturePosition.x+=D,I.texturePosition.y+=F,I.texturePositionClipSpace.x=I.texturePosition.x/A,I.texturePositionClipSpace.y=I.texturePosition.y/A;this._onRemoveTextureAtlasCanvas.fire(U.canvas);const E=this._activePages.indexOf(U);E!==-1&&this._activePages.splice(E,1)}return T}_deletePage(b){this._pages.splice(b,1);for(let L=b;L<this._pages.length;L++){const A=this._pages[L];for(const T of A.glyphs)T.texturePage--;A.version++}}getRasterizedGlyphCombinedChar(b,L,A,T){return this._getFromCacheMap(this._cacheMapCombined,b,L,A,T)}getRasterizedGlyph(b,L,A,T){return this._getFromCacheMap(this._cacheMap,b,L,A,T)}_getFromCacheMap(b,L,A,T,B){return r=b.get(L,A,T,B),r||(r=this._drawToCache(L,A,T,B),b.set(L,A,T,B,r)),r}_getColorFromAnsiIndex(b){if(b>=this._config.colors.ansi.length)throw new Error("No color found for idx "+b);return this._config.colors.ansi[b]}_getBackgroundColor(b,L,A,T){if(this._config.allowTransparency)return d.NULL_COLOR;let B;switch(b){case 16777216:case 33554432:B=this._getColorFromAnsiIndex(L);break;case 50331648:const U=u.AttributeData.toColorRGB(L);B=d.rgba.toColor(U[0],U[1],U[2]);break;default:B=A?this._config.colors.foreground:this._config.colors.background}return T&&(B=d.color.blend(this._config.colors.background,d.color.multiplyOpacity(B,m.DIM_OPACITY))),B}_getForegroundColor(b,L,A,T,B,U,D,F,E,I){const O=this._getMinimumContrastColor(b,L,A,T,B,U,!1,E,I);if(O)return O;let P;switch(B){case 16777216:case 33554432:this._config.drawBoldTextInBrightColors&&E&&U<8&&(U+=8),P=this._getColorFromAnsiIndex(U);break;case 50331648:const J=u.AttributeData.toColorRGB(U);P=d.rgba.toColor(J[0],J[1],J[2]);break;default:P=D?this._config.colors.background:this._config.colors.foreground}return this._config.allowTransparency&&(P=d.color.opaque(P)),F&&(P=d.color.multiplyOpacity(P,m.DIM_OPACITY)),P}_resolveBackgroundRgba(b,L,A){switch(b){case 16777216:case 33554432:return this._getColorFromAnsiIndex(L).rgba;case 50331648:return L<<8;default:return A?this._config.colors.foreground.rgba:this._config.colors.background.rgba}}_resolveForegroundRgba(b,L,A,T){switch(b){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&T&&L<8&&(L+=8),this._getColorFromAnsiIndex(L).rgba;case 50331648:return L<<8;default:return A?this._config.colors.background.rgba:this._config.colors.foreground.rgba}}_getMinimumContrastColor(b,L,A,T,B,U,D,F,E){if(this._config.minimumContrastRatio===1||E)return;const I=this._config.colors.contrastCache.getColor(b,T);if(I!==void 0)return I||void 0;const O=this._resolveBackgroundRgba(L,A,D),P=this._resolveForegroundRgba(B,U,D,F),J=d.rgba.ensureContrastRatio(O,P,this._config.minimumContrastRatio);if(!J)return void this._config.colors.contrastCache.setColor(b,T,null);const j=d.rgba.toColor(J>>24&255,J>>16&255,J>>8&255);return this._config.colors.contrastCache.setColor(b,T,j),j}_drawToCache(b,L,A,T){const B=typeof b=="number"?String.fromCharCode(b):b,U=this._config.deviceCellWidth*Math.max(B.length,2)+4;this._tmpCanvas.width<U&&(this._tmpCanvas.width=U);const D=this._config.deviceCellHeight+8;if(this._tmpCanvas.height<D&&(this._tmpCanvas.height=D),this._tmpCtx.save(),this._workAttributeData.fg=A,this._workAttributeData.bg=L,this._workAttributeData.extended.ext=T,this._workAttributeData.isInvisible())return s;const F=!!this._workAttributeData.isBold(),E=!!this._workAttributeData.isInverse(),I=!!this._workAttributeData.isDim(),O=!!this._workAttributeData.isItalic(),P=!!this._workAttributeData.isUnderline(),J=!!this._workAttributeData.isStrikethrough();let j=this._workAttributeData.getFgColor(),X=this._workAttributeData.getFgColorMode(),V=this._workAttributeData.getBgColor(),re=this._workAttributeData.getBgColorMode();if(E){const Ce=j;j=V,V=Ce;const Ae=X;X=re,re=Ae}const G=this._getBackgroundColor(re,V,E,I);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=G.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";const z=F?this._config.fontWeightBold:this._config.fontWeight,W=O?"italic":"";this._tmpCtx.font=`${W} ${z} ${this._config.fontSize*this._config.devicePixelRatio}px ${this._config.fontFamily}`,this._tmpCtx.textBaseline=m.TEXT_BASELINE;const te=B.length===1&&(0,_.isPowerlineGlyph)(B.charCodeAt(0)),ne=B.length===1&&(0,_.isRestrictedPowerlineGlyph)(B.charCodeAt(0)),Se=this._getForegroundColor(L,re,V,A,X,j,E,I,F,(0,_.excludeFromContrastRatioDemands)(B.charCodeAt(0)));this._tmpCtx.fillStyle=Se.css;const ce=ne?0:4;let ke=!1;this._config.customGlyphs!==!1&&(ke=(0,y.tryDrawCustomChar)(this._tmpCtx,B,ce,ce,this._config.deviceCellWidth,this._config.deviceCellHeight,this._config.fontSize,this._config.devicePixelRatio));let Q,Le=!te;if(Q=typeof b=="number"?this._unicodeService.wcwidth(b):this._unicodeService.getStringCellWidth(b),P){this._tmpCtx.save();const Ce=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),Ae=Ce%2==1?.5:0;if(this._tmpCtx.lineWidth=Ce,this._workAttributeData.isUnderlineColorDefault())this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle;else if(this._workAttributeData.isUnderlineColorRGB())Le=!1,this._tmpCtx.strokeStyle=`rgb(${u.AttributeData.toColorRGB(this._workAttributeData.getUnderlineColor()).join(",")})`;else{Le=!1;let je=this._workAttributeData.getUnderlineColor();this._config.drawBoldTextInBrightColors&&this._workAttributeData.isBold()&&je<8&&(je+=8),this._tmpCtx.strokeStyle=this._getColorFromAnsiIndex(je).css}this._tmpCtx.beginPath();const Pe=ce,Ne=Math.ceil(ce+this._config.deviceCharHeight)-Ae,nt=ce+this._config.deviceCharHeight+Ce-Ae,Qe=Math.ceil(ce+this._config.deviceCharHeight+2*Ce)-Ae;for(let je=0;je<Q;je++){this._tmpCtx.save();const Me=Pe+je*this._config.deviceCellWidth,Ve=Pe+(je+1)*this._config.deviceCellWidth,bt=Me+this._config.deviceCellWidth/2;switch(this._workAttributeData.extended.underlineStyle){case 2:this._tmpCtx.moveTo(Me,Ne),this._tmpCtx.lineTo(Ve,Ne),this._tmpCtx.moveTo(Me,Qe),this._tmpCtx.lineTo(Ve,Qe);break;case 3:const ot=Ce<=1?Qe:Math.ceil(ce+this._config.deviceCharHeight-Ce/2)-Ae,ft=Ce<=1?Ne:Math.ceil(ce+this._config.deviceCharHeight+Ce/2)-Ae,Et=new Path2D;Et.rect(Me,Ne,this._config.deviceCellWidth,Qe-Ne),this._tmpCtx.clip(Et),this._tmpCtx.moveTo(Me-this._config.deviceCellWidth/2,nt),this._tmpCtx.bezierCurveTo(Me-this._config.deviceCellWidth/2,ft,Me,ft,Me,nt),this._tmpCtx.bezierCurveTo(Me,ot,bt,ot,bt,nt),this._tmpCtx.bezierCurveTo(bt,ft,Ve,ft,Ve,nt),this._tmpCtx.bezierCurveTo(Ve,ot,Ve+this._config.deviceCellWidth/2,ot,Ve+this._config.deviceCellWidth/2,nt);break;case 4:this._tmpCtx.setLineDash([2*this._config.devicePixelRatio,this._config.devicePixelRatio]),this._tmpCtx.moveTo(Me,Ne),this._tmpCtx.lineTo(Ve,Ne);break;case 5:this._tmpCtx.setLineDash([4*this._config.devicePixelRatio,3*this._config.devicePixelRatio]),this._tmpCtx.moveTo(Me,Ne),this._tmpCtx.lineTo(Ve,Ne);break;default:this._tmpCtx.moveTo(Me,Ne),this._tmpCtx.lineTo(Ve,Ne)}this._tmpCtx.stroke(),this._tmpCtx.restore()}if(this._tmpCtx.restore(),!ke&&this._config.fontSize>=12&&!this._config.allowTransparency&&B!==" "){this._tmpCtx.save(),this._tmpCtx.textBaseline="alphabetic";const je=this._tmpCtx.measureText(B);if(this._tmpCtx.restore(),"actualBoundingBoxDescent"in je&&je.actualBoundingBoxDescent>0){this._tmpCtx.save();const Me=new Path2D;Me.rect(Pe,Ne-Math.ceil(Ce/2),this._config.deviceCellWidth,Qe-Ne+Math.ceil(Ce/2)),this._tmpCtx.clip(Me),this._tmpCtx.lineWidth=3*this._config.devicePixelRatio,this._tmpCtx.strokeStyle=G.css,this._tmpCtx.strokeText(B,ce,ce+this._config.deviceCharHeight),this._tmpCtx.restore()}}}if(ke||this._tmpCtx.fillText(B,ce,ce+this._config.deviceCharHeight),B==="_"&&!this._config.allowTransparency){let Ce=g(this._tmpCtx.getImageData(ce,ce,this._config.deviceCellWidth,this._config.deviceCellHeight),G,Se,Le);if(Ce)for(let Ae=1;Ae<=5&&(this._tmpCtx.save(),this._tmpCtx.fillStyle=G.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.restore(),this._tmpCtx.fillText(B,ce,ce+this._config.deviceCharHeight-Ae),Ce=g(this._tmpCtx.getImageData(ce,ce,this._config.deviceCellWidth,this._config.deviceCellHeight),G,Se,Le),Ce);Ae++);}if(J){const Ce=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/10)),Ae=this._tmpCtx.lineWidth%2==1?.5:0;this._tmpCtx.lineWidth=Ce,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(ce,ce+Math.floor(this._config.deviceCharHeight/2)-Ae),this._tmpCtx.lineTo(ce+this._config.deviceCharWidth*Q,ce+Math.floor(this._config.deviceCharHeight/2)-Ae),this._tmpCtx.stroke()}this._tmpCtx.restore();const fe=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height);let st;if(st=this._config.allowTransparency?function(Ce){for(let Ae=0;Ae<Ce.data.length;Ae+=4)if(Ce.data[Ae+3]>0)return!1;return!0}(fe):g(fe,G,Se,Le),st)return s;const Re=this._findGlyphBoundingBox(fe,this._workBoundingBox,U,ne,ke,ce);let ie,xe;for(;;){if(this._activePages.length===0){const Ce=this._createNewPage();ie=Ce,xe=Ce.currentRow,xe.height=Re.size.y;break}ie=this._activePages[this._activePages.length-1],xe=ie.currentRow;for(const Ce of this._activePages)Re.size.y<=Ce.currentRow.height&&(ie=Ce,xe=Ce.currentRow);for(let Ce=this._activePages.length-1;Ce>=0;Ce--)for(const Ae of this._activePages[Ce].fixedRows)Ae.height<=xe.height&&Re.size.y<=Ae.height&&(ie=this._activePages[Ce],xe=Ae);if(xe.y+Re.size.y>=ie.canvas.height||xe.height>Re.size.y+2){let Ce=!1;if(ie.currentRow.y+ie.currentRow.height+Re.size.y>=ie.canvas.height){let Ae;for(const Pe of this._activePages)if(Pe.currentRow.y+Pe.currentRow.height+Re.size.y<Pe.canvas.height){Ae=Pe;break}if(Ae)ie=Ae;else{const Pe=this._createNewPage();ie=Pe,xe=Pe.currentRow,xe.height=Re.size.y,Ce=!0}}Ce||(ie.currentRow.height>0&&ie.fixedRows.push(ie.currentRow),xe={x:0,y:ie.currentRow.y+ie.currentRow.height,height:Re.size.y},ie.fixedRows.push(xe),ie.currentRow={x:0,y:xe.y+xe.height,height:0})}if(xe.x+Re.size.x<=ie.canvas.width)break;xe===ie.currentRow?(xe.x=0,xe.y+=xe.height,xe.height=0):ie.fixedRows.splice(ie.fixedRows.indexOf(xe),1)}return Re.texturePage=this._pages.indexOf(ie),Re.texturePosition.x=xe.x,Re.texturePosition.y=xe.y,Re.texturePositionClipSpace.x=xe.x/ie.canvas.width,Re.texturePositionClipSpace.y=xe.y/ie.canvas.height,Re.sizeClipSpace.x/=ie.canvas.width,Re.sizeClipSpace.y/=ie.canvas.height,xe.height=Math.max(xe.height,Re.size.y),xe.x+=Re.size.x,ie.ctx.putImageData(fe,Re.texturePosition.x-this._workBoundingBox.left,Re.texturePosition.y-this._workBoundingBox.top,this._workBoundingBox.left,this._workBoundingBox.top,Re.size.x,Re.size.y),ie.addGlyph(Re),ie.version++,Re}_findGlyphBoundingBox(b,L,A,T,B,U){L.top=0;const D=T?this._config.deviceCellHeight:this._tmpCanvas.height,F=T?this._config.deviceCellWidth:A;let E=!1;for(let I=0;I<D;I++){for(let O=0;O<F;O++){const P=I*this._tmpCanvas.width*4+4*O+3;if(b.data[P]!==0){L.top=I,E=!0;break}}if(E)break}L.left=0,E=!1;for(let I=0;I<U+F;I++){for(let O=0;O<D;O++){const P=O*this._tmpCanvas.width*4+4*I+3;if(b.data[P]!==0){L.left=I,E=!0;break}}if(E)break}L.right=F,E=!1;for(let I=U+F-1;I>=U;I--){for(let O=0;O<D;O++){const P=O*this._tmpCanvas.width*4+4*I+3;if(b.data[P]!==0){L.right=I,E=!0;break}}if(E)break}L.bottom=D,E=!1;for(let I=D-1;I>=0;I--){for(let O=0;O<F;O++){const P=I*this._tmpCanvas.width*4+4*O+3;if(b.data[P]!==0){L.bottom=I,E=!0;break}}if(E)break}return{texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:L.right-L.left+1,y:L.bottom-L.top+1},sizeClipSpace:{x:L.right-L.left+1,y:L.bottom-L.top+1},offset:{x:-L.left+U+(T||B?Math.floor((this._config.deviceCellWidth-this._config.deviceCharWidth)/2):0),y:-L.top+U+(T||B?this._config.lineHeight===1?0:Math.round((this._config.deviceCellHeight-this._config.deviceCharHeight)/2):0)}}}}c.TextureAtlas=l;class p{constructor(b,L,A){if(this._usedPixels=0,this._glyphs=[],this.version=0,this.currentRow={x:0,y:0,height:0},this.fixedRows=[],A)for(const T of A)this._glyphs.push(...T.glyphs),this._usedPixels+=T._usedPixels;this.canvas=w(b,L,L),this.ctx=(0,_.throwIfFalsy)(this.canvas.getContext("2d",{alpha:!0}))}get percentageUsed(){return this._usedPixels/(this.canvas.width*this.canvas.height)}get glyphs(){return this._glyphs}addGlyph(b){this._glyphs.push(b),this._usedPixels+=b.size.x*b.size.y}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentRow.x=0,this.currentRow.y=0,this.currentRow.height=0,this.fixedRows.length=0,this.version++}}function g(v,b,L,A){const T=b.rgba>>>24,B=b.rgba>>>16&255,U=b.rgba>>>8&255,D=L.rgba>>>24,F=L.rgba>>>16&255,E=L.rgba>>>8&255,I=Math.floor((Math.abs(T-D)+Math.abs(B-F)+Math.abs(U-E))/12);let O=!0;for(let P=0;P<v.data.length;P+=4)v.data[P]===T&&v.data[P+1]===B&&v.data[P+2]===U||A&&Math.abs(v.data[P]-T)+Math.abs(v.data[P+1]-B)+Math.abs(v.data[P+2]-U)<I?v.data[P+3]=0:O=!1;return O}function w(v,b,L){const A=v.createElement("canvas");return A.width=b,A.height=L,A}},577:function(q,c,S){var m=this&&this.__decorate||function(h,s,r,l){var p,g=arguments.length,w=g<3?s:l===null?l=Object.getOwnPropertyDescriptor(s,r):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(h,s,r,l);else for(var v=h.length-1;v>=0;v--)(p=h[v])&&(w=(g<3?p(w):g>3?p(s,r,w):p(s,r))||w);return g>3&&w&&Object.defineProperty(s,r,w),w},f=this&&this.__param||function(h,s){return function(r,l){s(r,l,h)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CharacterJoinerService=c.JoinedCellData=void 0;const u=S(147),d=S(855),y=S(782),_=S(97);class o extends u.AttributeData{constructor(s,r,l){super(),this.content=0,this.combinedData="",this.fg=s.fg,this.bg=s.bg,this.combinedData=r,this._width=l}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(s){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.JoinedCellData=o;let t=class qr{constructor(s){this._bufferService=s,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new y.CellData}register(s){const r={id:this._nextCharacterJoinerId++,handler:s};return this._characterJoiners.push(r),r.id}deregister(s){for(let r=0;r<this._characterJoiners.length;r++)if(this._characterJoiners[r].id===s)return this._characterJoiners.splice(r,1),!0;return!1}getJoinedCharacters(s){if(this._characterJoiners.length===0)return[];const r=this._bufferService.buffer.lines.get(s);if(!r||r.length===0)return[];const l=[],p=r.translateToString(!0);let g=0,w=0,v=0,b=r.getFg(0),L=r.getBg(0);for(let A=0;A<r.getTrimmedLength();A++)if(r.loadCell(A,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==b||this._workCell.bg!==L){if(A-g>1){const T=this._getJoinedRanges(p,v,w,r,g);for(let B=0;B<T.length;B++)l.push(T[B])}g=A,v=w,b=this._workCell.fg,L=this._workCell.bg}w+=this._workCell.getChars().length||d.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-g>1){const A=this._getJoinedRanges(p,v,w,r,g);for(let T=0;T<A.length;T++)l.push(A[T])}return l}_getJoinedRanges(s,r,l,p,g){const w=s.substring(r,l);let v=[];try{v=this._characterJoiners[0].handler(w)}catch(b){console.error(b)}for(let b=1;b<this._characterJoiners.length;b++)try{const L=this._characterJoiners[b].handler(w);for(let A=0;A<L.length;A++)qr._mergeRanges(v,L[A])}catch(L){console.error(L)}return this._stringRangesToCellRanges(v,p,g),v}_stringRangesToCellRanges(s,r,l){let p=0,g=!1,w=0,v=s[p];if(v){for(let b=l;b<this._bufferService.cols;b++){const L=r.getWidth(b),A=r.getString(b).length||d.WHITESPACE_CELL_CHAR.length;if(L!==0){if(!g&&v[0]<=w&&(v[0]=b,g=!0),v[1]<=w){if(v[1]=b,v=s[++p],!v)break;v[0]<=w?(v[0]=b,g=!0):g=!1}w+=A}}v&&(v[1]=this._bufferService.cols)}}static _mergeRanges(s,r){let l=!1;for(let p=0;p<s.length;p++){const g=s[p];if(l){if(r[1]<=g[0])return s[p-1][1]=r[1],s;if(r[1]<=g[1])return s[p-1][1]=Math.max(r[1],g[1]),s.splice(p,1),s;s.splice(p,1),p--}else{if(r[1]<=g[0])return s.splice(p,0,r),s;if(r[1]<=g[1])return g[0]=Math.min(r[0],g[0]),s;r[0]<g[1]&&(g[0]=Math.min(r[0],g[0]),l=!0)}}return l?s[s.length-1][1]=r[1]:s.push(r),s}};t=m([f(0,_.IBufferService)],t),c.CharacterJoinerService=t},160:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.contrastRatio=c.toPaddedHex=c.rgba=c.rgb=c.css=c.color=c.channels=c.NULL_COLOR=void 0;const m=S(399);let f=0,u=0,d=0,y=0;var _,o,t;function h(r){const l=r.toString(16);return l.length<2?"0"+l:l}function s(r,l){return r<l?(l+.05)/(r+.05):(r+.05)/(l+.05)}c.NULL_COLOR={css:"#00000000",rgba:0},function(r){r.toCss=function(l,p,g,w){return w!==void 0?`#${h(l)}${h(p)}${h(g)}${h(w)}`:`#${h(l)}${h(p)}${h(g)}`},r.toRgba=function(l,p,g,w=255){return(l<<24|p<<16|g<<8|w)>>>0}}(_=c.channels||(c.channels={})),function(r){function l(p,g){return y=Math.round(255*g),[f,u,d]=t.toChannels(p.rgba),{css:_.toCss(f,u,d,y),rgba:_.toRgba(f,u,d,y)}}r.blend=function(p,g){if(y=(255&g.rgba)/255,y===1)return{css:g.css,rgba:g.rgba};const w=g.rgba>>24&255,v=g.rgba>>16&255,b=g.rgba>>8&255,L=p.rgba>>24&255,A=p.rgba>>16&255,T=p.rgba>>8&255;return f=L+Math.round((w-L)*y),u=A+Math.round((v-A)*y),d=T+Math.round((b-T)*y),{css:_.toCss(f,u,d),rgba:_.toRgba(f,u,d)}},r.isOpaque=function(p){return(255&p.rgba)==255},r.ensureContrastRatio=function(p,g,w){const v=t.ensureContrastRatio(p.rgba,g.rgba,w);if(v)return t.toColor(v>>24&255,v>>16&255,v>>8&255)},r.opaque=function(p){const g=(255|p.rgba)>>>0;return[f,u,d]=t.toChannels(g),{css:_.toCss(f,u,d),rgba:g}},r.opacity=l,r.multiplyOpacity=function(p,g){return y=255&p.rgba,l(p,y*g/255)},r.toColorRGB=function(p){return[p.rgba>>24&255,p.rgba>>16&255,p.rgba>>8&255]}}(c.color||(c.color={})),function(r){let l,p;if(!m.isNode){const g=document.createElement("canvas");g.width=1,g.height=1;const w=g.getContext("2d",{willReadFrequently:!0});w&&(l=w,l.globalCompositeOperation="copy",p=l.createLinearGradient(0,0,1,1))}r.toColor=function(g){if(g.match(/#[\da-f]{3,8}/i))switch(g.length){case 4:return f=parseInt(g.slice(1,2).repeat(2),16),u=parseInt(g.slice(2,3).repeat(2),16),d=parseInt(g.slice(3,4).repeat(2),16),t.toColor(f,u,d);case 5:return f=parseInt(g.slice(1,2).repeat(2),16),u=parseInt(g.slice(2,3).repeat(2),16),d=parseInt(g.slice(3,4).repeat(2),16),y=parseInt(g.slice(4,5).repeat(2),16),t.toColor(f,u,d,y);case 7:return{css:g,rgba:(parseInt(g.slice(1),16)<<8|255)>>>0};case 9:return{css:g,rgba:parseInt(g.slice(1),16)>>>0}}const w=g.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(w)return f=parseInt(w[1]),u=parseInt(w[2]),d=parseInt(w[3]),y=Math.round(255*(w[5]===void 0?1:parseFloat(w[5]))),t.toColor(f,u,d,y);if(!l||!p)throw new Error("css.toColor: Unsupported css format");if(l.fillStyle=p,l.fillStyle=g,typeof l.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(l.fillRect(0,0,1,1),[f,u,d,y]=l.getImageData(0,0,1,1).data,y!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:_.toRgba(f,u,d,y),css:g}}}(c.css||(c.css={})),function(r){function l(p,g,w){const v=p/255,b=g/255,L=w/255;return .2126*(v<=.03928?v/12.92:Math.pow((v+.055)/1.055,2.4))+.7152*(b<=.03928?b/12.92:Math.pow((b+.055)/1.055,2.4))+.0722*(L<=.03928?L/12.92:Math.pow((L+.055)/1.055,2.4))}r.relativeLuminance=function(p){return l(p>>16&255,p>>8&255,255&p)},r.relativeLuminance2=l}(o=c.rgb||(c.rgb={})),function(r){function l(g,w,v){const b=g>>24&255,L=g>>16&255,A=g>>8&255;let T=w>>24&255,B=w>>16&255,U=w>>8&255,D=s(o.relativeLuminance2(T,B,U),o.relativeLuminance2(b,L,A));for(;D<v&&(T>0||B>0||U>0);)T-=Math.max(0,Math.ceil(.1*T)),B-=Math.max(0,Math.ceil(.1*B)),U-=Math.max(0,Math.ceil(.1*U)),D=s(o.relativeLuminance2(T,B,U),o.relativeLuminance2(b,L,A));return(T<<24|B<<16|U<<8|255)>>>0}function p(g,w,v){const b=g>>24&255,L=g>>16&255,A=g>>8&255;let T=w>>24&255,B=w>>16&255,U=w>>8&255,D=s(o.relativeLuminance2(T,B,U),o.relativeLuminance2(b,L,A));for(;D<v&&(T<255||B<255||U<255);)T=Math.min(255,T+Math.ceil(.1*(255-T))),B=Math.min(255,B+Math.ceil(.1*(255-B))),U=Math.min(255,U+Math.ceil(.1*(255-U))),D=s(o.relativeLuminance2(T,B,U),o.relativeLuminance2(b,L,A));return(T<<24|B<<16|U<<8|255)>>>0}r.ensureContrastRatio=function(g,w,v){const b=o.relativeLuminance(g>>8),L=o.relativeLuminance(w>>8);if(s(b,L)<v){if(L<b){const B=l(g,w,v),U=s(b,o.relativeLuminance(B>>8));if(U<v){const D=p(g,w,v);return U>s(b,o.relativeLuminance(D>>8))?B:D}return B}const A=p(g,w,v),T=s(b,o.relativeLuminance(A>>8));if(T<v){const B=l(g,w,v);return T>s(b,o.relativeLuminance(B>>8))?A:B}return A}},r.reduceLuminance=l,r.increaseLuminance=p,r.toChannels=function(g){return[g>>24&255,g>>16&255,g>>8&255,255&g]},r.toColor=function(g,w,v,b){return{css:_.toCss(g,w,v,b),rgba:_.toRgba(g,w,v,b)}}}(t=c.rgba||(c.rgba={})),c.toPaddedHex=h,c.contrastRatio=s},345:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.forwardEvent=c.EventEmitter=void 0,c.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=S=>(this._listeners.push(S),{dispose:()=>{if(!this._disposed){for(let m=0;m<this._listeners.length;m++)if(this._listeners[m]===S)return void this._listeners.splice(m,1)}}})),this._event}fire(S,m){const f=[];for(let u=0;u<this._listeners.length;u++)f.push(this._listeners[u]);for(let u=0;u<f.length;u++)f[u].call(void 0,S,m)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},c.forwardEvent=function(S,m){return S(f=>m.fire(f))}},859:(q,c)=>{function S(m){for(const f of m)f.dispose();m.length=0}Object.defineProperty(c,"__esModule",{value:!0}),c.getDisposeArrayDisposable=c.disposeArray=c.toDisposable=c.Disposable=void 0,c.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const m of this._disposables)m.dispose();this._disposables.length=0}register(m){return this._disposables.push(m),m}unregister(m){const f=this._disposables.indexOf(m);f!==-1&&this._disposables.splice(f,1)}},c.toDisposable=function(m){return{dispose:m}},c.disposeArray=S,c.getDisposeArrayDisposable=function(m){return{dispose:()=>S(m)}}},485:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.FourKeyMap=c.TwoKeyMap=void 0;class S{constructor(){this._data={}}set(f,u,d){this._data[f]||(this._data[f]={}),this._data[f][u]=d}get(f,u){return this._data[f]?this._data[f][u]:void 0}clear(){this._data={}}}c.TwoKeyMap=S,c.FourKeyMap=class{constructor(){this._data=new S}set(m,f,u,d,y){this._data.get(m,f)||this._data.set(m,f,new S),this._data.get(m,f).set(u,d,y)}get(m,f,u,d){var y;return(y=this._data.get(m,f))===null||y===void 0?void 0:y.get(u,d)}clear(){this._data.clear()}}},399:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.isChromeOS=c.isLinux=c.isWindows=c.isIphone=c.isIpad=c.isMac=c.getSafariVersion=c.isSafari=c.isLegacyEdge=c.isFirefox=c.isNode=void 0,c.isNode=typeof navigator>"u";const S=c.isNode?"node":navigator.userAgent,m=c.isNode?"node":navigator.platform;c.isFirefox=S.includes("Firefox"),c.isLegacyEdge=S.includes("Edge"),c.isSafari=/^((?!chrome|android).)*safari/i.test(S),c.getSafariVersion=function(){if(!c.isSafari)return 0;const f=S.match(/Version\/(\d+)/);return f===null||f.length<2?0:parseInt(f[1])},c.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(m),c.isIpad=m==="iPad",c.isIphone=m==="iPhone",c.isWindows=["Windows","Win16","Win32","WinCE"].includes(m),c.isLinux=m.indexOf("Linux")>=0,c.isChromeOS=/\bCrOS\b/.test(S)},385:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DebouncedIdleTask=c.IdleTaskQueue=c.PriorityTaskQueue=void 0;const m=S(399);class f{constructor(){this._tasks=[],this._i=0}enqueue(y){this._tasks.push(y),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(y){this._idleCallback=void 0;let _=0,o=0,t=y.timeRemaining(),h=0;for(;this._i<this._tasks.length;){if(_=Date.now(),this._tasks[this._i]()||this._i++,_=Math.max(1,Date.now()-_),o=Math.max(_,o),h=y.timeRemaining(),1.5*o>h)return t-_<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(t-_))}ms`),void this._start();t=h}this.clear()}}class u extends f{_requestCallback(y){return setTimeout(()=>y(this._createDeadline(16)))}_cancelCallback(y){clearTimeout(y)}_createDeadline(y){const _=Date.now()+y;return{timeRemaining:()=>Math.max(0,_-Date.now())}}}c.PriorityTaskQueue=u,c.IdleTaskQueue=!m.isNode&&"requestIdleCallback"in window?class extends f{_requestCallback(d){return requestIdleCallback(d)}_cancelCallback(d){cancelIdleCallback(d)}}:u,c.DebouncedIdleTask=class{constructor(){this._queue=new c.IdleTaskQueue}set(d){this._queue.clear(),this._queue.enqueue(d)}flush(){this._queue.flush()}}},147:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ExtendedAttrs=c.AttributeData=void 0;class S{constructor(){this.fg=0,this.bg=0,this.extended=new m}static toColorRGB(u){return[u>>>16&255,u>>>8&255,255&u]}static fromColorRGB(u){return(255&u[0])<<16|(255&u[1])<<8|255&u[2]}clone(){const u=new S;return u.fg=this.fg,u.bg=this.bg,u.extended=this.extended.clone(),u}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}c.AttributeData=S;class m{constructor(u=0,d=0){this._ext=0,this._urlId=0,this._ext=u,this._urlId=d}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(u){this._ext=u}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(u){this._ext&=-469762049,this._ext|=u<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(u){this._ext&=-67108864,this._ext|=67108863&u}get urlId(){return this._urlId}set urlId(u){this._urlId=u}clone(){return new m(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}c.ExtendedAttrs=m},782:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CellData=void 0;const m=S(133),f=S(855),u=S(147);class d extends u.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new u.ExtendedAttrs,this.combinedData=""}static fromCharData(_){const o=new d;return o.setFromCharData(_),o}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,m.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(_){this.fg=_[f.CHAR_DATA_ATTR_INDEX],this.bg=0;let o=!1;if(_[f.CHAR_DATA_CHAR_INDEX].length>2)o=!0;else if(_[f.CHAR_DATA_CHAR_INDEX].length===2){const t=_[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=t&&t<=56319){const h=_[f.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=h&&h<=57343?this.content=1024*(t-55296)+h-56320+65536|_[f.CHAR_DATA_WIDTH_INDEX]<<22:o=!0}else o=!0}else this.content=_[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|_[f.CHAR_DATA_WIDTH_INDEX]<<22;o&&(this.combinedData=_[f.CHAR_DATA_CHAR_INDEX],this.content=2097152|_[f.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.CellData=d},855:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.WHITESPACE_CELL_CODE=c.WHITESPACE_CELL_WIDTH=c.WHITESPACE_CELL_CHAR=c.NULL_CELL_CODE=c.NULL_CELL_WIDTH=c.NULL_CELL_CHAR=c.CHAR_DATA_CODE_INDEX=c.CHAR_DATA_WIDTH_INDEX=c.CHAR_DATA_CHAR_INDEX=c.CHAR_DATA_ATTR_INDEX=c.DEFAULT_EXT=c.DEFAULT_ATTR=c.DEFAULT_COLOR=void 0,c.DEFAULT_COLOR=0,c.DEFAULT_ATTR=256|c.DEFAULT_COLOR<<9,c.DEFAULT_EXT=0,c.CHAR_DATA_ATTR_INDEX=0,c.CHAR_DATA_CHAR_INDEX=1,c.CHAR_DATA_WIDTH_INDEX=2,c.CHAR_DATA_CODE_INDEX=3,c.NULL_CELL_CHAR="",c.NULL_CELL_WIDTH=1,c.NULL_CELL_CODE=0,c.WHITESPACE_CELL_CHAR=" ",c.WHITESPACE_CELL_WIDTH=1,c.WHITESPACE_CELL_CODE=32},133:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Utf8ToUtf32=c.StringToUtf32=c.utf32ToString=c.stringFromCodePoint=void 0,c.stringFromCodePoint=function(S){return S>65535?(S-=65536,String.fromCharCode(55296+(S>>10))+String.fromCharCode(S%1024+56320)):String.fromCharCode(S)},c.utf32ToString=function(S,m=0,f=S.length){let u="";for(let d=m;d<f;++d){let y=S[d];y>65535?(y-=65536,u+=String.fromCharCode(55296+(y>>10))+String.fromCharCode(y%1024+56320)):u+=String.fromCharCode(y)}return u},c.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(S,m){const f=S.length;if(!f)return 0;let u=0,d=0;if(this._interim){const y=S.charCodeAt(d++);56320<=y&&y<=57343?m[u++]=1024*(this._interim-55296)+y-56320+65536:(m[u++]=this._interim,m[u++]=y),this._interim=0}for(let y=d;y<f;++y){const _=S.charCodeAt(y);if(55296<=_&&_<=56319){if(++y>=f)return this._interim=_,u;const o=S.charCodeAt(y);56320<=o&&o<=57343?m[u++]=1024*(_-55296)+o-56320+65536:(m[u++]=_,m[u++]=o)}else _!==65279&&(m[u++]=_)}return u}},c.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(S,m){const f=S.length;if(!f)return 0;let u,d,y,_,o=0,t=0,h=0;if(this.interim[0]){let l=!1,p=this.interim[0];p&=(224&p)==192?31:(240&p)==224?15:7;let g,w=0;for(;(g=63&this.interim[++w])&&w<4;)p<<=6,p|=g;const v=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,b=v-w;for(;h<b;){if(h>=f)return 0;if(g=S[h++],(192&g)!=128){h--,l=!0;break}this.interim[w++]=g,p<<=6,p|=63&g}l||(v===2?p<128?h--:m[o++]=p:v===3?p<2048||p>=55296&&p<=57343||p===65279||(m[o++]=p):p<65536||p>1114111||(m[o++]=p)),this.interim.fill(0)}const s=f-4;let r=h;for(;r<f;){for(;!(!(r<s)||128&(u=S[r])||128&(d=S[r+1])||128&(y=S[r+2])||128&(_=S[r+3]));)m[o++]=u,m[o++]=d,m[o++]=y,m[o++]=_,r+=4;if(u=S[r++],u<128)m[o++]=u;else if((224&u)==192){if(r>=f)return this.interim[0]=u,o;if(d=S[r++],(192&d)!=128){r--;continue}if(t=(31&u)<<6|63&d,t<128){r--;continue}m[o++]=t}else if((240&u)==224){if(r>=f)return this.interim[0]=u,o;if(d=S[r++],(192&d)!=128){r--;continue}if(r>=f)return this.interim[0]=u,this.interim[1]=d,o;if(y=S[r++],(192&y)!=128){r--;continue}if(t=(15&u)<<12|(63&d)<<6|63&y,t<2048||t>=55296&&t<=57343||t===65279)continue;m[o++]=t}else if((248&u)==240){if(r>=f)return this.interim[0]=u,o;if(d=S[r++],(192&d)!=128){r--;continue}if(r>=f)return this.interim[0]=u,this.interim[1]=d,o;if(y=S[r++],(192&y)!=128){r--;continue}if(r>=f)return this.interim[0]=u,this.interim[1]=d,this.interim[2]=y,o;if(_=S[r++],(192&_)!=128){r--;continue}if(t=(7&u)<<18|(63&d)<<12|(63&y)<<6|63&_,t<65536||t>1114111)continue;m[o++]=t}}return o}}},726:(q,c)=>{function S(m,f,u){f.di$target===f?f.di$dependencies.push({id:m,index:u}):(f.di$dependencies=[{id:m,index:u}],f.di$target=f)}Object.defineProperty(c,"__esModule",{value:!0}),c.createDecorator=c.getServiceDependencies=c.serviceRegistry=void 0,c.serviceRegistry=new Map,c.getServiceDependencies=function(m){return m.di$dependencies||[]},c.createDecorator=function(m){if(c.serviceRegistry.has(m))return c.serviceRegistry.get(m);const f=function(u,d,y){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");S(f,u,y)};return f.toString=()=>m,c.serviceRegistry.set(m,f),f}},97:(q,c,S)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.IDecorationService=c.IUnicodeService=c.IOscLinkService=c.IOptionsService=c.ILogService=c.LogLevelEnum=c.IInstantiationService=c.ICharsetService=c.ICoreService=c.ICoreMouseService=c.IBufferService=void 0;const m=S(726);var f;c.IBufferService=(0,m.createDecorator)("BufferService"),c.ICoreMouseService=(0,m.createDecorator)("CoreMouseService"),c.ICoreService=(0,m.createDecorator)("CoreService"),c.ICharsetService=(0,m.createDecorator)("CharsetService"),c.IInstantiationService=(0,m.createDecorator)("InstantiationService"),(f=c.LogLevelEnum||(c.LogLevelEnum={}))[f.DEBUG=0]="DEBUG",f[f.INFO=1]="INFO",f[f.WARN=2]="WARN",f[f.ERROR=3]="ERROR",f[f.OFF=4]="OFF",c.ILogService=(0,m.createDecorator)("LogService"),c.IOptionsService=(0,m.createDecorator)("OptionsService"),c.IOscLinkService=(0,m.createDecorator)("OscLinkService"),c.IUnicodeService=(0,m.createDecorator)("UnicodeService"),c.IDecorationService=(0,m.createDecorator)("DecorationService")}},se={};function pe(q){var c=se[q];if(c!==void 0)return c.exports;var S=se[q]={exports:{}};return ee[q].call(S.exports,S,S.exports,pe),S.exports}var he={};return(()=>{var q=he;Object.defineProperty(q,"__esModule",{value:!0}),q.CanvasAddon=void 0;const c=pe(949),S=pe(345),m=pe(859);class f extends m.Disposable{constructor(){super(...arguments),this._onChangeTextureAtlas=this.register(new S.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new S.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event}get textureAtlas(){var d;return(d=this._renderer)===null||d===void 0?void 0:d.textureAtlas}activate(d){const y=d._core;if(!d.element)return void this.register(y.onWillOpen(()=>this.activate(d)));this._terminal=d;const _=y.coreService,o=y.optionsService,t=y.screenElement,h=y.linkifier2,s=y,r=s._bufferService,l=s._renderService,p=s._characterJoinerService,g=s._charSizeService,w=s._coreBrowserService,v=s._decorationService,b=s._themeService;this._renderer=new c.CanvasRenderer(d,t,h,r,g,o,p,_,w,v,b),this.register((0,S.forwardEvent)(this._renderer.onChangeTextureAtlas,this._onChangeTextureAtlas)),this.register((0,S.forwardEvent)(this._renderer.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas)),l.setRenderer(this._renderer),l.handleResize(r.cols,r.rows),this.register((0,m.toDisposable)(()=>{var L;l.setRenderer(this._terminal._core._createRenderer()),l.handleResize(d.cols,d.rows),(L=this._renderer)===null||L===void 0||L.dispose(),this._renderer=void 0}))}}q.CanvasAddon=f})(),he})()})})($r);var an=$r.exports,Vr={exports:{}};(function(K,H){(function(ee,se){K.exports=se()})(self,function(){return(()=>{var ee={};return(()=>{var se=ee;Object.defineProperty(se,"__esModule",{value:!0}),se.FitAddon=void 0,se.FitAddon=class{constructor(){}activate(pe){this._terminal=pe}dispose(){}fit(){const pe=this.proposeDimensions();if(!pe||!this._terminal||isNaN(pe.cols)||isNaN(pe.rows))return;const he=this._terminal._core;this._terminal.rows===pe.rows&&this._terminal.cols===pe.cols||(he._renderService.clear(),this._terminal.resize(pe.cols,pe.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const pe=this._terminal._core,he=pe._renderService.dimensions;if(he.css.cell.width===0||he.css.cell.height===0)return;const q=this._terminal.options.scrollback===0?0:pe.viewport.scrollBarWidth,c=window.getComputedStyle(this._terminal.element.parentElement),S=parseInt(c.getPropertyValue("height")),m=Math.max(0,parseInt(c.getPropertyValue("width"))),f=window.getComputedStyle(this._terminal.element),u=S-(parseInt(f.getPropertyValue("padding-top"))+parseInt(f.getPropertyValue("padding-bottom"))),d=m-(parseInt(f.getPropertyValue("padding-right"))+parseInt(f.getPropertyValue("padding-left")))-q;return{cols:Math.max(2,Math.floor(d/he.css.cell.width)),rows:Math.max(1,Math.floor(u/he.css.cell.height))}}}})(),ee})()})})(Vr);var ln=Vr.exports,vi={exports:{}};const cn={},hn=Object.freeze(Object.defineProperty({__proto__:null,default:cn},Symbol.toStringTag,{value:"Module"})),Vt=tn(hn);var Kt={},Xt={},Yt,Sr;function Kr(){return Sr||(Sr=1,Yt=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var H={},ee=Symbol("test"),se=Object(ee);if(typeof ee=="string"||Object.prototype.toString.call(ee)!=="[object Symbol]"||Object.prototype.toString.call(se)!=="[object Symbol]")return!1;var pe=42;H[ee]=pe;for(ee in H)return!1;if(typeof Object.keys=="function"&&Object.keys(H).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(H).length!==0)return!1;var he=Object.getOwnPropertySymbols(H);if(he.length!==1||he[0]!==ee||!Object.prototype.propertyIsEnumerable.call(H,ee))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var q=Object.getOwnPropertyDescriptor(H,ee);if(q.value!==pe||q.enumerable!==!0)return!1}return!0}),Yt}var Zt,br;function Pt(){if(br)return Zt;br=1;var K=Kr();return Zt=function(){return K()&&!!Symbol.toStringTag},Zt}var Jt,Cr;function un(){if(Cr)return Jt;Cr=1;var K=typeof Symbol<"u"&&Symbol,H=Kr();return Jt=function(){return typeof K!="function"||typeof Symbol!="function"||typeof K("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:H()},Jt}var Qt,wr;function dn(){if(wr)return Qt;wr=1;var K={foo:{}},H=Object;return Qt=function(){return{__proto__:K}.foo===K.foo&&!({__proto__:null}instanceof H)},Qt}var ei,xr;function fn(){if(xr)return ei;xr=1;var K="Function.prototype.bind called on incompatible ",H=Array.prototype.slice,ee=Object.prototype.toString,se="[object Function]";return ei=function(he){var q=this;if(typeof q!="function"||ee.call(q)!==se)throw new TypeError(K+q);for(var c=H.call(arguments,1),S,m=function(){if(this instanceof S){var _=q.apply(this,c.concat(H.call(arguments)));return Object(_)===_?_:this}else return q.apply(he,c.concat(H.call(arguments)))},f=Math.max(0,q.length-c.length),u=[],d=0;d<f;d++)u.push("$"+d);if(S=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this,arguments); }")(m),q.prototype){var y=function(){};y.prototype=q.prototype,S.prototype=new y,y.prototype=null}return S},ei}var ti,Lr;function Si(){if(Lr)return ti;Lr=1;var K=fn();return ti=Function.prototype.bind||K,ti}var ii,Er;function pn(){if(Er)return ii;Er=1;var K=Si();return ii=K.call(Function.call,Object.prototype.hasOwnProperty),ii}var ri,kr;function bi(){if(kr)return ri;kr=1;var K,H=SyntaxError,ee=Function,se=TypeError,pe=function(T){try{return ee('"use strict"; return ('+T+").constructor;")()}catch{}},he=Object.getOwnPropertyDescriptor;if(he)try{he({},"")}catch{he=null}var q=function(){throw new se},c=he?function(){try{return arguments.callee,q}catch{try{return he(arguments,"callee").get}catch{return q}}}():q,S=un()(),m=dn()(),f=Object.getPrototypeOf||(m?function(T){return T.__proto__}:null),u={},d=typeof Uint8Array>"u"||!f?K:f(Uint8Array),y={"%AggregateError%":typeof AggregateError>"u"?K:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?K:ArrayBuffer,"%ArrayIteratorPrototype%":S&&f?f([][Symbol.iterator]()):K,"%AsyncFromSyncIteratorPrototype%":K,"%AsyncFunction%":u,"%AsyncGenerator%":u,"%AsyncGeneratorFunction%":u,"%AsyncIteratorPrototype%":u,"%Atomics%":typeof Atomics>"u"?K:Atomics,"%BigInt%":typeof BigInt>"u"?K:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?K:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?K:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?K:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?K:Float32Array,"%Float64Array%":typeof Float64Array>"u"?K:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?K:FinalizationRegistry,"%Function%":ee,"%GeneratorFunction%":u,"%Int8Array%":typeof Int8Array>"u"?K:Int8Array,"%Int16Array%":typeof Int16Array>"u"?K:Int16Array,"%Int32Array%":typeof Int32Array>"u"?K:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":S&&f?f(f([][Symbol.iterator]())):K,"%JSON%":typeof JSON=="object"?JSON:K,"%Map%":typeof Map>"u"?K:Map,"%MapIteratorPrototype%":typeof Map>"u"||!S||!f?K:f(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?K:Promise,"%Proxy%":typeof Proxy>"u"?K:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?K:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?K:Set,"%SetIteratorPrototype%":typeof Set>"u"||!S||!f?K:f(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?K:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":S&&f?f(""[Symbol.iterator]()):K,"%Symbol%":S?Symbol:K,"%SyntaxError%":H,"%ThrowTypeError%":c,"%TypedArray%":d,"%TypeError%":se,"%Uint8Array%":typeof Uint8Array>"u"?K:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?K:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?K:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?K:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?K:WeakMap,"%WeakRef%":typeof WeakRef>"u"?K:WeakRef,"%WeakSet%":typeof WeakSet>"u"?K:WeakSet};if(f)try{null.error}catch(T){var _=f(f(T));y["%Error.prototype%"]=_}var o=function T(B){var U;if(B==="%AsyncFunction%")U=pe("async function () {}");else if(B==="%GeneratorFunction%")U=pe("function* () {}");else if(B==="%AsyncGeneratorFunction%")U=pe("async function* () {}");else if(B==="%AsyncGenerator%"){var D=T("%AsyncGeneratorFunction%");D&&(U=D.prototype)}else if(B==="%AsyncIteratorPrototype%"){var F=T("%AsyncGenerator%");F&&f&&(U=f(F.prototype))}return y[B]=U,U},t={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},h=Si(),s=pn(),r=h.call(Function.call,Array.prototype.concat),l=h.call(Function.apply,Array.prototype.splice),p=h.call(Function.call,String.prototype.replace),g=h.call(Function.call,String.prototype.slice),w=h.call(Function.call,RegExp.prototype.exec),v=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,b=/\\(\\)?/g,L=function(B){var U=g(B,0,1),D=g(B,-1);if(U==="%"&&D!=="%")throw new H("invalid intrinsic syntax, expected closing `%`");if(D==="%"&&U!=="%")throw new H("invalid intrinsic syntax, expected opening `%`");var F=[];return p(B,v,function(E,I,O,P){F[F.length]=O?p(P,b,"$1"):I||E}),F},A=function(B,U){var D=B,F;if(s(t,D)&&(F=t[D],D="%"+F[0]+"%"),s(y,D)){var E=y[D];if(E===u&&(E=o(D)),typeof E>"u"&&!U)throw new se("intrinsic "+B+" exists, but is not available. Please file an issue!");return{alias:F,name:D,value:E}}throw new H("intrinsic "+B+" does not exist!")};return ri=function(B,U){if(typeof B!="string"||B.length===0)throw new se("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof U!="boolean")throw new se('"allowMissing" argument must be a boolean');if(w(/^%?[^%]*%?$/,B)===null)throw new H("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var D=L(B),F=D.length>0?D[0]:"",E=A("%"+F+"%",U),I=E.name,O=E.value,P=!1,J=E.alias;J&&(F=J[0],l(D,r([0,1],J)));for(var j=1,X=!0;j<D.length;j+=1){var V=D[j],re=g(V,0,1),G=g(V,-1);if((re==='"'||re==="'"||re==="`"||G==='"'||G==="'"||G==="`")&&re!==G)throw new H("property names with quotes must have matching quotes");if((V==="constructor"||!X)&&(P=!0),F+="."+V,I="%"+F+"%",s(y,I))O=y[I];else if(O!=null){if(!(V in O)){if(!U)throw new se("base intrinsic for "+B+" exists, but the property is not available.");return}if(he&&j+1>=D.length){var z=he(O,V);X=!!z,X&&"get"in z&&!("originalValue"in z.get)?O=z.get:O=O[V]}else X=s(O,V),O=O[V];X&&!P&&(y[I]=O)}}return O},ri}var si={exports:{}},Rr;function _n(){return Rr||(Rr=1,function(K){var H=Si(),ee=bi(),se=ee("%Function.prototype.apply%"),pe=ee("%Function.prototype.call%"),he=ee("%Reflect.apply%",!0)||H.call(pe,se),q=ee("%Object.getOwnPropertyDescriptor%",!0),c=ee("%Object.defineProperty%",!0),S=ee("%Math.max%");if(c)try{c({},"a",{value:1})}catch{c=null}K.exports=function(u){var d=he(H,pe,arguments);if(q&&c){var y=q(d,"length");y.configurable&&c(d,"length",{value:1+S(0,u.length-(arguments.length-1))})}return d};var m=function(){return he(H,se,arguments)};c?c(K.exports,"apply",{value:m}):K.exports.apply=m}(si)),si.exports}var ni,Ar;function Ci(){if(Ar)return ni;Ar=1;var K=bi(),H=_n(),ee=H(K("String.prototype.indexOf"));return ni=function(pe,he){var q=K(pe,!!he);return typeof q=="function"&&ee(pe,".prototype.")>-1?H(q):q},ni}var oi,Tr;function gn(){if(Tr)return oi;Tr=1;var K=Pt()(),H=Ci(),ee=H("Object.prototype.toString"),se=function(c){return K&&c&&typeof c=="object"&&Symbol.toStringTag in c?!1:ee(c)==="[object Arguments]"},pe=function(c){return se(c)?!0:c!==null&&typeof c=="object"&&typeof c.length=="number"&&c.length>=0&&ee(c)!=="[object Array]"&&ee(c.callee)==="[object Function]"},he=function(){return se(arguments)}();return se.isLegacyArguments=pe,oi=he?se:pe,oi}var ai,Dr;function vn(){if(Dr)return ai;Dr=1;var K=Object.prototype.toString,H=Function.prototype.toString,ee=/^\s*(?:function)?\*/,se=Pt()(),pe=Object.getPrototypeOf,he=function(){if(!se)return!1;try{return Function("return function*() {}")()}catch{}},q;return ai=function(S){if(typeof S!="function")return!1;if(ee.test(H.call(S)))return!0;if(!se){var m=K.call(S);return m==="[object GeneratorFunction]"}if(!pe)return!1;if(typeof q>"u"){var f=he();q=f?pe(f):!1}return pe(S)===q},ai}var li,Mr;function mn(){if(Mr)return li;Mr=1;var K=Function.prototype.toString,H=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,ee,se;if(typeof H=="function"&&typeof Object.defineProperty=="function")try{ee=Object.defineProperty({},"length",{get:function(){throw se}}),se={},H(function(){throw 42},null,ee)}catch(s){s!==se&&(H=null)}else H=null;var pe=/^\s*class\b/,he=function(r){try{var l=K.call(r);return pe.test(l)}catch{return!1}},q=function(r){try{return he(r)?!1:(K.call(r),!0)}catch{return!1}},c=Object.prototype.toString,S="[object Object]",m="[object Function]",f="[object GeneratorFunction]",u="[object HTMLAllCollection]",d="[object HTML document.all class]",y="[object HTMLCollection]",_=typeof Symbol=="function"&&!!Symbol.toStringTag,o=!(0 in[,]),t=function(){return!1};if(typeof document=="object"){var h=document.all;c.call(h)===c.call(document.all)&&(t=function(r){if((o||!r)&&(typeof r>"u"||typeof r=="object"))try{var l=c.call(r);return(l===u||l===d||l===y||l===S)&&r("")==null}catch{}return!1})}return li=H?function(r){if(t(r))return!0;if(!r||typeof r!="function"&&typeof r!="object")return!1;try{H(r,null,ee)}catch(l){if(l!==se)return!1}return!he(r)&&q(r)}:function(r){if(t(r))return!0;if(!r||typeof r!="function"&&typeof r!="object")return!1;if(_)return q(r);if(he(r))return!1;var l=c.call(r);return l!==m&&l!==f&&!/^\[object HTML/.test(l)?!1:q(r)},li}var ci,Br;function Xr(){if(Br)return ci;Br=1;var K=mn(),H=Object.prototype.toString,ee=Object.prototype.hasOwnProperty,se=function(S,m,f){for(var u=0,d=S.length;u<d;u++)ee.call(S,u)&&(f==null?m(S[u],u,S):m.call(f,S[u],u,S))},pe=function(S,m,f){for(var u=0,d=S.length;u<d;u++)f==null?m(S.charAt(u),u,S):m.call(f,S.charAt(u),u,S)},he=function(S,m,f){for(var u in S)ee.call(S,u)&&(f==null?m(S[u],u,S):m.call(f,S[u],u,S))},q=function(S,m,f){if(!K(m))throw new TypeError("iterator must be a function");var u;arguments.length>=3&&(u=f),H.call(S)==="[object Array]"?se(S,m,u):typeof S=="string"?pe(S,m,u):he(S,m,u)};return ci=q,ci}var hi,Or;function Yr(){if(Or)return hi;Or=1;var K=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],H=typeof globalThis>"u"?mi:globalThis;return hi=function(){for(var se=[],pe=0;pe<K.length;pe++)typeof H[K[pe]]=="function"&&(se[se.length]=K[pe]);return se},hi}var ui,Ir;function Zr(){if(Ir)return ui;Ir=1;var K=bi(),H=K("%Object.getOwnPropertyDescriptor%",!0);if(H)try{H([],"length")}catch{H=null}return ui=H,ui}var di,Pr;function Jr(){if(Pr)return di;Pr=1;var K=Xr(),H=Yr(),ee=Ci(),se=ee("Object.prototype.toString"),pe=Pt()(),he=Zr(),q=typeof globalThis>"u"?mi:globalThis,c=H(),S=ee("Array.prototype.indexOf",!0)||function(_,o){for(var t=0;t<_.length;t+=1)if(_[t]===o)return t;return-1},m=ee("String.prototype.slice"),f={},u=Object.getPrototypeOf;pe&&he&&u&&K(c,function(y){var _=new q[y];if(Symbol.toStringTag in _){var o=u(_),t=he(o,Symbol.toStringTag);if(!t){var h=u(o);t=he(h,Symbol.toStringTag)}f[y]=t.get}});var d=function(_){var o=!1;return K(f,function(t,h){if(!o)try{o=t.call(_)===h}catch{}}),o};return di=function(_){if(!_||typeof _!="object")return!1;if(!pe||!(Symbol.toStringTag in _)){var o=m(se(_),8,-1);return S(c,o)>-1}return he?d(_):!1},di}var fi,Ur;function yn(){if(Ur)return fi;Ur=1;var K=Xr(),H=Yr(),ee=Ci(),se=Zr(),pe=ee("Object.prototype.toString"),he=Pt()(),q=typeof globalThis>"u"?mi:globalThis,c=H(),S=ee("String.prototype.slice"),m={},f=Object.getPrototypeOf;he&&se&&f&&K(c,function(y){if(typeof q[y]=="function"){var _=new q[y];if(Symbol.toStringTag in _){var o=f(_),t=se(o,Symbol.toStringTag);if(!t){var h=f(o);t=se(h,Symbol.toStringTag)}m[y]=t.get}}});var u=function(_){var o=!1;return K(m,function(t,h){if(!o)try{var s=t.call(_);s===h&&(o=s)}catch{}}),o},d=Jr();return fi=function(_){return d(_)?!he||!(Symbol.toStringTag in _)?S(pe(_),8,-1):u(_):!1},fi}var Fr;function Sn(){return Fr||(Fr=1,function(K){var H=gn(),ee=vn(),se=yn(),pe=Jr();function he(ie){return ie.call.bind(ie)}var q=typeof BigInt<"u",c=typeof Symbol<"u",S=he(Object.prototype.toString),m=he(Number.prototype.valueOf),f=he(String.prototype.valueOf),u=he(Boolean.prototype.valueOf);if(q)var d=he(BigInt.prototype.valueOf);if(c)var y=he(Symbol.prototype.valueOf);function _(ie,xe){if(typeof ie!="object")return!1;try{return xe(ie),!0}catch{return!1}}K.isArgumentsObject=H,K.isGeneratorFunction=ee,K.isTypedArray=pe;function o(ie){return typeof Promise<"u"&&ie instanceof Promise||ie!==null&&typeof ie=="object"&&typeof ie.then=="function"&&typeof ie.catch=="function"}K.isPromise=o;function t(ie){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(ie):pe(ie)||X(ie)}K.isArrayBufferView=t;function h(ie){return se(ie)==="Uint8Array"}K.isUint8Array=h;function s(ie){return se(ie)==="Uint8ClampedArray"}K.isUint8ClampedArray=s;function r(ie){return se(ie)==="Uint16Array"}K.isUint16Array=r;function l(ie){return se(ie)==="Uint32Array"}K.isUint32Array=l;function p(ie){return se(ie)==="Int8Array"}K.isInt8Array=p;function g(ie){return se(ie)==="Int16Array"}K.isInt16Array=g;function w(ie){return se(ie)==="Int32Array"}K.isInt32Array=w;function v(ie){return se(ie)==="Float32Array"}K.isFloat32Array=v;function b(ie){return se(ie)==="Float64Array"}K.isFloat64Array=b;function L(ie){return se(ie)==="BigInt64Array"}K.isBigInt64Array=L;function A(ie){return se(ie)==="BigUint64Array"}K.isBigUint64Array=A;function T(ie){return S(ie)==="[object Map]"}T.working=typeof Map<"u"&&T(new Map);function B(ie){return typeof Map>"u"?!1:T.working?T(ie):ie instanceof Map}K.isMap=B;function U(ie){return S(ie)==="[object Set]"}U.working=typeof Set<"u"&&U(new Set);function D(ie){return typeof Set>"u"?!1:U.working?U(ie):ie instanceof Set}K.isSet=D;function F(ie){return S(ie)==="[object WeakMap]"}F.working=typeof WeakMap<"u"&&F(new WeakMap);function E(ie){return typeof WeakMap>"u"?!1:F.working?F(ie):ie instanceof WeakMap}K.isWeakMap=E;function I(ie){return S(ie)==="[object WeakSet]"}I.working=typeof WeakSet<"u"&&I(new WeakSet);function O(ie){return I(ie)}K.isWeakSet=O;function P(ie){return S(ie)==="[object ArrayBuffer]"}P.working=typeof ArrayBuffer<"u"&&P(new ArrayBuffer);function J(ie){return typeof ArrayBuffer>"u"?!1:P.working?P(ie):ie instanceof ArrayBuffer}K.isArrayBuffer=J;function j(ie){return S(ie)==="[object DataView]"}j.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&j(new DataView(new ArrayBuffer(1),0,1));function X(ie){return typeof DataView>"u"?!1:j.working?j(ie):ie instanceof DataView}K.isDataView=X;var V=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function re(ie){return S(ie)==="[object SharedArrayBuffer]"}function G(ie){return typeof V>"u"?!1:(typeof re.working>"u"&&(re.working=re(new V)),re.working?re(ie):ie instanceof V)}K.isSharedArrayBuffer=G;function z(ie){return S(ie)==="[object AsyncFunction]"}K.isAsyncFunction=z;function W(ie){return S(ie)==="[object Map Iterator]"}K.isMapIterator=W;function te(ie){return S(ie)==="[object Set Iterator]"}K.isSetIterator=te;function ne(ie){return S(ie)==="[object Generator]"}K.isGeneratorObject=ne;function Se(ie){return S(ie)==="[object WebAssembly.Module]"}K.isWebAssemblyCompiledModule=Se;function ce(ie){return _(ie,m)}K.isNumberObject=ce;function ke(ie){return _(ie,f)}K.isStringObject=ke;function Q(ie){return _(ie,u)}K.isBooleanObject=Q;function Le(ie){return q&&_(ie,d)}K.isBigIntObject=Le;function fe(ie){return c&&_(ie,y)}K.isSymbolObject=fe;function st(ie){return ce(ie)||ke(ie)||Q(ie)||Le(ie)||fe(ie)}K.isBoxedPrimitive=st;function Re(ie){return typeof Uint8Array<"u"&&(J(ie)||G(ie))}K.isAnyArrayBuffer=Re,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(ie){Object.defineProperty(K,ie,{enumerable:!1,value:function(){throw new Error(ie+" is not supported in userland")}})})}(Xt)),Xt}var pi,Hr;function bn(){return Hr||(Hr=1,pi=function(H){return H&&typeof H=="object"&&typeof H.copy=="function"&&typeof H.fill=="function"&&typeof H.readUInt8=="function"}),pi}var It={exports:{}},Nr;function Cn(){return Nr||(Nr=1,typeof Object.create=="function"?It.exports=function(H,ee){ee&&(H.super_=ee,H.prototype=Object.create(ee.prototype,{constructor:{value:H,enumerable:!1,writable:!0,configurable:!0}}))}:It.exports=function(H,ee){if(ee){H.super_=ee;var se=function(){};se.prototype=ee.prototype,H.prototype=new se,H.prototype.constructor=H}}),It.exports}var Wr;function wn(){return Wr||(Wr=1,function(K){var H=Object.getOwnPropertyDescriptors||function(X){for(var V=Object.keys(X),re={},G=0;G<V.length;G++)re[V[G]]=Object.getOwnPropertyDescriptor(X,V[G]);return re},ee=/%[sdj%]/g;K.format=function(j){if(!p(j)){for(var X=[],V=0;V<arguments.length;V++)X.push(q(arguments[V]));return X.join(" ")}for(var V=1,re=arguments,G=re.length,z=String(j).replace(ee,function(te){if(te==="%%")return"%";if(V>=G)return te;switch(te){case"%s":return String(re[V++]);case"%d":return Number(re[V++]);case"%j":try{return JSON.stringify(re[V++])}catch{return"[Circular]"}default:return te}}),W=re[V];V<G;W=re[++V])s(W)||!b(W)?z+=" "+W:z+=" "+q(W);return z},K.deprecate=function(j,X){if(typeof process<"u"&&process.noDeprecation===!0)return j;if(typeof process>"u")return function(){return K.deprecate(j,X).apply(this,arguments)};var V=!1;function re(){if(!V){if(process.throwDeprecation)throw new Error(X);process.traceDeprecation?console.trace(X):console.error(X),V=!0}return j.apply(this,arguments)}return re};var se={},pe=/^$/;if({}.NODE_DEBUG){var he={}.NODE_DEBUG;he=he.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),pe=new RegExp("^"+he+"$","i")}K.debuglog=function(j){if(j=j.toUpperCase(),!se[j])if(pe.test(j)){var X=process.pid;se[j]=function(){var V=K.format.apply(K,arguments);console.error("%s %d: %s",j,X,V)}}else se[j]=function(){};return se[j]};function q(j,X){var V={seen:[],stylize:S};return arguments.length>=3&&(V.depth=arguments[2]),arguments.length>=4&&(V.colors=arguments[3]),h(X)?V.showHidden=X:X&&K._extend(V,X),w(V.showHidden)&&(V.showHidden=!1),w(V.depth)&&(V.depth=2),w(V.colors)&&(V.colors=!1),w(V.customInspect)&&(V.customInspect=!0),V.colors&&(V.stylize=c),f(V,j,V.depth)}K.inspect=q,q.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},q.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function c(j,X){var V=q.styles[X];return V?"\x1B["+q.colors[V][0]+"m"+j+"\x1B["+q.colors[V][1]+"m":j}function S(j,X){return j}function m(j){var X={};return j.forEach(function(V,re){X[V]=!0}),X}function f(j,X,V){if(j.customInspect&&X&&T(X.inspect)&&X.inspect!==K.inspect&&!(X.constructor&&X.constructor.prototype===X)){var re=X.inspect(V,j);return p(re)||(re=f(j,re,V)),re}var G=u(j,X);if(G)return G;var z=Object.keys(X),W=m(z);if(j.showHidden&&(z=Object.getOwnPropertyNames(X)),A(X)&&(z.indexOf("message")>=0||z.indexOf("description")>=0))return d(X);if(z.length===0){if(T(X)){var te=X.name?": "+X.name:"";return j.stylize("[Function"+te+"]","special")}if(v(X))return j.stylize(RegExp.prototype.toString.call(X),"regexp");if(L(X))return j.stylize(Date.prototype.toString.call(X),"date");if(A(X))return d(X)}var ne="",Se=!1,ce=["{","}"];if(t(X)&&(Se=!0,ce=["[","]"]),T(X)){var ke=X.name?": "+X.name:"";ne=" [Function"+ke+"]"}if(v(X)&&(ne=" "+RegExp.prototype.toString.call(X)),L(X)&&(ne=" "+Date.prototype.toUTCString.call(X)),A(X)&&(ne=" "+d(X)),z.length===0&&(!Se||X.length==0))return ce[0]+ne+ce[1];if(V<0)return v(X)?j.stylize(RegExp.prototype.toString.call(X),"regexp"):j.stylize("[Object]","special");j.seen.push(X);var Q;return Se?Q=y(j,X,V,W,z):Q=z.map(function(Le){return _(j,X,V,W,Le,Se)}),j.seen.pop(),o(Q,ne,ce)}function u(j,X){if(w(X))return j.stylize("undefined","undefined");if(p(X)){var V="'"+JSON.stringify(X).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return j.stylize(V,"string")}if(l(X))return j.stylize(""+X,"number");if(h(X))return j.stylize(""+X,"boolean");if(s(X))return j.stylize("null","null")}function d(j){return"["+Error.prototype.toString.call(j)+"]"}function y(j,X,V,re,G){for(var z=[],W=0,te=X.length;W<te;++W)I(X,String(W))?z.push(_(j,X,V,re,String(W),!0)):z.push("");return G.forEach(function(ne){ne.match(/^\d+$/)||z.push(_(j,X,V,re,ne,!0))}),z}function _(j,X,V,re,G,z){var W,te,ne;if(ne=Object.getOwnPropertyDescriptor(X,G)||{value:X[G]},ne.get?ne.set?te=j.stylize("[Getter/Setter]","special"):te=j.stylize("[Getter]","special"):ne.set&&(te=j.stylize("[Setter]","special")),I(re,G)||(W="["+G+"]"),te||(j.seen.indexOf(ne.value)<0?(s(V)?te=f(j,ne.value,null):te=f(j,ne.value,V-1),te.indexOf(`
`)>-1&&(z?te=te.split(`
`).map(function(Se){return"  "+Se}).join(`
`).slice(2):te=`
`+te.split(`
`).map(function(Se){return"   "+Se}).join(`
`))):te=j.stylize("[Circular]","special")),w(W)){if(z&&G.match(/^\d+$/))return te;W=JSON.stringify(""+G),W.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(W=W.slice(1,-1),W=j.stylize(W,"name")):(W=W.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),W=j.stylize(W,"string"))}return W+": "+te}function o(j,X,V){var re=j.reduce(function(G,z){return z.indexOf(`
`)>=0,G+z.replace(/\u001b\[\d\d?m/g,"").length+1},0);return re>60?V[0]+(X===""?"":X+`
 `)+" "+j.join(`,
  `)+" "+V[1]:V[0]+X+" "+j.join(", ")+" "+V[1]}K.types=Sn();function t(j){return Array.isArray(j)}K.isArray=t;function h(j){return typeof j=="boolean"}K.isBoolean=h;function s(j){return j===null}K.isNull=s;function r(j){return j==null}K.isNullOrUndefined=r;function l(j){return typeof j=="number"}K.isNumber=l;function p(j){return typeof j=="string"}K.isString=p;function g(j){return typeof j=="symbol"}K.isSymbol=g;function w(j){return j===void 0}K.isUndefined=w;function v(j){return b(j)&&U(j)==="[object RegExp]"}K.isRegExp=v,K.types.isRegExp=v;function b(j){return typeof j=="object"&&j!==null}K.isObject=b;function L(j){return b(j)&&U(j)==="[object Date]"}K.isDate=L,K.types.isDate=L;function A(j){return b(j)&&(U(j)==="[object Error]"||j instanceof Error)}K.isError=A,K.types.isNativeError=A;function T(j){return typeof j=="function"}K.isFunction=T;function B(j){return j===null||typeof j=="boolean"||typeof j=="number"||typeof j=="string"||typeof j=="symbol"||typeof j>"u"}K.isPrimitive=B,K.isBuffer=bn();function U(j){return Object.prototype.toString.call(j)}function D(j){return j<10?"0"+j.toString(10):j.toString(10)}var F=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function E(){var j=new Date,X=[D(j.getHours()),D(j.getMinutes()),D(j.getSeconds())].join(":");return[j.getDate(),F[j.getMonth()],X].join(" ")}K.log=function(){console.log("%s - %s",E(),K.format.apply(K,arguments))},K.inherits=Cn(),K._extend=function(j,X){if(!X||!b(X))return j;for(var V=Object.keys(X),re=V.length;re--;)j[V[re]]=X[V[re]];return j};function I(j,X){return Object.prototype.hasOwnProperty.call(j,X)}var O=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;K.promisify=function(X){if(typeof X!="function")throw new TypeError('The "original" argument must be of type Function');if(O&&X[O]){var V=X[O];if(typeof V!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(V,O,{value:V,enumerable:!1,writable:!1,configurable:!0}),V}function V(){for(var re,G,z=new Promise(function(ne,Se){re=ne,G=Se}),W=[],te=0;te<arguments.length;te++)W.push(arguments[te]);W.push(function(ne,Se){ne?G(ne):re(Se)});try{X.apply(this,W)}catch(ne){G(ne)}return z}return Object.setPrototypeOf(V,Object.getPrototypeOf(X)),O&&Object.defineProperty(V,O,{value:V,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(V,H(X))},K.promisify.custom=O;function P(j,X){if(!j){var V=new Error("Promise was rejected with a falsy value");V.reason=j,j=V}return X(j)}function J(j){if(typeof j!="function")throw new TypeError('The "original" argument must be of type Function');function X(){for(var V=[],re=0;re<arguments.length;re++)V.push(arguments[re]);var G=V.pop();if(typeof G!="function")throw new TypeError("The last argument must be of type Function");var z=this,W=function(){return G.apply(z,arguments)};j.apply(this,V).then(function(te){process.nextTick(W.bind(null,null,te))},function(te){process.nextTick(P.bind(null,te,W))})}return Object.setPrototypeOf(X,Object.getPrototypeOf(j)),Object.defineProperties(X,H(j)),X}K.callbackify=J}(Kt)),Kt}/*! For license information please see xterm-addon-ligatures.js.LICENSE.txt */(function(K,H){(function(ee,se){K.exports=se(Vt,Vt,wn(),Vt)})(self,function(ee,se,pe,he){return(()=>{var q={185:(f,u)=>{function d(_){const o={};for(const[t,h]of Object.entries(_.individual))o[t]=y(h);for(const{range:t,entry:h}of _.range){const s=y(h);for(let r=t[0];r<t[1];r++)o[r]=s}return o}function y(_){const o={};return _.forward&&(o.forward=d(_.forward)),_.reverse&&(o.reverse=d(_.reverse)),_.lookup&&(o.lookup=_.lookup),o}Object.defineProperty(u,"__esModule",{value:!0}),u.default=d},98:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const y=d(602),_=d(593),o=d(233),t=d(694),h=d(532),s=d(595),r=d(223),l=d(439),p=d(349),g=d(185);class w{constructor(L,A){this._lookupTrees=[],this._glyphLookups={},this._font=L,A.cacheSize>0&&(this._cache=new _({max:A.cacheSize,length:(D,F)=>F.length}));const T=(this._font.tables.gsub&&this._font.tables.gsub.features.filter(D=>D.tag==="calt")||[]).reduce((D,F)=>[...D,...F.feature.lookupListIndexes],[]),B=this._font.tables.gsub&&this._font.tables.gsub.lookups||[],U=B.filter((D,F)=>T.some(E=>E===F));for(const[D,F]of U.entries()){const E=[];switch(F.lookupType){case 6:for(const[O,P]of F.subtables.entries())switch(P.substFormat){case 1:E.push(s.default(P,B,O));break;case 2:E.push(r.default(P,B,O));break;case 3:E.push(l.default(P,B,O))}break;case 8:for(const[O,P]of F.subtables.entries())E.push(p.default(P,O))}const I=g.default(o.default(E));this._lookupTrees.push({tree:I,processForward:F.lookupType!==8});for(const O of Object.keys(I))this._glyphLookups[O]||(this._glyphLookups[O]=[]),this._glyphLookups[O].push(D)}}findLigatures(L){const A=this._cache&&this._cache.get(L);if(A&&!Array.isArray(A))return A;const T=[];for(const D of L)T.push(this._font.charToGlyphIndex(D));if(this._lookupTrees.length===0)return{inputGlyphs:T,outputGlyphs:T,contextRanges:[]};const B=this._findInternal(T.slice()),U={inputGlyphs:T,outputGlyphs:B.sequence,contextRanges:B.ranges};return this._cache&&this._cache.set(L,U),U}findLigatureRanges(L){if(this._lookupTrees.length===0)return[];const A=this._cache&&this._cache.get(L);if(A)return Array.isArray(A)?A:A.contextRanges;const T=[];for(const U of L)T.push(this._font.charToGlyphIndex(U));const B=this._findInternal(T);return this._cache&&this._cache.set(L,B.ranges),B.ranges}_findInternal(L){const A=[];let T=this._getNextLookup(L,0);for(;T.index!==null;){const B=this._lookupTrees[T.index];if(B.processForward){let U=T.last;for(let D=T.first;D<U;D++){const F=t.default(B.tree,L,D,D);if(F){for(let E=0;E<F.substitutions.length;E++){const I=F.substitutions[E];I!==null&&(L[D+E]=I)}h.default(A,F.contextRange[0]+D,F.contextRange[1]+D),D+F.length>=U&&(U=D+F.length+1),D+=F.length-1}}}else for(let U=T.last-1;U>=T.first;U--){const D=t.default(B.tree,L,U,U);if(D){for(let F=0;F<D.substitutions.length;F++){const E=D.substitutions[F];E!==null&&(L[U+F]=E)}h.default(A,D.contextRange[0]+U,D.contextRange[1]+U),U-=D.length-1}}T=this._getNextLookup(L,T.index+1)}return{sequence:L,ranges:A}}_getNextLookup(L,A){const T={index:null,first:1/0,last:-1};for(let B=0;B<L.length;B++){const U=this._glyphLookups[L[B]];if(U)for(let D=0;D<U.length;D++){const F=U[D];if(F>=A){(T.index===null||F<=T.index)&&(T.index=F,T.first>B&&(T.first=B),T.last=B+1);break}}}return T}}async function v(b,L){const A=await Promise.resolve().then(()=>d(269)).then(T=>T.promisify(y.load)(b));return new w(A,Object.assign({cacheSize:0},L))}u.load=async function(b,L){const[A]=await Promise.resolve().then(()=>d(781)).then(T=>T.listVariants(b));if(!A)throw new Error(`Font ${b} not found`);return v(A.path,L)},u.loadFile=v,u.loadBuffer=function(b,L){const A=y.parse(b);return new w(A,Object.assign({cacheSize:0},L))}},233:(f,u)=>{function d(r,l){for(const[p,g]of Object.entries(l.individual))if(r.individual[p])y(r.individual[p],g);else{let w=!1;for(const[v,{range:b,entry:L}]of r.range.entries()){const A=o(Number(p),b);if(A.both!==null){w=!0,r.individual[p]=g,y(r.individual[p],h(L)),r.range.splice(v,1);for(const T of A.second)Array.isArray(T)?r.range.push({range:T,entry:h(L)}):r.individual[T]=h(L)}}w||(r.individual[p]=g)}for(const{range:p,entry:g}of l.range){let w=[p];for(let v=0;v<r.range.length;v++){const{range:b,entry:L}=r.range[v];for(const[A,T]of w.entries()){if(!Array.isArray(T)){const B=o(T,b);if(B.both===null)continue;r.individual[T]=h(g),y(r.individual[T],h(L)),r.range.splice(v,1),v--;for(const U of B.second)Array.isArray(U)?r.range.push({range:U,entry:h(L)}):r.individual[U]=h(L);w.splice(A,1,...B.first);break}{const B=_(T,b);if(B.both===null)continue;r.range.splice(v,1),v--;const U=h(L);Array.isArray(B.both)?r.range.push({range:B.both,entry:U}):r.individual[B.both]=U,y(U,h(g));for(const D of B.second)Array.isArray(D)?r.range.push({range:D,entry:h(L)}):r.individual[D]=h(L);w=B.first}}}for(const v of Object.keys(r.individual))for(const[b,L]of w.entries()){if(Array.isArray(L)){const A=o(Number(v),L);if(A.both===null)continue;y(r.individual[v],h(g)),w.splice(b,1,...A.second);break}if(Number(v)===L){y(r.individual[v],h(g));break}}for(const v of w)Array.isArray(v)?r.range.push({range:v,entry:h(g)}):r.individual[v]=h(g)}}function y(r,l){l.lookup&&(!r.lookup||r.lookup.index>l.lookup.index||r.lookup.index===l.lookup.index&&r.lookup.subIndex>l.lookup.subIndex)&&(r.lookup=l.lookup),l.forward&&(r.forward?d(r.forward,l.forward):r.forward=l.forward),l.reverse&&(r.reverse?d(r.reverse,l.reverse):r.reverse=l.reverse)}function _(r,l){const p={first:[],second:[],both:null};if(r[0]<l[1]&&l[0]<r[1]){const g=Math.max(r[0],l[0]),w=Math.min(r[1],l[1]);p.both=t(g,w)}if(r[0]<l[0]){const g=r[0],w=Math.min(l[0],r[1]);p.first.push(t(g,w))}else if(l[0]<r[0]){const g=l[0],w=Math.min(l[1],r[0]);p.second.push(t(g,w))}if(r[1]>l[1]){const g=Math.max(r[0],l[1]),w=r[1];p.first.push(t(g,w))}else if(l[1]>r[1]){const g=Math.max(r[1],l[0]),w=l[1];p.second.push(t(g,w))}return p}function o(r,l){if(r<l[0]||r>l[1])return{first:[r],second:[l],both:null};const p={first:[],second:[],both:r};return l[0]<r&&p.second.push(t(l[0],r)),l[1]>r&&p.second.push(t(r+1,l[1])),p}function t(r,l){return l-r==1?r:[r,l]}function h(r){const l={};return r.forward&&(l.forward=s(r.forward)),r.reverse&&(l.reverse=s(r.reverse)),r.lookup&&(l.lookup={contextRange:r.lookup.contextRange.slice(),index:r.lookup.index,length:r.lookup.length,subIndex:r.lookup.subIndex,substitutions:r.lookup.substitutions.slice()}),l}function s(r){const l={};for(const[p,g]of Object.entries(r.individual))l[p]=h(g);return{individual:l,range:r.range.map(({range:p,entry:g})=>({range:p.slice(),entry:h(g)}))}}Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(r){const l={individual:{},range:[]};for(const p of r)d(l,p);return l}},532:(f,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(d,y,_){let o=!1;for(let t=0;t<d.length;t++){const h=d[t];if(o){if(_<=h[0])return d[t-1][1]=_,d;if(_<=h[1])return d[t-1][1]=Math.max(_,h[1]),d.splice(t,1),o=!1,d;d.splice(t,1),t--}else{if(_<=h[0])return d.splice(t,0,[y,_]),d;if(_<=h[1])return h[0]=Math.min(y,h[0]),d;if(!(y<h[1]))continue;h[0]=Math.min(y,h[0]),o=!0}}return o?d[d.length-1][1]=_:d.push([y,_]),d}},595:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const y=d(283),_=d(267);u.default=function(o,t,h){const s={individual:{},range:[]},r=y.listGlyphsByIndex(o.coverage);for(const{glyphId:l,index:p}of r){const g=o.chainRuleSets[p];if(g)for(const[w,v]of g.entries()){let b=_.getInputTree(s,v.lookupRecords,t,0,l).map(({entry:L,substitution:A})=>({entry:L,substitutions:[A]}));for(const[L,A]of v.input.entries())b=_.processInputPosition([A],L+1,b,v.lookupRecords,t);for(const L of v.lookahead)b=_.processLookaheadPosition([L],b);for(const L of v.backtrack)b=_.processBacktrackPosition([L],b);for(const{entry:L,substitutions:A}of b)L.lookup={substitutions:A,length:v.input.length+1,index:h,subIndex:w,contextRange:[-1*v.backtrack.length,1+v.input.length+v.lookahead.length]}}}return s}},223:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const y=d(233),_=d(283),o=d(91),t=d(267);u.default=function(h,s,r){const l=[],p=_.listGlyphsByIndex(h.coverage);for(const{glyphId:g}of p){const w=o.default(h.inputClassDef,g);for(const[v,b]of w.entries()){if(b===null)continue;const L=h.chainClassSet[b];if(L)for(const[A,T]of L.entries()){const B={individual:{},range:[]};let U=t.getInputTree(B,T.lookupRecords,s,0,v).map(({entry:D,substitution:F})=>({entry:D,substitutions:[F]}));for(const[D,F]of T.input.entries())U=t.processInputPosition(o.listClassGlyphs(h.inputClassDef,F),D+1,U,T.lookupRecords,s);for(const D of T.lookahead)U=t.processLookaheadPosition(o.listClassGlyphs(h.lookaheadClassDef,D),U);for(const D of T.backtrack)U=t.processBacktrackPosition(o.listClassGlyphs(h.backtrackClassDef,D),U);for(const{entry:D,substitutions:F}of U)D.lookup={substitutions:F,index:r,subIndex:A,length:T.input.length+1,contextRange:[-1*T.backtrack.length,1+T.input.length+T.lookahead.length]};l.push(B)}}}return y.default(l)}},439:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const y=d(283),_=d(267);u.default=function(o,t,h){const s={individual:{},range:[]},r=y.listGlyphsByIndex(o.inputCoverage[0]);for(const{glyphId:l}of r){let p=_.getInputTree(s,o.lookupRecords,t,0,l).map(({entry:g,substitution:w})=>({entry:g,substitutions:[w]}));for(const[g,w]of o.inputCoverage.slice(1).entries())p=_.processInputPosition(y.listGlyphsByIndex(w).map(v=>v.glyphId),g+1,p,o.lookupRecords,t);for(const g of o.lookaheadCoverage)p=_.processLookaheadPosition(y.listGlyphsByIndex(g).map(w=>w.glyphId),p);for(const g of o.backtrackCoverage)p=_.processBacktrackPosition(y.listGlyphsByIndex(g).map(w=>w.glyphId),p);for(const{entry:g,substitutions:w}of p)g.lookup={substitutions:w,index:h,subIndex:0,length:o.inputCoverage.length,contextRange:[-1*o.backtrackCoverage.length,o.inputCoverage.length+o.lookaheadCoverage.length]}}return s}},349:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const y=d(283),_=d(267);u.default=function(o,t){const h={individual:{},range:[]},s=y.listGlyphsByIndex(o.coverage);for(const{glyphId:r,index:l}of s){const p={};Array.isArray(r)?h.range.push({entry:p,range:r}):h.individual[r]=p;let g=[{entry:p,substitutions:[o.substitutes[l]]}];for(const w of o.lookaheadCoverage)g=_.processLookaheadPosition(y.listGlyphsByIndex(w).map(v=>v.glyphId),g);for(const w of o.backtrackCoverage)g=_.processBacktrackPosition(y.listGlyphsByIndex(w).map(v=>v.glyphId),g);for(const{entry:w,substitutions:v}of g)w.lookup={substitutions:v,index:t,subIndex:0,length:1,contextRange:[-1*o.backtrackCoverage.length,1+o.lookaheadCoverage.length]}}return h}},91:(f,u)=>{function d(y,_){for(const o of y.ranges)if(o.start<=_&&o.end>=_)return o.classId;return null}Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(y,_){return y.format===2?Array.isArray(_)?function(o,t){let h=t[0],s=d(o,h),r=t[0]+1;const l=new Map;for(;r<t[1];)d(o,r)!==s&&(r-h<=1?l.set(h,s):l.set([h,r],s)),r++;return r-h<=1?l.set(h,s):l.set([h,r],s),l}(y,_):new Map([[_,d(y,_)]]):new Map([[_,null]])},u.listClassGlyphs=function(y,_){if(y.format===2){const o=[];for(const t of y.ranges)t.classId===_&&(t.end===t.start?o.push(t.start):o.push([t.start,t.end+1]));return o}return[]}},283:(f,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(d,y){switch(d.format){case 1:const _=d.glyphs.indexOf(y);return _!==-1?_:null;case 2:const o=d.ranges.find(t=>t.start<=y&&t.end>=y);return o?o.index:null}},u.listGlyphsByIndex=function(d){switch(d.format){case 1:return d.glyphs.map((_,o)=>({glyphId:_,index:o}));case 2:let y=[];for(const[_,o]of d.ranges.entries())o.end===o.start?y.push({glyphId:o.start,index:_}):y.push({glyphId:[o.start,o.end+1],index:_});return y}}},267:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const y=d(603);function _(t,h,s,r,l){const p=[];if(Array.isArray(l)){const g=function(w,v,b,L){for(const A of w.filter(T=>T.sequenceIndex===b))for(const T of v[A.lookupListIndex].subtables){const B=y.getRangeSubstitutionGlyphs(T,L);if(!Array.from(B.values()).every(U=>U!==null))return B}return new Map([[L,null]])}(h,s,r,l);for(const[w,v]of g){const b={};Array.isArray(w)?t.range.push({range:w,entry:b}):t.individual[w]={},p.push({entry:b,substitution:v})}}else t.individual[l]={},p.push({entry:t.individual[l],substitution:o(h,s,r,l)});return p}function o(t,h,s,r){for(const l of t.filter(p=>p.sequenceIndex===s))for(const p of h[l.lookupListIndex].subtables){const g=y.getIndividualSubstitutionGlyph(p,r);if(g!==null)return g}return null}u.processInputPosition=function(t,h,s,r,l){const p=[];for(const g of s){g.entry.forward={individual:{},range:[]};for(const w of t)p.push(..._(g.entry.forward,r,l,h,w).map(({entry:v,substitution:b})=>({entry:v,substitutions:[...g.substitutions,b]})))}return p},u.processLookaheadPosition=function(t,h){const s=[];for(const r of h)for(const l of t){const p={};r.entry.forward||(r.entry.forward={individual:{},range:[]}),s.push({entry:p,substitutions:r.substitutions}),Array.isArray(l)?r.entry.forward.range.push({entry:p,range:l}):r.entry.forward.individual[l]=p}return s},u.processBacktrackPosition=function(t,h){const s=[];for(const r of h)for(const l of t){const p={};r.entry.reverse||(r.entry.reverse={individual:{},range:[]}),s.push({entry:p,substitutions:r.substitutions}),Array.isArray(l)?r.entry.reverse.range.push({entry:p,range:l}):r.entry.reverse.individual[l]=p}return s},u.getInputTree=_},603:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const y=d(283);function _(o,t){const h=y.default(o.coverage,t);if(h===null)return null;switch(o.substFormat){case 1:return(t+o.deltaGlyphId)%65536;case 2:return o.substitute[h]!=null?o.substitute[h]:null}}u.getRangeSubstitutionGlyphs=function(o,t){let h=t[0],s=_(o,h),r=t[0]+1;const l=new Map;for(;r<t[1];)_(o,r)!==s&&(r-h<=1?l.set(h,s):l.set([h,r],s)),r++;return r-h<=1?l.set(h,s):l.set([h,r],s),l},u.getIndividualSubstitutionGlyph=_},694:(f,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.default=function d(y,_,o,t){let h=y[_[t]];if(!h)return;let s=h.lookup;if(h.reverse){const l=function(p,g,w){let v=p[g[--w]],b=v&&v.lookup;for(;v&&((!b&&v.lookup||v.lookup&&b&&b.index>v.lookup.index)&&(b=v.lookup),!(--w<0)&&v.reverse);)v=v.reverse[g[w]];return b}(h.reverse,_,o);(!s&&l||l&&s&&(s.index>l.index||s.index===l.index&&s.subIndex>l.subIndex))&&(s=l)}if(++t>=_.length||!h.forward)return s;const r=d(h.forward,_,o,t);return(!s&&r||r&&s&&(s.index>r.index||s.index===r.index&&s.subIndex>r.subIndex))&&(s=r),s}},814:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const y=d(82);var _,o;(function(r){r.Serif="serif",r.SansSerif="sansSerif",r.Monospace="monospace",r.Cursive="cursive",r.Unknown="unknown"})(_=u.Type||(u.Type={})),function(r){r.Regular="regular",r.Italic="italic",r.Oblique="oblique",r.Bold="bold",r.BoldItalic="boldItalic",r.BoldOblique="boldOblique",r.Other="other"}(o=u.Style||(u.Style={}));const t=[" Regular"," Bold"," Bold Italic"," Bold Oblique"," Italic"," Oblique"];function h(r){if(!r.os2&&!r.head)return o.Other;const l=r.os2?32&r.os2.fsSelection:1&r.head.macStyle,p=r.os2?1&r.os2.fsSelection:r.post?r.post.italicAngle<0:2&r.head.macStyle,g=r.os2?512&r.os2.fsSelection:r.post?r.post.italicAngle>0:0,w=r.os2?320&r.os2.fsSelection:1;return l?g?o.BoldOblique:p?o.BoldItalic:o.Bold:g?o.Oblique:p?o.Italic:w?o.Regular:o.Other}u.name=function(r,l){const p=r.names.preferredFamily&&r.names.preferredFamily[l]?r.names.preferredFamily[l]:r.names.fontFamily[l];if(y.platform()==="win32"){const g=`${p} ${r.names.preferredSubfamily&&r.names.preferredSubfamily[l]?r.names.preferredSubfamily[l]:r.names.fontSubfamily[l]}`;let w=-1;for(const v of t){const b=g.lastIndexOf(v);if(b!==-1){w=b;break}}return w!==-1?g.substring(0,w):g}return p},u.type=function(r){if(r.os2)switch(r.os2.panose[0]){case 2:return r.os2.panose[3]===9?_.Monospace:r.os2.panose[1]>=11&&r.os2.panose[1]<=15||r.os2.panose[1]===0?_.SansSerif:_.Serif;case 3:return _.Cursive}else if(r.post&&r.post.isFixedPitch)return _.Monospace;return _.Unknown},u.style=h;const s=[o.Bold,o.BoldItalic,o.BoldOblique];u.weight=function(r){return r.os2?r.os2.usWeightClass:s.includes(h(r))?700:400}},781:function(f,u,d){var y=this&&this.__rest||function(l,p){var g={};for(var w in l)Object.prototype.hasOwnProperty.call(l,w)&&p.indexOf(w)<0&&(g[w]=l[w]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function"){var v=0;for(w=Object.getOwnPropertySymbols(l);v<w.length;v++)p.indexOf(w[v])<0&&(g[w[v]]=l[w[v]])}return g};Object.defineProperty(u,"__esModule",{value:!0});const _=d(459),o=d(934),t=d(814);var h=d(814);async function s(l){const p=Object.assign({concurrency:4,language:"en"},l),g=await _.default({extensions:["ttf","otf"]}),w=await async function(b,L,A){const T=[];let B=0;const U=async F=>{T.push(await(async E=>{try{return r(E,await o.default(E),p.language)}catch(I){if(["TypeError","SyntaxError","ReferenceError","RangeError","AssertionError"].includes(I.name))throw I}})(L[F])),B<L.length&&await U(B++)},D=[];for(;B<L.length&&B<A;B++)D.push(U(B));return await Promise.all(D),T}(0,g,p.concurrency),v={};for(let b of w.filter(L=>L)){const{name:L}=b,A=y(b,["name"]);v[L]||(v[L]=[]),v[L].push(A)}return v}function r(l,p,g){return{name:t.name(p,g),path:l,type:t.type(p),weight:t.weight(p),style:t.style(p)}}u.Type=h.Type,u.Style=h.Style,u.list=s,u.listVariants=async function(l,p){return(await s(p))[l]||[]},u.get=async function(l,p){const g=Object.assign({language:"en"},p);return r(l,await o.default(l),g.language)}},934:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const y=d(89),_=d(896),o=d(380),t=d(879),h=d(130),s=d(731),r=d(954);var l;(function(w){w[w.TrueType=0]="TrueType",w[w.CFF=1]="CFF",w[w.Woff=2]="Woff"})(l||(l={}));const p={name:{tag:Buffer.from("name"),parse:o.default},ltag:{tag:Buffer.from("ltag"),parse:t.default},os2:{tag:Buffer.from("OS/2"),parse:h.default},head:{tag:Buffer.from("head"),parse:s.default},post:{tag:Buffer.from("post"),parse:r.default}};u.default=async function(w){return new Promise((v,b)=>{(async()=>{const L=_.default(),A=y.createReadStream(w);let T=!1;const B=()=>{T=!0};A.once("close",B),A.once("end",B),A.once("error",U=>{T=!0,b(U)}),A.pipe(L);try{switch(function(U){if(U.equals(g.one)||U.equals(g.true)||U.equals(g.typ1))return l.TrueType;if(U.equals(g.otto))return l.CFF;if(U.equals(g.woff))return l.Woff;throw new Error(`Unsupported signature type: ${U}`)}(await L.read(4))){case l.TrueType:case l.CFF:const U=(await L.read(2)).readUInt16BE(0);await L.skip(6);const D=await async function(O,P){const J={};for(let j=0;j<P;j++){const X=await O.read(4),V=await O.read(12);for(const[re,G]of Object.entries(p))if(X.equals(G.tag)&&(J[re]={offset:V.readUInt32BE(4),length:V.readUInt32BE(8)},J.name&&J.ltag&&J.os2))return J}return J}(L,U),F=Object.entries(D).sort((O,P)=>O[1].offset-P[1].offset),E={};for(const[O,P]of F)await L.skip(P.offset-L.offset),E[O]=await L.read(P.length);let I=[];if(E.ltag&&(I=p.ltag.parse(E.ltag)),!E.name)throw new Error(`missing required OpenType table 'name' in font file: ${w}`);return{names:p.name.parse(E.name,I),os2:E.os2&&p.os2.parse(E.os2),head:E.head&&p.head.parse(E.head),post:E.post&&p.post.parse(E.post)};case l.Woff:default:throw new Error("provided font type is not supported yet")}}finally{A.unpipe(L),T||(A.destroy(),L.destroy())}})().then(v,b)})};const g={one:Buffer.from([0,1,0,0]),otto:Buffer.from("OTTO"),true:Buffer.from("true"),typ1:Buffer.from("typ1"),woff:Buffer.from("wOFF")}},731:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const y=d(980);u.default=function(_){return{version:y.formatFixed(_.readUInt16BE(0),_.readUInt16BE(2)),fontRevision:y.formatFixed(_.readUInt16BE(4),_.readUInt16BE(6)),checkSumAdjustment:_.readUInt32BE(8),magicNumber:_.readUInt32BE(12),flags:_.readUInt16BE(16),unitsPerEm:_.readUInt16BE(18),created:y.formatLongDateTime(_.readUInt32BE(20),_.readUInt32BE(24)),modified:y.formatLongDateTime(_.readUInt32BE(28),_.readUInt32BE(32)),xMin:_.readInt16BE(36),yMin:_.readInt16BE(38),xMax:_.readInt16BE(40),yMax:_.readInt16BE(42),macStyle:_.readUInt16BE(44),lowestRecPPEM:_.readUInt16BE(46),fontDirectionHint:_.readInt16BE(48),indexToLocFormat:_.readInt16BE(50),glyphDataFormat:_.readInt16BE(52)}}},879:(f,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(d){if(d.readUInt32BE(0)!==1)throw new Error("Unsupported ltag table version.");const y=d.readUInt32BE(8),_=[];for(let o=0;o<y;o++){let t="";const h=d.readUInt16BE(12+4*o),s=d.readUInt16BE(14+4*o);for(let r=h;r<h+s;++r)t+=String.fromCharCode(d.readInt8(r));_.push(t)}return _}},380:(f,u)=>{Object.defineProperty(u,"__esModule",{value:!0});const d=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],y={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},_={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function o(g,w,v){switch(g){case 0:if(w===65535)return"und";if(v)return v[w];break;case 1:return y[w];case 3:return _[w]}}const t="utf-16",h={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},s={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function r(g,w,v){switch(g){case 0:return t;case 1:return s[v]||h[w];case 3:if(w===1||w===10)return t}}u.default=function(g,w){const v={},b=g.readUInt16BE(2),L=g.readUInt16BE(4);let A=6;for(let T=0;T<b;T++){const B=g.readUInt16BE(A+0),U=g.readUInt16BE(A+2),D=g.readUInt16BE(A+4),F=g.readUInt16BE(A+6),E=d[F]||String(F),I=g.readUInt16BE(A+8),O=g.readUInt16BE(A+10),P=o(B,D,w),J=r(B,U,D);if(A+=12,J!==void 0&&P!==void 0){let j;if(J===t){const X=I/2,V=Array(X);for(let re=0;re<X;re++)V[re]=g.readUInt16BE(L+O+2*re);j=String.fromCharCode(...V)}else j=p(g,L+O,I,J);if(j){let X=v[E];X===void 0&&(X=v[E]={}),X[P]=j}}}return v};const l={"x-mac-croatian":" ","x-mac-cyrillic":" ","x-mac-gaelic":" ","x-mac-greek":" ","x-mac-icelandic":" ","x-mac-inuit":" ","x-mac-ce":" ",macintosh:" ","x-mac-romanian":" ","x-mac-turkish":" "};function p(g,w,v,b){const L=l[b];if(L===void 0)return;let A="";for(let T=0;T<v;T++){const B=g.readUInt8(w+T);A+=B<=127?String.fromCharCode(B):L[127&B]}return A}},130:(f,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(d){const y={version:d.readUInt16BE(0),xAvgCharWidth:d.readUInt16BE(2),usWeightClass:d.readUInt16BE(4),usWidthClass:d.readUInt16BE(6),fsType:d.readUInt16BE(8),ySubscriptXSize:d.readInt16BE(10),ySubscriptYSize:d.readInt16BE(12),ySubscriptXOffset:d.readInt16BE(14),ySubscriptYOffset:d.readInt16BE(16),ySuperscriptXSize:d.readInt16BE(18),ySuperscriptYSize:d.readInt16BE(20),ySuperscriptXOffset:d.readInt16BE(22),ySuperscriptYOffset:d.readInt16BE(24),yStrikeoutSize:d.readInt16BE(26),yStrikeoutPosition:d.readInt16BE(28),sFamilyClass:d.readInt16BE(30),panose:[d.readUInt8(32),d.readUInt8(33),d.readUInt8(34),d.readUInt8(35),d.readUInt8(36),d.readUInt8(37),d.readUInt8(38),d.readUInt8(39),d.readUInt8(40),d.readUInt8(41)],ulUnicodeRange1:d.readUInt32BE(42),ulUnicodeRange2:d.readUInt32BE(46),ulUnicodeRange3:d.readUInt32BE(50),ulUnicodeRange4:d.readUInt32BE(54),achVendID:String.fromCharCode(d.readUInt8(58),d.readUInt8(59),d.readUInt8(60),d.readUInt8(61)),fsSelection:d.readUInt16BE(62),usFirstCharIndex:d.readUInt16BE(64),usLastCharIndex:d.readUInt16BE(66),sTypoAscender:d.readInt16BE(68),sTypoDescender:d.readInt16BE(70),sTypoLineGap:d.readInt16BE(72),usWinAscent:d.readUInt16BE(74),usWinDescent:d.readUInt16BE(76)};return y.version>=1&&(y.ulCodePageRange1=d.readUInt32BE(78),y.ulCodePageRange2=d.readUInt32BE(82)),y.version>=2&&(y.sxHeight=d.readInt16BE(86),y.sCapHeight=d.readInt16BE(88),y.usDefaultChar=d.readUInt16BE(90),y.usBreakChar=d.readUInt16BE(92),y.usMaxContent=d.readUInt16BE(94)),y}},954:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const y=d(980);u.default=function(_){return{version:y.formatFixed(_.readUInt16BE(0),_.readUInt16BE(2)),italicAngle:y.formatFixed(_.readUInt16BE(4),_.readUInt16BE(6)),underlinePosition:_.readInt16BE(8),underlineThickness:_.readInt16BE(10),isFixedPitch:_.readUInt32BE(12),minMemType42:_.readUInt32BE(16),maxMemType42:_.readUInt32BE(20),minMemType1:_.readUInt32BE(24),maxMemType1:_.readUInt32BE(28)}}},980:(f,u)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.formatFixed=function(d,y){return d+y/65536},u.formatLongDateTime=function(d,y){return 1e3*(d*4294967296+y-2082844800)}},459:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const y=d(56),_=d(456),o=d(49),t={win32:()=>({}).WINDIR?[y.join({}.WINDIR,"Fonts")]:["C:\\Windows\\Fonts"],darwin:()=>{const s=_.homedir();return[...s?[y.join(s,"/Library/Fonts")]:[],"/Library/Fonts","/Network/Library/Fonts","/System/Library/Fonts","/System Folder/Fonts"]},linux:()=>{const s=_.homedir();return["/usr/share/fonts","/usr/local/share/fonts",...s?[y.join(s,".fonts"),y.join(s,".local/share/fonts")]:[]]}};function h(s){const r=Object.assign({extensions:["ttf","otf","ttc","woff","woff2"],additionalFolders:[]},s),l=_.platform(),p=t[l];if(!p)throw new Error(`Unsupported platform: ${l}`);const g=p();return o.default([...g,...r.additionalFolders],r.extensions)}f.exports=Object.assign(h,{default:h}),u.default=h},49:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const y=d(89),_=d(269),o=d(56),t=_.promisify(y.readdir),h=_.promisify(y.stat);async function s(r,l,p=10){if(p<=0)return[];let g;try{g=await t(r)}catch{return[]}const w=[];return await Promise.all(g.map(async v=>{const b=o.join(r,v);let L;try{L=await h(b)}catch{return}L.isFile()&&l.test(b)?w.push(b):L.isDirectory()&&w.push(...await s(b,l,p-1))})),w}u.default=async function(r,l){const p=new Set;return await Promise.all(r.map(async g=>{const w=await s(o.resolve(g),new RegExp(`\\.${l.map(v=>`(?:${v})`).join("|")}$`));for(const v of w)p.add(v)})),[...p]}},593:(f,u,d)=>{const y=d(411),_=Symbol("max"),o=Symbol("length"),t=Symbol("lengthCalculator"),h=Symbol("allowStale"),s=Symbol("maxAge"),r=Symbol("dispose"),l=Symbol("noDisposeOnSet"),p=Symbol("lruList"),g=Symbol("cache"),w=Symbol("updateAgeOnGet"),v=()=>1,b=(D,F,E)=>{const I=D[g].get(F);if(I){const O=I.value;if(L(D,O)){if(T(D,I),!D[h])return}else E&&(D[w]&&(I.value.now=Date.now()),D[p].unshiftNode(I));return O.value}},L=(D,F)=>{if(!F||!F.maxAge&&!D[s])return!1;const E=Date.now()-F.now;return F.maxAge?E>F.maxAge:D[s]&&E>D[s]},A=D=>{if(D[o]>D[_])for(let F=D[p].tail;D[o]>D[_]&&F!==null;){const E=F.prev;T(D,F),F=E}},T=(D,F)=>{if(F){const E=F.value;D[r]&&D[r](E.key,E.value),D[o]-=E.length,D[g].delete(E.key),D[p].removeNode(F)}};class B{constructor(F,E,I,O,P){this.key=F,this.value=E,this.length=I,this.now=O,this.maxAge=P||0}}const U=(D,F,E,I)=>{let O=E.value;L(D,O)&&(T(D,E),D[h]||(O=void 0)),O&&F.call(I,O.value,O.key,D)};f.exports=class{constructor(D){if(typeof D=="number"&&(D={max:D}),D||(D={}),D.max&&(typeof D.max!="number"||D.max<0))throw new TypeError("max must be a non-negative number");this[_]=D.max||1/0;const F=D.length||v;if(this[t]=typeof F!="function"?v:F,this[h]=D.stale||!1,D.maxAge&&typeof D.maxAge!="number")throw new TypeError("maxAge must be a number");this[s]=D.maxAge||0,this[r]=D.dispose,this[l]=D.noDisposeOnSet||!1,this[w]=D.updateAgeOnGet||!1,this.reset()}set max(D){if(typeof D!="number"||D<0)throw new TypeError("max must be a non-negative number");this[_]=D||1/0,A(this)}get max(){return this[_]}set allowStale(D){this[h]=!!D}get allowStale(){return this[h]}set maxAge(D){if(typeof D!="number")throw new TypeError("maxAge must be a non-negative number");this[s]=D,A(this)}get maxAge(){return this[s]}set lengthCalculator(D){typeof D!="function"&&(D=v),D!==this[t]&&(this[t]=D,this[o]=0,this[p].forEach(F=>{F.length=this[t](F.value,F.key),this[o]+=F.length})),A(this)}get lengthCalculator(){return this[t]}get length(){return this[o]}get itemCount(){return this[p].length}rforEach(D,F){F=F||this;for(let E=this[p].tail;E!==null;){const I=E.prev;U(this,D,E,F),E=I}}forEach(D,F){F=F||this;for(let E=this[p].head;E!==null;){const I=E.next;U(this,D,E,F),E=I}}keys(){return this[p].toArray().map(D=>D.key)}values(){return this[p].toArray().map(D=>D.value)}reset(){this[r]&&this[p]&&this[p].length&&this[p].forEach(D=>this[r](D.key,D.value)),this[g]=new Map,this[p]=new y,this[o]=0}dump(){return this[p].map(D=>!L(this,D)&&{k:D.key,v:D.value,e:D.now+(D.maxAge||0)}).toArray().filter(D=>D)}dumpLru(){return this[p]}set(D,F,E){if((E=E||this[s])&&typeof E!="number")throw new TypeError("maxAge must be a number");const I=E?Date.now():0,O=this[t](F,D);if(this[g].has(D)){if(O>this[_])return T(this,this[g].get(D)),!1;const J=this[g].get(D).value;return this[r]&&(this[l]||this[r](D,J.value)),J.now=I,J.maxAge=E,J.value=F,this[o]+=O-J.length,J.length=O,this.get(D),A(this),!0}const P=new B(D,F,O,I,E);return P.length>this[_]?(this[r]&&this[r](D,F),!1):(this[o]+=P.length,this[p].unshift(P),this[g].set(D,this[p].head),A(this),!0)}has(D){if(!this[g].has(D))return!1;const F=this[g].get(D).value;return!L(this,F)}get(D){return b(this,D,!0)}peek(D){return b(this,D,!1)}pop(){const D=this[p].tail;return D?(T(this,D),D.value):null}del(D){T(this,this[g].get(D))}load(D){this.reset();const F=Date.now();for(let E=D.length-1;E>=0;E--){const I=D[E],O=I.e||0;if(O===0)this.set(I.k,I.v);else{const P=O-F;P>0&&this.set(I.k,I.v,P)}}}prune(){this[g].forEach((D,F)=>b(this,F,!1))}}},602:(f,u,d)=>{d.r(u),d.d(u,{BoundingBox:()=>h,Font:()=>mr,Glyph:()=>kt,Path:()=>r,_parse:()=>fe,load:()=>Qs,loadSync:()=>en,parse:()=>qt});var y=d(311),_=d.n(y);function o(e,i,n,a,C){return Math.pow(1-C,3)*e+3*Math.pow(1-C,2)*C*i+3*(1-C)*Math.pow(C,2)*n+Math.pow(C,3)*a}function t(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}t.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},t.prototype.addPoint=function(e,i){typeof e=="number"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),typeof i=="number"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=i,this.y2=i),i<this.y1&&(this.y1=i),i>this.y2&&(this.y2=i))},t.prototype.addX=function(e){this.addPoint(e,null)},t.prototype.addY=function(e){this.addPoint(null,e)},t.prototype.addBezier=function(e,i,n,a,C,x,k,M){const R=[e,i],N=[n,a],$=[C,x],Y=[k,M];this.addPoint(e,i),this.addPoint(k,M);for(let Z=0;Z<=1;Z++){const de=6*R[Z]-12*N[Z]+6*$[Z],ae=-3*R[Z]+9*N[Z]-9*$[Z]+3*Y[Z],ye=3*N[Z]-3*R[Z];if(ae===0){if(de===0)continue;const be=-ye/de;0<be&&be<1&&(Z===0&&this.addX(o(R[Z],N[Z],$[Z],Y[Z],be)),Z===1&&this.addY(o(R[Z],N[Z],$[Z],Y[Z],be)));continue}const oe=Math.pow(de,2)-4*ye*ae;if(oe<0)continue;const le=(-de+Math.sqrt(oe))/(2*ae);0<le&&le<1&&(Z===0&&this.addX(o(R[Z],N[Z],$[Z],Y[Z],le)),Z===1&&this.addY(o(R[Z],N[Z],$[Z],Y[Z],le)));const me=(-de-Math.sqrt(oe))/(2*ae);0<me&&me<1&&(Z===0&&this.addX(o(R[Z],N[Z],$[Z],Y[Z],me)),Z===1&&this.addY(o(R[Z],N[Z],$[Z],Y[Z],me)))}},t.prototype.addQuad=function(e,i,n,a,C,x){const k=e+.6666666666666666*(n-e),M=i+2/3*(a-i),R=k+1/3*(C-e),N=M+1/3*(x-i);this.addBezier(e,i,k,M,R,N,C,x)};const h=t;function s(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}s.prototype.moveTo=function(e,i){this.commands.push({type:"M",x:e,y:i})},s.prototype.lineTo=function(e,i){this.commands.push({type:"L",x:e,y:i})},s.prototype.curveTo=s.prototype.bezierCurveTo=function(e,i,n,a,C,x){this.commands.push({type:"C",x1:e,y1:i,x2:n,y2:a,x:C,y:x})},s.prototype.quadTo=s.prototype.quadraticCurveTo=function(e,i,n,a){this.commands.push({type:"Q",x1:e,y1:i,x:n,y:a})},s.prototype.close=s.prototype.closePath=function(){this.commands.push({type:"Z"})},s.prototype.extend=function(e){if(e.commands)e=e.commands;else if(e instanceof h){const i=e;return this.moveTo(i.x1,i.y1),this.lineTo(i.x2,i.y1),this.lineTo(i.x2,i.y2),this.lineTo(i.x1,i.y2),void this.close()}Array.prototype.push.apply(this.commands,e)},s.prototype.getBoundingBox=function(){const e=new h;let i=0,n=0,a=0,C=0;for(let x=0;x<this.commands.length;x++){const k=this.commands[x];switch(k.type){case"M":e.addPoint(k.x,k.y),i=a=k.x,n=C=k.y;break;case"L":e.addPoint(k.x,k.y),a=k.x,C=k.y;break;case"Q":e.addQuad(a,C,k.x1,k.y1,k.x,k.y),a=k.x,C=k.y;break;case"C":e.addBezier(a,C,k.x1,k.y1,k.x2,k.y2,k.x,k.y),a=k.x,C=k.y;break;case"Z":a=i,C=n;break;default:throw new Error("Unexpected path command "+k.type)}}return e.isEmpty()&&e.addPoint(0,0),e},s.prototype.draw=function(e){e.beginPath();for(let i=0;i<this.commands.length;i+=1){const n=this.commands[i];n.type==="M"?e.moveTo(n.x,n.y):n.type==="L"?e.lineTo(n.x,n.y):n.type==="C"?e.bezierCurveTo(n.x1,n.y1,n.x2,n.y2,n.x,n.y):n.type==="Q"?e.quadraticCurveTo(n.x1,n.y1,n.x,n.y):n.type==="Z"&&e.closePath()}this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke())},s.prototype.toPathData=function(e){function i(C){return Math.round(C)===C?""+Math.round(C):C.toFixed(e)}function n(){let C="";for(let x=0;x<arguments.length;x+=1){const k=arguments[x];k>=0&&x>0&&(C+=" "),C+=i(k)}return C}e=e!==void 0?e:2;let a="";for(let C=0;C<this.commands.length;C+=1){const x=this.commands[C];x.type==="M"?a+="M"+n(x.x,x.y):x.type==="L"?a+="L"+n(x.x,x.y):x.type==="C"?a+="C"+n(x.x1,x.y1,x.x2,x.y2,x.x,x.y):x.type==="Q"?a+="Q"+n(x.x1,x.y1,x.x,x.y):x.type==="Z"&&(a+="Z")}return a},s.prototype.toSVG=function(e){let i='<path d="';return i+=this.toPathData(e),i+='"',this.fill&&this.fill!=="black"&&(this.fill===null?i+=' fill="none"':i+=' fill="'+this.fill+'"'),this.stroke&&(i+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),i+="/>",i},s.prototype.toDOMElement=function(e){const i=this.toPathData(e),n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",i),n};const r=s;function l(e){throw new Error(e)}function p(e,i){e||l(i)}const g={fail:l,argument:p,assert:p},w=2147483648,v={},b={},L={};function A(e){return function(){return e}}b.BYTE=function(e){return g.argument(e>=0&&e<=255,"Byte value should be between 0 and 255."),[e]},L.BYTE=A(1),b.CHAR=function(e){return[e.charCodeAt(0)]},L.CHAR=A(1),b.CHARARRAY=function(e){const i=[];for(let n=0;n<e.length;n+=1)i[n]=e.charCodeAt(n);return i},L.CHARARRAY=function(e){return e.length},b.USHORT=function(e){return[e>>8&255,255&e]},L.USHORT=A(2),b.SHORT=function(e){return e>=32768&&(e=-(65536-e)),[e>>8&255,255&e]},L.SHORT=A(2),b.UINT24=function(e){return[e>>16&255,e>>8&255,255&e]},L.UINT24=A(3),b.ULONG=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},L.ULONG=A(4),b.LONG=function(e){return e>=w&&(e=-(2*w-e)),[e>>24&255,e>>16&255,e>>8&255,255&e]},L.LONG=A(4),b.FIXED=b.ULONG,L.FIXED=L.ULONG,b.FWORD=b.SHORT,L.FWORD=L.SHORT,b.UFWORD=b.USHORT,L.UFWORD=L.USHORT,b.LONGDATETIME=function(e){return[0,0,0,0,e>>24&255,e>>16&255,e>>8&255,255&e]},L.LONGDATETIME=A(8),b.TAG=function(e){return g.argument(e.length===4,"Tag should be exactly 4 ASCII characters."),[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]},L.TAG=A(4),b.Card8=b.BYTE,L.Card8=L.BYTE,b.Card16=b.USHORT,L.Card16=L.USHORT,b.OffSize=b.BYTE,L.OffSize=L.BYTE,b.SID=b.USHORT,L.SID=L.USHORT,b.NUMBER=function(e){return e>=-107&&e<=107?[e+139]:e>=108&&e<=1131?[247+((e-=108)>>8),255&e]:e>=-1131&&e<=-108?[251+((e=-e-108)>>8),255&e]:e>=-32768&&e<=32767?b.NUMBER16(e):b.NUMBER32(e)},L.NUMBER=function(e){return b.NUMBER(e).length},b.NUMBER16=function(e){return[28,e>>8&255,255&e]},L.NUMBER16=A(3),b.NUMBER32=function(e){return[29,e>>24&255,e>>16&255,e>>8&255,255&e]},L.NUMBER32=A(5),b.REAL=function(e){let i=e.toString();const n=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(i);if(n){const x=parseFloat("1e"+((n[2]?+n[2]:0)+n[1].length));i=(Math.round(e*x)/x).toString()}let a="";for(let x=0,k=i.length;x<k;x+=1){const M=i[x];a+=M==="e"?i[++x]==="-"?"c":"b":M==="."?"a":M==="-"?"e":M}a+=1&a.length?"f":"ff";const C=[30];for(let x=0,k=a.length;x<k;x+=2)C.push(parseInt(a.substr(x,2),16));return C},L.REAL=function(e){return b.REAL(e).length},b.NAME=b.CHARARRAY,L.NAME=L.CHARARRAY,b.STRING=b.CHARARRAY,L.STRING=L.CHARARRAY,v.UTF8=function(e,i,n){const a=[],C=n;for(let x=0;x<C;x++,i+=1)a[x]=e.getUint8(i);return String.fromCharCode.apply(null,a)},v.UTF16=function(e,i,n){const a=[],C=n/2;for(let x=0;x<C;x++,i+=2)a[x]=e.getUint16(i);return String.fromCharCode.apply(null,a)},b.UTF16=function(e){const i=[];for(let n=0;n<e.length;n+=1){const a=e.charCodeAt(n);i[i.length]=a>>8&255,i[i.length]=255&a}return i},L.UTF16=function(e){return 2*e.length};const T={"x-mac-croatian":"","x-mac-cyrillic":"","x-mac-gaelic":"","x-mac-greek":"","x-mac-icelandic":"","x-mac-inuit":"","x-mac-ce":"",macintosh:"","x-mac-romanian":"","x-mac-turkish":""};v.MACSTRING=function(e,i,n,a){const C=T[a];if(C===void 0)return;let x="";for(let k=0;k<n;k++){const M=e.getUint8(i+k);x+=M<=127?String.fromCharCode(M):C[127&M]}return x};const B=typeof WeakMap=="function"&&new WeakMap;let U;function D(e){return e>=-128&&e<=127}function F(e,i,n){let a=0;const C=e.length;for(;i<C&&a<64&&e[i]===0;)++i,++a;return n.push(128|a-1),i}function E(e,i,n){let a=0;const C=e.length;let x=i;for(;x<C&&a<64;){const k=e[x];if(!D(k)||k===0&&x+1<C&&e[x+1]===0)break;++x,++a}n.push(a-1);for(let k=i;k<x;++k)n.push(e[k]+256&255);return x}function I(e,i,n){let a=0;const C=e.length;let x=i;for(;x<C&&a<64;){const k=e[x];if(k===0||D(k)&&x+1<C&&D(e[x+1]))break;++x,++a}n.push(64|a-1);for(let k=i;k<x;++k){const M=e[k];n.push(M+65536>>8&255,M+256&255)}return x}b.MACSTRING=function(e,i){const n=function(C){if(!U){U={};for(let R in T)U[R]=new String(R)}const x=U[C];if(x===void 0)return;if(B){const R=B.get(x);if(R!==void 0)return R}const k=T[C];if(k===void 0)return;const M={};for(let R=0;R<k.length;R++)M[k.charCodeAt(R)]=R+128;return B&&B.set(x,M),M}(i);if(n===void 0)return;const a=[];for(let C=0;C<e.length;C++){let x=e.charCodeAt(C);if(x>=128&&(x=n[x],x===void 0))return;a[C]=x}return a},L.MACSTRING=function(e,i){const n=b.MACSTRING(e,i);return n!==void 0?n.length:0},b.VARDELTAS=function(e){let i=0;const n=[];for(;i<e.length;){const a=e[i];i=a===0?F(e,i,n):a>=-128&&a<=127?E(e,i,n):I(e,i,n)}return n},b.INDEX=function(e){let i=1;const n=[i],a=[];for(let M=0;M<e.length;M+=1){const R=b.OBJECT(e[M]);Array.prototype.push.apply(a,R),i+=R.length,n.push(i)}if(a.length===0)return[0,0];const C=[],x=1+Math.floor(Math.log(i)/Math.log(2))/8|0,k=[void 0,b.BYTE,b.USHORT,b.UINT24,b.ULONG][x];for(let M=0;M<n.length;M+=1){const R=k(n[M]);Array.prototype.push.apply(C,R)}return Array.prototype.concat(b.Card16(e.length),b.OffSize(x),C,a)},L.INDEX=function(e){return b.INDEX(e).length},b.DICT=function(e){let i=[];const n=Object.keys(e),a=n.length;for(let C=0;C<a;C+=1){const x=parseInt(n[C],0),k=e[x];i=i.concat(b.OPERAND(k.value,k.type)),i=i.concat(b.OPERATOR(x))}return i},L.DICT=function(e){return b.DICT(e).length},b.OPERATOR=function(e){return e<1200?[e]:[12,e-1200]},b.OPERAND=function(e,i){let n=[];if(Array.isArray(i))for(let a=0;a<i.length;a+=1)g.argument(e.length===i.length,"Not enough arguments given for type"+i),n=n.concat(b.OPERAND(e[a],i[a]));else if(i==="SID")n=n.concat(b.NUMBER(e));else if(i==="offset")n=n.concat(b.NUMBER32(e));else if(i==="number")n=n.concat(b.NUMBER(e));else{if(i!=="real")throw new Error("Unknown operand type "+i);n=n.concat(b.REAL(e))}return n},b.OP=b.BYTE,L.OP=L.BYTE;const O=typeof WeakMap=="function"&&new WeakMap;function P(e,i,n){for(let a=0;a<i.length;a+=1){const C=i[a];this[C.name]=C.value}if(this.tableName=e,this.fields=i,n){const a=Object.keys(n);for(let C=0;C<a.length;C+=1){const x=a[C],k=n[x];this[x]!==void 0&&(this[x]=k)}}}function J(e,i,n){n===void 0&&(n=i.length);const a=new Array(i.length+1);a[0]={name:e+"Count",type:"USHORT",value:n};for(let C=0;C<i.length;C++)a[C+1]={name:e+C,type:"USHORT",value:i[C]};return a}function j(e,i,n){const a=i.length,C=new Array(a+1);C[0]={name:e+"Count",type:"USHORT",value:a};for(let x=0;x<a;x++)C[x+1]={name:e+x,type:"TABLE",value:n(i[x],x)};return C}function X(e,i,n){const a=i.length;let C=[];C[0]={name:e+"Count",type:"USHORT",value:a};for(let x=0;x<a;x++)C=C.concat(n(i[x],x));return C}function V(e){e.format===1?P.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(J("glyph",e.glyphs))):g.assert(!1,"Can't create coverage table format 2 yet.")}function re(e){P.call(this,"scriptListTable",X("scriptRecord",e,function(i,n){const a=i.script;let C=a.defaultLangSys;return g.assert(!!C,"Unable to write GSUB: script "+i.tag+" has no default language system."),[{name:"scriptTag"+n,type:"TAG",value:i.tag},{name:"script"+n,type:"TABLE",value:new P("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new P("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:C.reqFeatureIndex}].concat(J("featureIndex",C.featureIndexes)))}].concat(X("langSys",a.langSysRecords,function(x,k){const M=x.langSys;return[{name:"langSysTag"+k,type:"TAG",value:x.tag},{name:"langSys"+k,type:"TABLE",value:new P("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:M.reqFeatureIndex}].concat(J("featureIndex",M.featureIndexes)))}]})))}]}))}function G(e){P.call(this,"featureListTable",X("featureRecord",e,function(i,n){const a=i.feature;return[{name:"featureTag"+n,type:"TAG",value:i.tag},{name:"feature"+n,type:"TABLE",value:new P("featureTable",[{name:"featureParams",type:"USHORT",value:a.featureParams}].concat(J("lookupListIndex",a.lookupListIndexes)))}]}))}function z(e,i){P.call(this,"lookupListTable",j("lookup",e,function(n){let a=i[n.lookupType];return g.assert(!!a,"Unable to write GSUB lookup type "+n.lookupType+" tables."),new P("lookupTable",[{name:"lookupType",type:"USHORT",value:n.lookupType},{name:"lookupFlag",type:"USHORT",value:n.lookupFlag}].concat(j("subtable",n.subtables,a)))}))}b.CHARSTRING=function(e){if(O){const a=O.get(e);if(a!==void 0)return a}let i=[];const n=e.length;for(let a=0;a<n;a+=1){const C=e[a];i=i.concat(b[C.type](C.value))}return O&&O.set(e,i),i},L.CHARSTRING=function(e){return b.CHARSTRING(e).length},b.OBJECT=function(e){const i=b[e.type];return g.argument(i!==void 0,"No encoding function for type "+e.type),i(e.value)},L.OBJECT=function(e){const i=L[e.type];return g.argument(i!==void 0,"No sizeOf function for type "+e.type),i(e.value)},b.TABLE=function(e){let i=[];const n=e.fields.length,a=[],C=[];for(let x=0;x<n;x+=1){const k=e.fields[x],M=b[k.type];g.argument(M!==void 0,"No encoding function for field type "+k.type+" ("+k.name+")");let R=e[k.name];R===void 0&&(R=k.value);const N=M(R);k.type==="TABLE"?(C.push(i.length),i=i.concat([0,0]),a.push(N)):i=i.concat(N)}for(let x=0;x<a.length;x+=1){const k=C[x],M=i.length;g.argument(M<65536,"Table "+e.tableName+" too big."),i[k]=M>>8,i[k+1]=255&M,i=i.concat(a[x])}return i},L.TABLE=function(e){let i=0;const n=e.fields.length;for(let a=0;a<n;a+=1){const C=e.fields[a],x=L[C.type];g.argument(x!==void 0,"No sizeOf function for field type "+C.type+" ("+C.name+")");let k=e[C.name];k===void 0&&(k=C.value),i+=x(k),C.type==="TABLE"&&(i+=2)}return i},b.RECORD=b.TABLE,L.RECORD=L.TABLE,b.LITERAL=function(e){return e},L.LITERAL=function(e){return e.length},P.prototype.encode=function(){return b.TABLE(this)},P.prototype.sizeOf=function(){return L.TABLE(this)},V.prototype=Object.create(P.prototype),V.prototype.constructor=V,re.prototype=Object.create(P.prototype),re.prototype.constructor=re,G.prototype=Object.create(P.prototype),G.prototype.constructor=G,z.prototype=Object.create(P.prototype),z.prototype.constructor=z;const W={Table:P,Record:P,Coverage:V,ScriptList:re,FeatureList:G,LookupList:z,ushortList:J,tableList:j,recordList:X};function te(e,i){return e.getUint8(i)}function ne(e,i){return e.getUint16(i,!1)}function Se(e,i){return e.getUint32(i,!1)}function ce(e,i){return e.getInt16(i,!1)+e.getUint16(i+2,!1)/65535}const ke={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function Q(e,i){this.data=e,this.offset=i,this.relativeOffset=0}Q.prototype.parseByte=function(){const e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},Q.prototype.parseChar=function(){const e=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},Q.prototype.parseCard8=Q.prototype.parseByte,Q.prototype.parseUShort=function(){const e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},Q.prototype.parseCard16=Q.prototype.parseUShort,Q.prototype.parseSID=Q.prototype.parseUShort,Q.prototype.parseOffset16=Q.prototype.parseUShort,Q.prototype.parseShort=function(){const e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},Q.prototype.parseF2Dot14=function(){const e=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,e},Q.prototype.parseULong=function(){const e=Se(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},Q.prototype.parseOffset32=Q.prototype.parseULong,Q.prototype.parseFixed=function(){const e=ce(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},Q.prototype.parseString=function(e){const i=this.data,n=this.offset+this.relativeOffset;let a="";this.relativeOffset+=e;for(let C=0;C<e;C++)a+=String.fromCharCode(i.getUint8(n+C));return a},Q.prototype.parseTag=function(){return this.parseString(4)},Q.prototype.parseLongDateTime=function(){let e=Se(this.data,this.offset+this.relativeOffset+4);return e-=2082844800,this.relativeOffset+=8,e},Q.prototype.parseVersion=function(e){const i=ne(this.data,this.offset+this.relativeOffset),n=ne(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,e===void 0&&(e=4096),i+n/e/10},Q.prototype.skip=function(e,i){i===void 0&&(i=1),this.relativeOffset+=ke[e]*i},Q.prototype.parseULongList=function(e){e===void 0&&(e=this.parseULong());const i=new Array(e),n=this.data;let a=this.offset+this.relativeOffset;for(let C=0;C<e;C++)i[C]=n.getUint32(a),a+=4;return this.relativeOffset+=4*e,i},Q.prototype.parseOffset16List=Q.prototype.parseUShortList=function(e){e===void 0&&(e=this.parseUShort());const i=new Array(e),n=this.data;let a=this.offset+this.relativeOffset;for(let C=0;C<e;C++)i[C]=n.getUint16(a),a+=2;return this.relativeOffset+=2*e,i},Q.prototype.parseShortList=function(e){const i=new Array(e),n=this.data;let a=this.offset+this.relativeOffset;for(let C=0;C<e;C++)i[C]=n.getInt16(a),a+=2;return this.relativeOffset+=2*e,i},Q.prototype.parseByteList=function(e){const i=new Array(e),n=this.data;let a=this.offset+this.relativeOffset;for(let C=0;C<e;C++)i[C]=n.getUint8(a++);return this.relativeOffset+=e,i},Q.prototype.parseList=function(e,i){i||(i=e,e=this.parseUShort());const n=new Array(e);for(let a=0;a<e;a++)n[a]=i.call(this);return n},Q.prototype.parseList32=function(e,i){i||(i=e,e=this.parseULong());const n=new Array(e);for(let a=0;a<e;a++)n[a]=i.call(this);return n},Q.prototype.parseRecordList=function(e,i){i||(i=e,e=this.parseUShort());const n=new Array(e),a=Object.keys(i);for(let C=0;C<e;C++){const x={};for(let k=0;k<a.length;k++){const M=a[k],R=i[M];x[M]=R.call(this)}n[C]=x}return n},Q.prototype.parseRecordList32=function(e,i){i||(i=e,e=this.parseULong());const n=new Array(e),a=Object.keys(i);for(let C=0;C<e;C++){const x={};for(let k=0;k<a.length;k++){const M=a[k],R=i[M];x[M]=R.call(this)}n[C]=x}return n},Q.prototype.parseStruct=function(e){if(typeof e=="function")return e.call(this);{const i=Object.keys(e),n={};for(let a=0;a<i.length;a++){const C=i[a],x=e[C];n[C]=x.call(this)}return n}},Q.prototype.parseValueRecord=function(e){if(e===void 0&&(e=this.parseUShort()),e===0)return;const i={};return 1&e&&(i.xPlacement=this.parseShort()),2&e&&(i.yPlacement=this.parseShort()),4&e&&(i.xAdvance=this.parseShort()),8&e&&(i.yAdvance=this.parseShort()),16&e&&(i.xPlaDevice=void 0,this.parseShort()),32&e&&(i.yPlaDevice=void 0,this.parseShort()),64&e&&(i.xAdvDevice=void 0,this.parseShort()),128&e&&(i.yAdvDevice=void 0,this.parseShort()),i},Q.prototype.parseValueRecordList=function(){const e=this.parseUShort(),i=this.parseUShort(),n=new Array(i);for(let a=0;a<i;a++)n[a]=this.parseValueRecord(e);return n},Q.prototype.parsePointer=function(e){const i=this.parseOffset16();if(i>0)return new Q(this.data,this.offset+i).parseStruct(e)},Q.prototype.parsePointer32=function(e){const i=this.parseOffset32();if(i>0)return new Q(this.data,this.offset+i).parseStruct(e)},Q.prototype.parseListOfLists=function(e){const i=this.parseOffset16List(),n=i.length,a=this.relativeOffset,C=new Array(n);for(let x=0;x<n;x++){const k=i[x];if(k!==0)if(this.relativeOffset=k,e){const M=this.parseOffset16List(),R=new Array(M.length);for(let N=0;N<M.length;N++)this.relativeOffset=k+M[N],R[N]=e.call(this);C[x]=R}else C[x]=this.parseUShortList();else C[x]=void 0}return this.relativeOffset=a,C},Q.prototype.parseCoverage=function(){const e=this.offset+this.relativeOffset,i=this.parseUShort(),n=this.parseUShort();if(i===1)return{format:1,glyphs:this.parseUShortList(n)};if(i===2){const a=new Array(n);for(let C=0;C<n;C++)a[C]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:a}}throw new Error("0x"+e.toString(16)+": Coverage format must be 1 or 2.")},Q.prototype.parseClassDef=function(){const e=this.offset+this.relativeOffset,i=this.parseUShort();if(i===1)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(i===2)return{format:2,ranges:this.parseRecordList({start:Q.uShort,end:Q.uShort,classId:Q.uShort})};throw new Error("0x"+e.toString(16)+": ClassDef format must be 1 or 2.")},Q.list=function(e,i){return function(){return this.parseList(e,i)}},Q.list32=function(e,i){return function(){return this.parseList32(e,i)}},Q.recordList=function(e,i){return function(){return this.parseRecordList(e,i)}},Q.recordList32=function(e,i){return function(){return this.parseRecordList32(e,i)}},Q.pointer=function(e){return function(){return this.parsePointer(e)}},Q.pointer32=function(e){return function(){return this.parsePointer32(e)}},Q.tag=Q.prototype.parseTag,Q.byte=Q.prototype.parseByte,Q.uShort=Q.offset16=Q.prototype.parseUShort,Q.uShortList=Q.prototype.parseUShortList,Q.uLong=Q.offset32=Q.prototype.parseULong,Q.uLongList=Q.prototype.parseULongList,Q.struct=Q.prototype.parseStruct,Q.coverage=Q.prototype.parseCoverage,Q.classDef=Q.prototype.parseClassDef;const Le={reserved:Q.uShort,reqFeatureIndex:Q.uShort,featureIndexes:Q.uShortList};Q.prototype.parseScriptList=function(){return this.parsePointer(Q.recordList({tag:Q.tag,script:Q.pointer({defaultLangSys:Q.pointer(Le),langSysRecords:Q.recordList({tag:Q.tag,langSys:Q.pointer(Le)})})}))||[]},Q.prototype.parseFeatureList=function(){return this.parsePointer(Q.recordList({tag:Q.tag,feature:Q.pointer({featureParams:Q.offset16,lookupListIndexes:Q.uShortList})}))||[]},Q.prototype.parseLookupList=function(e){return this.parsePointer(Q.list(Q.pointer(function(){const i=this.parseUShort();g.argument(1<=i&&i<=9,"GPOS/GSUB lookup type "+i+" unknown.");const n=this.parseUShort(),a=16&n;return{lookupType:i,lookupFlag:n,subtables:this.parseList(Q.pointer(e[i])),markFilteringSet:a?this.parseUShort():void 0}})))||[]},Q.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){const e=this.parseUShort(),i=this.parseUShort();return g.argument(e===1&&i<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:Q.offset32,featureTableSubstitutionOffset:Q.offset32})})||[]};const fe={getByte:te,getCard8:te,getUShort:ne,getCard16:ne,getShort:function(e,i){return e.getInt16(i,!1)},getULong:Se,getFixed:ce,getTag:function(e,i){let n="";for(let a=i;a<i+4;a+=1)n+=String.fromCharCode(e.getInt8(a));return n},getOffset:function(e,i,n){let a=0;for(let C=0;C<n;C+=1)a<<=8,a+=e.getUint8(i+C);return a},getBytes:function(e,i,n){const a=[];for(let C=i;C<n;C+=1)a.push(e.getUint8(C));return a},bytesToString:function(e){let i="";for(let n=0;n<e.length;n+=1)i+=String.fromCharCode(e[n]);return i},Parser:Q};function st(e,i,n){e.segments.push({end:i,start:i,delta:-(i-n),offset:0,glyphIndex:n})}const Re=function(e,i){const n={};n.version=fe.getUShort(e,i),g.argument(n.version===0,"cmap table version should be 0."),n.numTables=fe.getUShort(e,i+2);let a=-1;for(let x=n.numTables-1;x>=0;x-=1){const k=fe.getUShort(e,i+4+8*x),M=fe.getUShort(e,i+4+8*x+2);if(k===3&&(M===0||M===1||M===10)){a=fe.getULong(e,i+4+8*x+4);break}}if(a===-1)throw new Error("No valid cmap sub-tables found.");const C=new fe.Parser(e,i+a);if(n.format=C.parseUShort(),n.format===12)(function(x,k){let M;k.parseUShort(),x.length=k.parseULong(),x.language=k.parseULong(),x.groupCount=M=k.parseULong(),x.glyphIndexMap={};for(let R=0;R<M;R+=1){const N=k.parseULong(),$=k.parseULong();let Y=k.parseULong();for(let Z=N;Z<=$;Z+=1)x.glyphIndexMap[Z]=Y,Y++}})(n,C);else{if(n.format!==4)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+n.format+").");(function(x,k,M,R,N){let $;x.length=k.parseUShort(),x.language=k.parseUShort(),x.segCount=$=k.parseUShort()>>1,k.skip("uShort",3),x.glyphIndexMap={};const Y=new fe.Parser(M,R+N+14),Z=new fe.Parser(M,R+N+16+2*$),de=new fe.Parser(M,R+N+16+4*$),ae=new fe.Parser(M,R+N+16+6*$);let ye=R+N+16+8*$;for(let oe=0;oe<$-1;oe+=1){let le;const me=Y.parseUShort(),be=Z.parseUShort(),Ee=de.parseShort(),_e=ae.parseUShort();for(let ue=be;ue<=me;ue+=1)_e!==0?(ye=ae.offset+ae.relativeOffset-2,ye+=_e,ye+=2*(ue-be),le=fe.getUShort(M,ye),le!==0&&(le=le+Ee&65535)):le=ue+Ee&65535,x.glyphIndexMap[ue]=le}})(n,C,e,i,a)}return n},ie=function(e){let i,n=!0;for(i=e.length-1;i>0;i-=1)if(e.get(i).unicode>65535){console.log("Adding CMAP format 12 (needed!)"),n=!1;break}let a=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:n?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:n?12:20}];n||(a=a.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),a=a.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);const C=new W.Table("cmap",a);for(C.segments=[],i=0;i<e.length;i+=1){const de=e.get(i);for(let ae=0;ae<de.unicodes.length;ae+=1)st(C,de.unicodes[ae],i);C.segments=C.segments.sort(function(ae,ye){return ae.start-ye.start})}(function(de){de.segments.push({end:65535,start:65535,delta:1,offset:0})})(C);const x=C.segments.length;let k=0,M=[],R=[],N=[],$=[],Y=[],Z=[];for(i=0;i<x;i+=1){const de=C.segments[i];de.end<=65535&&de.start<=65535?(M=M.concat({name:"end_"+i,type:"USHORT",value:de.end}),R=R.concat({name:"start_"+i,type:"USHORT",value:de.start}),N=N.concat({name:"idDelta_"+i,type:"SHORT",value:de.delta}),$=$.concat({name:"idRangeOffset_"+i,type:"USHORT",value:de.offset}),de.glyphId!==void 0&&(Y=Y.concat({name:"glyph_"+i,type:"USHORT",value:de.glyphId}))):k+=1,n||de.glyphIndex===void 0||(Z=Z.concat({name:"cmap12Start_"+i,type:"ULONG",value:de.start}),Z=Z.concat({name:"cmap12End_"+i,type:"ULONG",value:de.end}),Z=Z.concat({name:"cmap12Glyph_"+i,type:"ULONG",value:de.glyphIndex}))}if(C.segCountX2=2*(x-k),C.searchRange=2*Math.pow(2,Math.floor(Math.log(x-k)/Math.log(2))),C.entrySelector=Math.log(C.searchRange/2)/Math.log(2),C.rangeShift=C.segCountX2-C.searchRange,C.fields=C.fields.concat(M),C.fields.push({name:"reservedPad",type:"USHORT",value:0}),C.fields=C.fields.concat(R),C.fields=C.fields.concat(N),C.fields=C.fields.concat($),C.fields=C.fields.concat(Y),C.cmap4Length=14+2*M.length+2+2*R.length+2*N.length+2*$.length+2*Y.length,!n){const de=16+4*Z.length;C.cmap12Offset=20+C.cmap4Length,C.fields=C.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:de},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:Z.length/3}]),C.fields=C.fields.concat(Z)}return C},xe=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],Ce=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],Ae=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],Pe=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function Ne(e){this.font=e}function nt(e){this.cmap=e}function Qe(e,i){this.encoding=e,this.charset=i}function je(e){switch(e.version){case 1:this.names=Pe.slice();break;case 2:this.names=new Array(e.numberOfGlyphs);for(let i=0;i<e.numberOfGlyphs;i++)e.glyphNameIndex[i]<Pe.length?this.names[i]=Pe[e.glyphNameIndex[i]]:this.names[i]=e.names[e.glyphNameIndex[i]-Pe.length];break;case 2.5:this.names=new Array(e.numberOfGlyphs);for(let i=0;i<e.numberOfGlyphs;i++)this.names[i]=Pe[i+e.glyphNameIndex[i]];break;default:this.names=[]}}Ne.prototype.charToGlyphIndex=function(e){const i=e.charCodeAt(0),n=this.font.glyphs;if(n)for(let a=0;a<n.length;a+=1){const C=n.get(a);for(let x=0;x<C.unicodes.length;x+=1)if(C.unicodes[x]===i)return a}return null},nt.prototype.charToGlyphIndex=function(e){return this.cmap.glyphIndexMap[e.charCodeAt(0)]||0},Qe.prototype.charToGlyphIndex=function(e){const i=e.charCodeAt(0),n=this.encoding[i];return this.charset.indexOf(n)},je.prototype.nameToGlyphIndex=function(e){return this.names.indexOf(e)},je.prototype.glyphIndexToName=function(e){return this.names[e]};const Me=function(e,i,n,a,C){e.beginPath(),e.moveTo(i,n),e.lineTo(a,C),e.stroke()};function Ve(e,i,n,a,C){let x;return(i&a)>0?(x=e.parseByte(),!(i&C)&&(x=-x),x=n+x):x=(i&C)>0?n:n+e.parseShort(),x}function bt(e,i,n){const a=new fe.Parser(i,n);let C,x;if(e.numberOfContours=a.parseShort(),e._xMin=a.parseShort(),e._yMin=a.parseShort(),e._xMax=a.parseShort(),e._yMax=a.parseShort(),e.numberOfContours>0){const k=e.endPointIndices=[];for(let R=0;R<e.numberOfContours;R+=1)k.push(a.parseUShort());e.instructionLength=a.parseUShort(),e.instructions=[];for(let R=0;R<e.instructionLength;R+=1)e.instructions.push(a.parseByte());const M=k[k.length-1]+1;C=[];for(let R=0;R<M;R+=1)if(x=a.parseByte(),C.push(x),(8&x)>0){const N=a.parseByte();for(let $=0;$<N;$+=1)C.push(x),R+=1}if(g.argument(C.length===M,"Bad flags."),k.length>0){const R=[];let N;if(M>0){for(let Z=0;Z<M;Z+=1)x=C[Z],N={},N.onCurve=!!(1&x),N.lastPointOfContour=k.indexOf(Z)>=0,R.push(N);let $=0;for(let Z=0;Z<M;Z+=1)x=C[Z],N=R[Z],N.x=Ve(a,x,$,2,16),$=N.x;let Y=0;for(let Z=0;Z<M;Z+=1)x=C[Z],N=R[Z],N.y=Ve(a,x,Y,4,32),Y=N.y}e.points=R}else e.points=[]}else if(e.numberOfContours===0)e.points=[];else{e.isComposite=!0,e.points=[],e.components=[];let k=!0;for(;k;){C=a.parseUShort();const M={glyphIndex:a.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&C)>0?(2&C)>0?(M.dx=a.parseShort(),M.dy=a.parseShort()):M.matchedPoints=[a.parseUShort(),a.parseUShort()]:(2&C)>0?(M.dx=a.parseChar(),M.dy=a.parseChar()):M.matchedPoints=[a.parseByte(),a.parseByte()],(8&C)>0?M.xScale=M.yScale=a.parseF2Dot14():(64&C)>0?(M.xScale=a.parseF2Dot14(),M.yScale=a.parseF2Dot14()):(128&C)>0&&(M.xScale=a.parseF2Dot14(),M.scale01=a.parseF2Dot14(),M.scale10=a.parseF2Dot14(),M.yScale=a.parseF2Dot14()),e.components.push(M),k=!!(32&C)}if(256&C){e.instructionLength=a.parseUShort(),e.instructions=[];for(let M=0;M<e.instructionLength;M+=1)e.instructions.push(a.parseByte())}}}function ot(e,i){const n=[];for(let a=0;a<e.length;a+=1){const C=e[a],x={x:i.xScale*C.x+i.scale01*C.y+i.dx,y:i.scale10*C.x+i.yScale*C.y+i.dy,onCurve:C.onCurve,lastPointOfContour:C.lastPointOfContour};n.push(x)}return n}function ft(e){const i=new r;if(!e)return i;const n=function(a){const C=[];let x=[];for(let k=0;k<a.length;k+=1){const M=a[k];x.push(M),M.lastPointOfContour&&(C.push(x),x=[])}return g.argument(x.length===0,"There are still points left in the current contour."),C}(e);for(let a=0;a<n.length;++a){const C=n[a];let x=null,k=C[C.length-1],M=C[0];if(k.onCurve)i.moveTo(k.x,k.y);else if(M.onCurve)i.moveTo(M.x,M.y);else{const R={x:.5*(k.x+M.x),y:.5*(k.y+M.y)};i.moveTo(R.x,R.y)}for(let R=0;R<C.length;++R)if(x=k,k=M,M=C[(R+1)%C.length],k.onCurve)i.lineTo(k.x,k.y);else{let N=x,$=M;x.onCurve||(N={x:.5*(k.x+x.x),y:.5*(k.y+x.y)},i.lineTo(N.x,N.y)),M.onCurve||($={x:.5*(k.x+M.x),y:.5*(k.y+M.y)}),i.lineTo(N.x,N.y),i.quadraticCurveTo(k.x,k.y,$.x,$.y)}i.closePath()}return i}function Et(e,i){if(i.isComposite)for(let n=0;n<i.components.length;n+=1){const a=i.components[n],C=e.get(a.glyphIndex);if(C.getPath(),C.points){let x;if(a.matchedPoints===void 0)x=ot(C.points,a);else{if(a.matchedPoints[0]>i.points.length-1||a.matchedPoints[1]>C.points.length-1)throw Error("Matched points out of range in "+i.name);const k=i.points[a.matchedPoints[0]];let M=C.points[a.matchedPoints[1]];const R={xScale:a.xScale,scale01:a.scale01,scale10:a.scale10,yScale:a.yScale,dx:0,dy:0};M=ot([M],R)[0],R.dx=k.x-M.x,R.dy=k.y-M.y,x=ot(C.points,R)}i.points=i.points.concat(x)}}return ft(i.points)}const wi={getPath:ft,parse:function(e,i,n,a){const C=new _t.GlyphSet(a);for(let x=0;x<n.length-1;x+=1){const k=n[x];k!==n[x+1]?C.push(x,_t.ttfGlyphLoader(a,x,bt,e,i+k,Et)):C.push(x,_t.glyphLoader(a,x))}return C}};function et(e){this.bindConstructorValues(e)}et.prototype.bindConstructorValues=function(e){this.index=e.index||0,this.name=e.name||null,this.unicode=e.unicode||void 0,this.unicodes=e.unicodes||e.unicode!==void 0?[e.unicode]:[],e.xMin&&(this.xMin=e.xMin),e.yMin&&(this.yMin=e.yMin),e.xMax&&(this.xMax=e.xMax),e.yMax&&(this.yMax=e.yMax),e.advanceWidth&&(this.advanceWidth=e.advanceWidth),Object.defineProperty(this,"path",function(i,n){let a=n||new r;return{configurable:!0,get:function(){return typeof a=="function"&&(a=a()),a},set:function(C){a=C}}}(0,e.path))},et.prototype.addUnicode=function(e){this.unicodes.length===0&&(this.unicode=e),this.unicodes.push(e)},et.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},et.prototype.getPath=function(e,i,n,a,C){let x,k;e=e!==void 0?e:0,i=i!==void 0?i:0,n=n!==void 0?n:72,a||(a={});let M=a.xScale,R=a.yScale;if(a.hinting&&C&&C.hinting&&(k=this.path&&C.hinting.exec(this,n)),k)x=wi.getPath(k).commands,e=Math.round(e),i=Math.round(i),M=R=1;else{x=this.path.commands;const $=1/this.path.unitsPerEm*n;M===void 0&&(M=$),R===void 0&&(R=$)}const N=new r;for(let $=0;$<x.length;$+=1){const Y=x[$];Y.type==="M"?N.moveTo(e+Y.x*M,i+-Y.y*R):Y.type==="L"?N.lineTo(e+Y.x*M,i+-Y.y*R):Y.type==="Q"?N.quadraticCurveTo(e+Y.x1*M,i+-Y.y1*R,e+Y.x*M,i+-Y.y*R):Y.type==="C"?N.curveTo(e+Y.x1*M,i+-Y.y1*R,e+Y.x2*M,i+-Y.y2*R,e+Y.x*M,i+-Y.y*R):Y.type==="Z"&&N.closePath()}return N},et.prototype.getContours=function(){if(this.points===void 0)return[];const e=[];let i=[];for(let n=0;n<this.points.length;n+=1){const a=this.points[n];i.push(a),a.lastPointOfContour&&(e.push(i),i=[])}return g.argument(i.length===0,"There are still points left in the current contour."),e},et.prototype.getMetrics=function(){const e=this.path.commands,i=[],n=[];for(let C=0;C<e.length;C+=1){const x=e[C];x.type!=="Z"&&(i.push(x.x),n.push(x.y)),x.type!=="Q"&&x.type!=="C"||(i.push(x.x1),n.push(x.y1)),x.type==="C"&&(i.push(x.x2),n.push(x.y2))}const a={xMin:Math.min.apply(null,i),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,i),yMax:Math.max.apply(null,n),leftSideBearing:this.leftSideBearing};return isFinite(a.xMin)||(a.xMin=0),isFinite(a.xMax)||(a.xMax=this.advanceWidth),isFinite(a.yMin)||(a.yMin=0),isFinite(a.yMax)||(a.yMax=0),a.rightSideBearing=this.advanceWidth-a.leftSideBearing-(a.xMax-a.xMin),a},et.prototype.draw=function(e,i,n,a,C){this.getPath(i,n,a,C).draw(e)},et.prototype.drawPoints=function(e,i,n,a){function C(N,$,Y,Z){const de=2*Math.PI;e.beginPath();for(let ae=0;ae<N.length;ae+=1)e.moveTo($+N[ae].x*Z,Y+N[ae].y*Z),e.arc($+N[ae].x*Z,Y+N[ae].y*Z,2,0,de,!1);e.closePath(),e.fill()}i=i!==void 0?i:0,n=n!==void 0?n:0,a=a!==void 0?a:24;const x=1/this.path.unitsPerEm*a,k=[],M=[],R=this.path;for(let N=0;N<R.commands.length;N+=1){const $=R.commands[N];$.x!==void 0&&k.push({x:$.x,y:-$.y}),$.x1!==void 0&&M.push({x:$.x1,y:-$.y1}),$.x2!==void 0&&M.push({x:$.x2,y:-$.y2})}e.fillStyle="blue",C(k,i,n,x),e.fillStyle="red",C(M,i,n,x)},et.prototype.drawMetrics=function(e,i,n,a){let C;i=i!==void 0?i:0,n=n!==void 0?n:0,a=a!==void 0?a:24,C=1/this.path.unitsPerEm*a,e.lineWidth=1,e.strokeStyle="black",Me(e,i,-1e4,i,1e4),Me(e,-1e4,n,1e4,n);const x=this.xMin||0;let k=this.yMin||0;const M=this.xMax||0;let R=this.yMax||0;const N=this.advanceWidth||0;e.strokeStyle="blue",Me(e,i+x*C,-1e4,i+x*C,1e4),Me(e,i+M*C,-1e4,i+M*C,1e4),Me(e,-1e4,n+-k*C,1e4,n+-k*C),Me(e,-1e4,n+-R*C,1e4,n+-R*C),e.strokeStyle="green",Me(e,i+N*C,-1e4,i+N*C,1e4)};const kt=et;function Rt(e,i,n){Object.defineProperty(e,i,{get:function(){return e.path,e[n]},set:function(a){e[n]=a},enumerable:!0,configurable:!0})}function Ut(e,i){if(this.font=e,this.glyphs={},Array.isArray(i))for(let n=0;n<i.length;n++)this.glyphs[n]=i[n];this.length=i&&i.length||0}Ut.prototype.get=function(e){return typeof this.glyphs[e]=="function"&&(this.glyphs[e]=this.glyphs[e]()),this.glyphs[e]},Ut.prototype.push=function(e,i){this.glyphs[e]=i,this.length++};const _t={GlyphSet:Ut,glyphLoader:function(e,i){return new kt({index:i,font:e})},ttfGlyphLoader:function(e,i,n,a,C,x){return function(){const k=new kt({index:i,font:e});return k.path=function(){n(k,a,C);const M=x(e.glyphs,k);return M.unitsPerEm=e.unitsPerEm,M},Rt(k,"xMin","_xMin"),Rt(k,"xMax","_xMax"),Rt(k,"yMin","_yMin"),Rt(k,"yMax","_yMax"),k}},cffGlyphLoader:function(e,i,n,a){return function(){const C=new kt({index:i,font:e});return C.path=function(){const x=n(e,C,a);return x.unitsPerEm=e.unitsPerEm,x},C}}};function xi(e,i){if(e===i)return!0;if(Array.isArray(e)&&Array.isArray(i)){if(e.length!==i.length)return!1;for(let n=0;n<e.length;n+=1)if(!xi(e[n],i[n]))return!1;return!0}return!1}function Ft(e){let i;return i=e.length<1240?107:e.length<33900?1131:32768,i}function at(e,i,n){const a=[],C=[],x=fe.getCard16(e,i);let k,M;if(x!==0){const R=fe.getByte(e,i+2);k=i+(x+1)*R+2;let N=i+3;for(let $=0;$<x+1;$+=1)a.push(fe.getOffset(e,N,R)),N+=R;M=k+a[x]}else M=i+2;for(let R=0;R<a.length-1;R+=1){let N=fe.getBytes(e,k+a[R],k+a[R+1]);n&&(N=n(N)),C.push(N)}return{objects:C,startOffset:i,endOffset:M}}function ts(e,i){let n,a,C,x;if(i===28)return n=e.parseByte(),a=e.parseByte(),n<<8|a;if(i===29)return n=e.parseByte(),a=e.parseByte(),C=e.parseByte(),x=e.parseByte(),n<<24|a<<16|C<<8|x;if(i===30)return function(k){let M="";const R=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];for(;;){const N=k.parseByte(),$=N>>4,Y=15&N;if($===15||(M+=R[$],Y===15))break;M+=R[Y]}return parseFloat(M)}(e);if(i>=32&&i<=246)return i-139;if(i>=247&&i<=250)return n=e.parseByte(),256*(i-247)+n+108;if(i>=251&&i<=254)return n=e.parseByte(),256*-(i-251)-n-108;throw new Error("Invalid b0 "+i)}function Li(e,i,n){i=i!==void 0?i:0;const a=new fe.Parser(e,i),C=[];let x=[];for(n=n!==void 0?n:e.length;a.relativeOffset<n;){let k=a.parseByte();k<=21?(k===12&&(k=1200+a.parseByte()),C.push([k,x]),x=[]):x.push(ts(a,k))}return function(k){const M={};for(let R=0;R<k.length;R+=1){const N=k[R][0],$=k[R][1];let Y;if(Y=$.length===1?$[0]:$,M.hasOwnProperty(N)&&!isNaN(M[N]))throw new Error("Object "+M+" already has key "+N);M[N]=Y}return M}(C)}function Ct(e,i){return i<=390?xe[i]:e[i-391]}function Ei(e,i,n){const a={};let C;for(let x=0;x<i.length;x+=1){const k=i[x];if(Array.isArray(k.type)){const M=[];M.length=k.type.length;for(let R=0;R<k.type.length;R++)C=e[k.op]!==void 0?e[k.op][R]:void 0,C===void 0&&(C=k.value!==void 0&&k.value[R]!==void 0?k.value[R]:null),k.type[R]==="SID"&&(C=Ct(n,C)),M[R]=C;a[k.name]=M}else C=e[k.op],C===void 0&&(C=k.value!==void 0?k.value:null),k.type==="SID"&&(C=Ct(n,C)),a[k.name]=C}return a}const ki=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],Ri=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function is(e,i){return Ei(Li(e,0,e.byteLength),ki,i)}function Ai(e,i,n,a){return Ei(Li(e,i,n),Ri,a)}function Ti(e,i,n,a){const C=[];for(let x=0;x<n.length;x+=1){const k=is(new DataView(new Uint8Array(n[x]).buffer),a);k._subrs=[],k._subrsBias=0;const M=k.private[0],R=k.private[1];if(M!==0&&R!==0){const N=Ai(e,R+i,M,a);if(k._defaultWidthX=N.defaultWidthX,k._nominalWidthX=N.nominalWidthX,N.subrs!==0){const $=at(e,R+N.subrs+i);k._subrs=$.objects,k._subrsBias=Ft(k._subrs)}k._privateDict=N}C.push(k)}return C}function rs(e,i,n){let a,C,x,k;const M=new r,R=[];let N,$,Y,Z,de=0,ae=!1,ye=!1,oe=0,le=0;if(e.isCIDFont){const _e=e.tables.cff.topDict._fdSelect[i.index],ue=e.tables.cff.topDict._fdArray[_e];N=ue._subrs,$=ue._subrsBias,Y=ue._defaultWidthX,Z=ue._nominalWidthX}else N=e.tables.cff.topDict._subrs,$=e.tables.cff.topDict._subrsBias,Y=e.tables.cff.topDict._defaultWidthX,Z=e.tables.cff.topDict._nominalWidthX;let me=Y;function be(_e,ue){ye&&M.closePath(),M.moveTo(_e,ue),ye=!0}function Ee(){let _e;_e=R.length%2!=0,_e&&!ae&&(me=R.shift()+Z),de+=R.length>>1,R.length=0,ae=!0}return function _e(ue){let ge,Te,we,Ie,We,qe,Fe,ze,Ue,Ge,He,Ke,Be=0;for(;Be<ue.length;){let $e=ue[Be];switch(Be+=1,$e){case 1:case 3:case 18:case 23:Ee();break;case 4:R.length>1&&!ae&&(me=R.shift()+Z,ae=!0),le+=R.pop(),be(oe,le);break;case 5:for(;R.length>0;)oe+=R.shift(),le+=R.shift(),M.lineTo(oe,le);break;case 6:for(;R.length>0&&(oe+=R.shift(),M.lineTo(oe,le),R.length!==0);)le+=R.shift(),M.lineTo(oe,le);break;case 7:for(;R.length>0&&(le+=R.shift(),M.lineTo(oe,le),R.length!==0);)oe+=R.shift(),M.lineTo(oe,le);break;case 8:for(;R.length>0;)a=oe+R.shift(),C=le+R.shift(),x=a+R.shift(),k=C+R.shift(),oe=x+R.shift(),le=k+R.shift(),M.curveTo(a,C,x,k,oe,le);break;case 10:We=R.pop()+$,qe=N[We],qe&&_e(qe);break;case 11:return;case 12:switch($e=ue[Be],Be+=1,$e){case 35:a=oe+R.shift(),C=le+R.shift(),x=a+R.shift(),k=C+R.shift(),Fe=x+R.shift(),ze=k+R.shift(),Ue=Fe+R.shift(),Ge=ze+R.shift(),He=Ue+R.shift(),Ke=Ge+R.shift(),oe=He+R.shift(),le=Ke+R.shift(),R.shift(),M.curveTo(a,C,x,k,Fe,ze),M.curveTo(Ue,Ge,He,Ke,oe,le);break;case 34:a=oe+R.shift(),C=le,x=a+R.shift(),k=C+R.shift(),Fe=x+R.shift(),ze=k,Ue=Fe+R.shift(),Ge=k,He=Ue+R.shift(),Ke=le,oe=He+R.shift(),M.curveTo(a,C,x,k,Fe,ze),M.curveTo(Ue,Ge,He,Ke,oe,le);break;case 36:a=oe+R.shift(),C=le+R.shift(),x=a+R.shift(),k=C+R.shift(),Fe=x+R.shift(),ze=k,Ue=Fe+R.shift(),Ge=k,He=Ue+R.shift(),Ke=Ge+R.shift(),oe=He+R.shift(),M.curveTo(a,C,x,k,Fe,ze),M.curveTo(Ue,Ge,He,Ke,oe,le);break;case 37:a=oe+R.shift(),C=le+R.shift(),x=a+R.shift(),k=C+R.shift(),Fe=x+R.shift(),ze=k+R.shift(),Ue=Fe+R.shift(),Ge=ze+R.shift(),He=Ue+R.shift(),Ke=Ge+R.shift(),Math.abs(He-oe)>Math.abs(Ke-le)?oe=He+R.shift():le=Ke+R.shift(),M.curveTo(a,C,x,k,Fe,ze),M.curveTo(Ue,Ge,He,Ke,oe,le);break;default:console.log("Glyph "+i.index+": unknown operator 1200"+$e),R.length=0}break;case 14:R.length>0&&!ae&&(me=R.shift()+Z,ae=!0),ye&&(M.closePath(),ye=!1);break;case 19:case 20:Ee(),Be+=de+7>>3;break;case 21:R.length>2&&!ae&&(me=R.shift()+Z,ae=!0),le+=R.pop(),oe+=R.pop(),be(oe,le);break;case 22:R.length>1&&!ae&&(me=R.shift()+Z,ae=!0),oe+=R.pop(),be(oe,le);break;case 24:for(;R.length>2;)a=oe+R.shift(),C=le+R.shift(),x=a+R.shift(),k=C+R.shift(),oe=x+R.shift(),le=k+R.shift(),M.curveTo(a,C,x,k,oe,le);oe+=R.shift(),le+=R.shift(),M.lineTo(oe,le);break;case 25:for(;R.length>6;)oe+=R.shift(),le+=R.shift(),M.lineTo(oe,le);a=oe+R.shift(),C=le+R.shift(),x=a+R.shift(),k=C+R.shift(),oe=x+R.shift(),le=k+R.shift(),M.curveTo(a,C,x,k,oe,le);break;case 26:for(R.length%2&&(oe+=R.shift());R.length>0;)a=oe,C=le+R.shift(),x=a+R.shift(),k=C+R.shift(),oe=x,le=k+R.shift(),M.curveTo(a,C,x,k,oe,le);break;case 27:for(R.length%2&&(le+=R.shift());R.length>0;)a=oe+R.shift(),C=le,x=a+R.shift(),k=C+R.shift(),oe=x+R.shift(),le=k,M.curveTo(a,C,x,k,oe,le);break;case 28:ge=ue[Be],Te=ue[Be+1],R.push((ge<<24|Te<<16)>>16),Be+=2;break;case 29:We=R.pop()+e.gsubrsBias,qe=e.gsubrs[We],qe&&_e(qe);break;case 30:for(;R.length>0&&(a=oe,C=le+R.shift(),x=a+R.shift(),k=C+R.shift(),oe=x+R.shift(),le=k+(R.length===1?R.shift():0),M.curveTo(a,C,x,k,oe,le),R.length!==0);)a=oe+R.shift(),C=le,x=a+R.shift(),k=C+R.shift(),le=k+R.shift(),oe=x+(R.length===1?R.shift():0),M.curveTo(a,C,x,k,oe,le);break;case 31:for(;R.length>0&&(a=oe+R.shift(),C=le,x=a+R.shift(),k=C+R.shift(),le=k+R.shift(),oe=x+(R.length===1?R.shift():0),M.curveTo(a,C,x,k,oe,le),R.length!==0);)a=oe,C=le+R.shift(),x=a+R.shift(),k=C+R.shift(),oe=x+R.shift(),le=k+(R.length===1?R.shift():0),M.curveTo(a,C,x,k,oe,le);break;default:$e<32?console.log("Glyph "+i.index+": unknown operator "+$e):$e<247?R.push($e-139):$e<251?(ge=ue[Be],Be+=1,R.push(256*($e-247)+ge+108)):$e<255?(ge=ue[Be],Be+=1,R.push(256*-($e-251)-ge-108)):(ge=ue[Be],Te=ue[Be+1],we=ue[Be+2],Ie=ue[Be+3],Be+=4,R.push((ge<<24|Te<<16|we<<8|Ie)/65536))}}}(n),i.advanceWidth=me,M}function Di(e,i){let n,a=xe.indexOf(e);return a>=0&&(n=a),a=i.indexOf(e),a>=0?n=a+xe.length:(n=xe.length+i.length,i.push(e)),n}function Mi(e,i,n){const a={};for(let C=0;C<e.length;C+=1){const x=e[C];let k=i[x.name];k===void 0||xi(k,x.value)||(x.type==="SID"&&(k=Di(k,n)),a[x.op]={name:x.name,type:x.type,value:k})}return a}function Bi(e,i){const n=new W.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=Mi(ki,e,i),n}function Oi(e){const i=new W.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return i.topDicts=[{name:"topDict_0",type:"TABLE",value:e}],i}function ss(e){const i=[],n=e.path;i.push({name:"width",type:"NUMBER",value:e.advanceWidth});let a=0,C=0;for(let x=0;x<n.commands.length;x+=1){let k,M,R=n.commands[x];if(R.type==="Q"){const N=.3333333333333333,$=2/3;R={type:"C",x:R.x,y:R.y,x1:N*a+$*R.x1,y1:N*C+$*R.y1,x2:N*R.x+$*R.x1,y2:N*R.y+$*R.y1}}if(R.type==="M")k=Math.round(R.x-a),M=Math.round(R.y-C),i.push({name:"dx",type:"NUMBER",value:k}),i.push({name:"dy",type:"NUMBER",value:M}),i.push({name:"rmoveto",type:"OP",value:21}),a=Math.round(R.x),C=Math.round(R.y);else if(R.type==="L")k=Math.round(R.x-a),M=Math.round(R.y-C),i.push({name:"dx",type:"NUMBER",value:k}),i.push({name:"dy",type:"NUMBER",value:M}),i.push({name:"rlineto",type:"OP",value:5}),a=Math.round(R.x),C=Math.round(R.y);else if(R.type==="C"){const N=Math.round(R.x1-a),$=Math.round(R.y1-C),Y=Math.round(R.x2-R.x1),Z=Math.round(R.y2-R.y1);k=Math.round(R.x-R.x2),M=Math.round(R.y-R.y2),i.push({name:"dx1",type:"NUMBER",value:N}),i.push({name:"dy1",type:"NUMBER",value:$}),i.push({name:"dx2",type:"NUMBER",value:Y}),i.push({name:"dy2",type:"NUMBER",value:Z}),i.push({name:"dx",type:"NUMBER",value:k}),i.push({name:"dy",type:"NUMBER",value:M}),i.push({name:"rrcurveto",type:"OP",value:8}),a=Math.round(R.x),C=Math.round(R.y)}}return i.push({name:"endchar",type:"OP",value:14}),i}const ns=function(e,i,n){n.tables.cff={};const a=function(ae,ye){const oe={};return oe.formatMajor=fe.getCard8(ae,ye),oe.formatMinor=fe.getCard8(ae,ye+1),oe.size=fe.getCard8(ae,ye+2),oe.offsetSize=fe.getCard8(ae,ye+3),oe.startOffset=ye,oe.endOffset=ye+4,oe}(e,i),C=at(e,a.endOffset,fe.bytesToString),x=at(e,C.endOffset),k=at(e,x.endOffset,fe.bytesToString),M=at(e,k.endOffset);n.gsubrs=M.objects,n.gsubrsBias=Ft(n.gsubrs);const R=Ti(e,i,x.objects,k.objects);if(R.length!==1)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+R.length);const N=R[0];if(n.tables.cff.topDict=N,N._privateDict&&(n.defaultWidthX=N._privateDict.defaultWidthX,n.nominalWidthX=N._privateDict.nominalWidthX),N.ros[0]!==void 0&&N.ros[1]!==void 0&&(n.isCIDFont=!0),n.isCIDFont){let ae=N.fdArray,ye=N.fdSelect;if(ae===0||ye===0)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");ae+=i;const oe=Ti(e,i,at(e,ae).objects,k.objects);N._fdArray=oe,ye+=i,N._fdSelect=function(le,me,be,Ee){const _e=[];let ue;const ge=new fe.Parser(le,me),Te=ge.parseCard8();if(Te===0)for(let we=0;we<be;we++){if(ue=ge.parseCard8(),ue>=Ee)throw new Error("CFF table CID Font FDSelect has bad FD index value "+ue+" (FD count "+Ee+")");_e.push(ue)}else{if(Te!==3)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+Te);{const we=ge.parseCard16();let Ie,We=ge.parseCard16();if(We!==0)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+We);for(let qe=0;qe<we;qe++){if(ue=ge.parseCard8(),Ie=ge.parseCard16(),ue>=Ee)throw new Error("CFF table CID Font FDSelect has bad FD index value "+ue+" (FD count "+Ee+")");if(Ie>be)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+Ie);for(;We<Ie;We++)_e.push(ue);We=Ie}if(Ie!==be)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+Ie)}}return _e}(e,ye,n.numGlyphs,oe.length)}const $=i+N.private[1],Y=Ai(e,$,N.private[0],k.objects);if(n.defaultWidthX=Y.defaultWidthX,n.nominalWidthX=Y.nominalWidthX,Y.subrs!==0){const ae=at(e,$+Y.subrs);n.subrs=ae.objects,n.subrsBias=Ft(n.subrs)}else n.subrs=[],n.subrsBias=0;const Z=at(e,i+N.charStrings);n.nGlyphs=Z.objects.length;const de=function(ae,ye,oe,le){let me,be;const Ee=new fe.Parser(ae,ye);oe-=1;const _e=[".notdef"],ue=Ee.parseCard8();if(ue===0)for(let ge=0;ge<oe;ge+=1)me=Ee.parseSID(),_e.push(Ct(le,me));else if(ue===1)for(;_e.length<=oe;){me=Ee.parseSID(),be=Ee.parseCard8();for(let ge=0;ge<=be;ge+=1)_e.push(Ct(le,me)),me+=1}else{if(ue!==2)throw new Error("Unknown charset format "+ue);for(;_e.length<=oe;){me=Ee.parseSID(),be=Ee.parseCard16();for(let ge=0;ge<=be;ge+=1)_e.push(Ct(le,me)),me+=1}}return _e}(e,i+N.charset,n.nGlyphs,k.objects);N.encoding===0?n.cffEncoding=new Qe(Ce,de):N.encoding===1?n.cffEncoding=new Qe(Ae,de):n.cffEncoding=function(ae,ye,oe){let le;const me={},be=new fe.Parser(ae,ye),Ee=be.parseCard8();if(Ee===0){const _e=be.parseCard8();for(let ue=0;ue<_e;ue+=1)le=be.parseCard8(),me[le]=ue}else{if(Ee!==1)throw new Error("Unknown encoding format "+Ee);{const _e=be.parseCard8();le=1;for(let ue=0;ue<_e;ue+=1){const ge=be.parseCard8(),Te=be.parseCard8();for(let we=ge;we<=ge+Te;we+=1)me[we]=le,le+=1}}}return new Qe(me,oe)}(e,i+N.encoding,de),n.encoding=n.encoding||n.cffEncoding,n.glyphs=new _t.GlyphSet(n);for(let ae=0;ae<n.nGlyphs;ae+=1){const ye=Z.objects[ae];n.glyphs.push(ae,_t.cffGlyphLoader(n,ae,rs,ye))}},os=function(e,i){const n=new W.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),a=1/i.unitsPerEm,C={version:i.version,fullName:i.fullName,familyName:i.familyName,weight:i.weightName,fontBBox:i.fontBBox||[0,0,0,0],fontMatrix:[a,0,0,a,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},x=[];let k;for(let $=1;$<e.length;$+=1)k=e.get($),x.push(k.name);const M=[];n.header=new W.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),n.nameIndex=function($){const Y=new W.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);Y.names=[];for(let Z=0;Z<$.length;Z+=1)Y.names.push({name:"name_"+Z,type:"NAME",value:$[Z]});return Y}([i.postScriptName]);let R=Bi(C,M);n.topDictIndex=Oi(R),n.globalSubrIndex=new W.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),n.charsets=function($,Y){const Z=new W.Record("Charsets",[{name:"format",type:"Card8",value:0}]);for(let de=0;de<$.length;de+=1){const ae=Di($[de],Y);Z.fields.push({name:"glyph_"+de,type:"SID",value:ae})}return Z}(x,M),n.charStringsIndex=function($){const Y=new W.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]);for(let Z=0;Z<$.length;Z+=1){const de=$.get(Z),ae=ss(de);Y.charStrings.push({name:de.name,type:"CHARSTRING",value:ae})}return Y}(e),n.privateDict=function($,Y){const Z=new W.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return Z.dict=Mi(Ri,{},Y),Z}(0,M),n.stringIndex=function($){const Y=new W.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);Y.strings=[];for(let Z=0;Z<$.length;Z+=1)Y.strings.push({name:"string_"+Z,type:"STRING",value:$[Z]});return Y}(M);const N=n.header.sizeOf()+n.nameIndex.sizeOf()+n.topDictIndex.sizeOf()+n.stringIndex.sizeOf()+n.globalSubrIndex.sizeOf();return C.charset=N,C.encoding=0,C.charStrings=C.charset+n.charsets.sizeOf(),C.private[1]=C.charStrings+n.charStringsIndex.sizeOf(),R=Bi(C,M),n.topDictIndex=Oi(R),n},as=function(e,i){const n={},a=new fe.Parser(e,i);return n.version=a.parseVersion(),n.fontRevision=Math.round(1e3*a.parseFixed())/1e3,n.checkSumAdjustment=a.parseULong(),n.magicNumber=a.parseULong(),g.argument(n.magicNumber===1594834165,"Font header has wrong magic number."),n.flags=a.parseUShort(),n.unitsPerEm=a.parseUShort(),n.created=a.parseLongDateTime(),n.modified=a.parseLongDateTime(),n.xMin=a.parseShort(),n.yMin=a.parseShort(),n.xMax=a.parseShort(),n.yMax=a.parseShort(),n.macStyle=a.parseUShort(),n.lowestRecPPEM=a.parseUShort(),n.fontDirectionHint=a.parseShort(),n.indexToLocFormat=a.parseShort(),n.glyphDataFormat=a.parseShort(),n},ls=function(e){const i=Math.round(new Date().getTime()/1e3)+2082844800;let n=i;return e.createdTimestamp&&(n=e.createdTimestamp+2082844800),new W.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:n},{name:"modified",type:"LONGDATETIME",value:i},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],e)},cs=function(e,i){const n={},a=new fe.Parser(e,i);return n.version=a.parseVersion(),n.ascender=a.parseShort(),n.descender=a.parseShort(),n.lineGap=a.parseShort(),n.advanceWidthMax=a.parseUShort(),n.minLeftSideBearing=a.parseShort(),n.minRightSideBearing=a.parseShort(),n.xMaxExtent=a.parseShort(),n.caretSlopeRise=a.parseShort(),n.caretSlopeRun=a.parseShort(),n.caretOffset=a.parseShort(),a.relativeOffset+=8,n.metricDataFormat=a.parseShort(),n.numberOfHMetrics=a.parseUShort(),n},hs=function(e){return new W.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],e)},us=function(e,i,n,a,C){let x,k;const M=new fe.Parser(e,i);for(let R=0;R<a;R+=1){R<n&&(x=M.parseUShort(),k=M.parseShort());const N=C.get(R);N.advanceWidth=x,N.leftSideBearing=k}},ds=function(e){const i=new W.Table("hmtx",[]);for(let n=0;n<e.length;n+=1){const a=e.get(n),C=a.advanceWidth||0,x=a.leftSideBearing||0;i.fields.push({name:"advanceWidth_"+n,type:"USHORT",value:C}),i.fields.push({name:"leftSideBearing_"+n,type:"SHORT",value:x})}return i},fs=function(e){const i=new W.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:e.length}]);let n="";const a=12+4*e.length;for(let C=0;C<e.length;++C){let x=n.indexOf(e[C]);x<0&&(x=n.length,n+=e[C]),i.fields.push({name:"offset "+C,type:"USHORT",value:a+x}),i.fields.push({name:"length "+C,type:"USHORT",value:e[C].length})}return i.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),i},ps=function(e,i){const n=new fe.Parser(e,i),a=n.parseULong();g.argument(a===1,"Unsupported ltag table version."),n.skip("uLong",1);const C=n.parseULong(),x=[];for(let k=0;k<C;k++){let M="";const R=i+n.parseUShort(),N=n.parseUShort();for(let $=R;$<R+N;++$)M+=String.fromCharCode(e.getInt8($));x.push(M)}return x},_s=function(e,i){const n={},a=new fe.Parser(e,i);return n.version=a.parseVersion(),n.numGlyphs=a.parseUShort(),n.version===1&&(n.maxPoints=a.parseUShort(),n.maxContours=a.parseUShort(),n.maxCompositePoints=a.parseUShort(),n.maxCompositeContours=a.parseUShort(),n.maxZones=a.parseUShort(),n.maxTwilightPoints=a.parseUShort(),n.maxStorage=a.parseUShort(),n.maxFunctionDefs=a.parseUShort(),n.maxInstructionDefs=a.parseUShort(),n.maxStackElements=a.parseUShort(),n.maxSizeOfInstructions=a.parseUShort(),n.maxComponentElements=a.parseUShort(),n.maxComponentDepth=a.parseUShort()),n},gs=function(e){return new W.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:e}])},Ii=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],Pi={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},vs={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},Ui={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function ms(e,i,n){switch(e){case 0:if(i===65535)return"und";if(n)return n[i];break;case 1:return Pi[i];case 3:return Ui[i]}}const Ht="utf-16",ys={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Ss={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function Fi(e,i,n){switch(e){case 0:return Ht;case 1:return Ss[n]||ys[i];case 3:if(i===1||i===10)return Ht}}function Nt(e){const i={};for(let n in e)i[e[n]]=parseInt(n);return i}function Hi(e,i,n,a,C,x){return new W.Record("NameRecord",[{name:"platformID",type:"USHORT",value:e},{name:"encodingID",type:"USHORT",value:i},{name:"languageID",type:"USHORT",value:n},{name:"nameID",type:"USHORT",value:a},{name:"length",type:"USHORT",value:C},{name:"offset",type:"USHORT",value:x}])}function Ni(e,i){let n=function(a,C){const x=a.length,k=C.length-x+1;e:for(let M=0;M<k;M++)for(;M<k;M++){for(let R=0;R<x;R++)if(C[M+R]!==a[R])continue e;return M}return-1}(e,i);if(n<0){n=i.length;let a=0;const C=e.length;for(;a<C;++a)i.push(e[a])}return n}const bs=function(e,i,n){const a={},C=new fe.Parser(e,i),x=C.parseUShort(),k=C.parseUShort(),M=C.offset+C.parseUShort();for(let R=0;R<k;R++){const N=C.parseUShort(),$=C.parseUShort(),Y=C.parseUShort(),Z=C.parseUShort(),de=Ii[Z]||Z,ae=C.parseUShort(),ye=C.parseUShort(),oe=ms(N,Y,n),le=Fi(N,$,Y);if(le!==void 0&&oe!==void 0){let me;if(me=le===Ht?v.UTF16(e,M+ye,ae):v.MACSTRING(e,M+ye,ae,le),me){let be=a[de];be===void 0&&(be=a[de]={}),be[oe]=me}}}return x===1&&C.parseUShort(),a},Cs=function(e,i){let n;const a=[],C={},x=Nt(Ii);for(let Y in e){let Z=x[Y];if(Z===void 0&&(Z=Y),n=parseInt(Z),isNaN(n))throw new Error('Name table entry "'+Y+'" does not exist, see nameTableNames for complete list.');C[n]=e[Y],a.push(n)}const k=Nt(Pi),M=Nt(Ui),R=[],N=[];for(let Y=0;Y<a.length;Y++){n=a[Y];const Z=C[n];for(let de in Z){const ae=Z[de];let ye=1,oe=k[de],le=vs[oe];const me=Fi(ye,le,oe);let be=b.MACSTRING(ae,me);be===void 0&&(ye=0,oe=i.indexOf(de),oe<0&&(oe=i.length,i.push(de)),le=4,be=b.UTF16(ae));const Ee=Ni(be,N);R.push(Hi(ye,le,oe,n,be.length,Ee));const _e=M[de];if(_e!==void 0){const ue=b.UTF16(ae),ge=Ni(ue,N);R.push(Hi(3,1,_e,n,ue.length,ge))}}}R.sort(function(Y,Z){return Y.platformID-Z.platformID||Y.encodingID-Z.encodingID||Y.languageID-Z.languageID||Y.nameID-Z.nameID});const $=new W.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:R.length},{name:"stringOffset",type:"USHORT",value:6+12*R.length}]);for(let Y=0;Y<R.length;Y++)$.fields.push({name:"record_"+Y,type:"RECORD",value:R[Y]});return $.fields.push({name:"strings",type:"LITERAL",value:N}),$},Wi=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}],ws=function(e,i){const n={},a=new fe.Parser(e,i);n.version=a.parseUShort(),n.xAvgCharWidth=a.parseShort(),n.usWeightClass=a.parseUShort(),n.usWidthClass=a.parseUShort(),n.fsType=a.parseUShort(),n.ySubscriptXSize=a.parseShort(),n.ySubscriptYSize=a.parseShort(),n.ySubscriptXOffset=a.parseShort(),n.ySubscriptYOffset=a.parseShort(),n.ySuperscriptXSize=a.parseShort(),n.ySuperscriptYSize=a.parseShort(),n.ySuperscriptXOffset=a.parseShort(),n.ySuperscriptYOffset=a.parseShort(),n.yStrikeoutSize=a.parseShort(),n.yStrikeoutPosition=a.parseShort(),n.sFamilyClass=a.parseShort(),n.panose=[];for(let C=0;C<10;C++)n.panose[C]=a.parseByte();return n.ulUnicodeRange1=a.parseULong(),n.ulUnicodeRange2=a.parseULong(),n.ulUnicodeRange3=a.parseULong(),n.ulUnicodeRange4=a.parseULong(),n.achVendID=String.fromCharCode(a.parseByte(),a.parseByte(),a.parseByte(),a.parseByte()),n.fsSelection=a.parseUShort(),n.usFirstCharIndex=a.parseUShort(),n.usLastCharIndex=a.parseUShort(),n.sTypoAscender=a.parseShort(),n.sTypoDescender=a.parseShort(),n.sTypoLineGap=a.parseShort(),n.usWinAscent=a.parseUShort(),n.usWinDescent=a.parseUShort(),n.version>=1&&(n.ulCodePageRange1=a.parseULong(),n.ulCodePageRange2=a.parseULong()),n.version>=2&&(n.sxHeight=a.parseShort(),n.sCapHeight=a.parseShort(),n.usDefaultChar=a.parseUShort(),n.usBreakChar=a.parseUShort(),n.usMaxContent=a.parseUShort()),n},xs=function(e){return new W.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],e)},Ls=function(e){for(let i=0;i<Wi.length;i+=1){const n=Wi[i];if(e>=n.begin&&e<n.end)return i}return-1},Es=function(e,i){const n={},a=new fe.Parser(e,i);switch(n.version=a.parseVersion(),n.italicAngle=a.parseFixed(),n.underlinePosition=a.parseShort(),n.underlineThickness=a.parseShort(),n.isFixedPitch=a.parseULong(),n.minMemType42=a.parseULong(),n.maxMemType42=a.parseULong(),n.minMemType1=a.parseULong(),n.maxMemType1=a.parseULong(),n.version){case 1:n.names=Pe.slice();break;case 2:n.numberOfGlyphs=a.parseUShort(),n.glyphNameIndex=new Array(n.numberOfGlyphs);for(let C=0;C<n.numberOfGlyphs;C++)n.glyphNameIndex[C]=a.parseUShort();n.names=[];for(let C=0;C<n.numberOfGlyphs;C++)if(n.glyphNameIndex[C]>=Pe.length){const x=a.parseChar();n.names.push(a.parseString(x))}break;case 2.5:n.numberOfGlyphs=a.parseUShort(),n.offset=new Array(n.numberOfGlyphs);for(let C=0;C<n.numberOfGlyphs;C++)n.offset[C]=a.parseChar()}return n},ks=function(){return new W.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])},Ye=new Array(9);Ye[1]=function(){const e=this.offset+this.relativeOffset,i=this.parseUShort();return i===1?{substFormat:1,coverage:this.parsePointer(Q.coverage),deltaGlyphId:this.parseUShort()}:i===2?{substFormat:2,coverage:this.parsePointer(Q.coverage),substitute:this.parseOffset16List()}:void g.assert(!1,"0x"+e.toString(16)+": lookup type 1 format must be 1 or 2.")},Ye[2]=function(){const e=this.parseUShort();return g.argument(e===1,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(Q.coverage),sequences:this.parseListOfLists()}},Ye[3]=function(){const e=this.parseUShort();return g.argument(e===1,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(Q.coverage),alternateSets:this.parseListOfLists()}},Ye[4]=function(){const e=this.parseUShort();return g.argument(e===1,"GSUB ligature table identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(Q.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};const gt={sequenceIndex:Q.uShort,lookupListIndex:Q.uShort};Ye[5]=function(){const e=this.offset+this.relativeOffset,i=this.parseUShort();if(i===1)return{substFormat:i,coverage:this.parsePointer(Q.coverage),ruleSets:this.parseListOfLists(function(){const n=this.parseUShort(),a=this.parseUShort();return{input:this.parseUShortList(n-1),lookupRecords:this.parseRecordList(a,gt)}})};if(i===2)return{substFormat:i,coverage:this.parsePointer(Q.coverage),classDef:this.parsePointer(Q.classDef),classSets:this.parseListOfLists(function(){const n=this.parseUShort(),a=this.parseUShort();return{classes:this.parseUShortList(n-1),lookupRecords:this.parseRecordList(a,gt)}})};if(i===3){const n=this.parseUShort(),a=this.parseUShort();return{substFormat:i,coverages:this.parseList(n,Q.pointer(Q.coverage)),lookupRecords:this.parseRecordList(a,gt)}}g.assert(!1,"0x"+e.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},Ye[6]=function(){const e=this.offset+this.relativeOffset,i=this.parseUShort();return i===1?{substFormat:1,coverage:this.parsePointer(Q.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(gt)}})}:i===2?{substFormat:2,coverage:this.parsePointer(Q.coverage),backtrackClassDef:this.parsePointer(Q.classDef),inputClassDef:this.parsePointer(Q.classDef),lookaheadClassDef:this.parsePointer(Q.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(gt)}})}:i===3?{substFormat:3,backtrackCoverage:this.parseList(Q.pointer(Q.coverage)),inputCoverage:this.parseList(Q.pointer(Q.coverage)),lookaheadCoverage:this.parseList(Q.pointer(Q.coverage)),lookupRecords:this.parseRecordList(gt)}:void g.assert(!1,"0x"+e.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},Ye[7]=function(){const e=this.parseUShort();g.argument(e===1,"GSUB Extension Substitution subtable identifier-format must be 1");const i=this.parseUShort(),n=new Q(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:i,extension:Ye[i].call(n)}},Ye[8]=function(){const e=this.parseUShort();return g.argument(e===1,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(Q.coverage),backtrackCoverage:this.parseList(Q.pointer(Q.coverage)),lookaheadCoverage:this.parseList(Q.pointer(Q.coverage)),substitutes:this.parseUShortList()}};const At=new Array(9);At[1]=function(e){return e.substFormat===1?new W.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new W.Coverage(e.coverage)},{name:"deltaGlyphID",type:"USHORT",value:e.deltaGlyphId}]):new W.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new W.Coverage(e.coverage)}].concat(W.ushortList("substitute",e.substitute)))},At[3]=function(e){return g.assert(e.substFormat===1,"Lookup type 3 substFormat must be 1."),new W.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new W.Coverage(e.coverage)}].concat(W.tableList("altSet",e.alternateSets,function(i){return new W.Table("alternateSetTable",W.ushortList("alternate",i))})))},At[4]=function(e){return g.assert(e.substFormat===1,"Lookup type 4 substFormat must be 1."),new W.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new W.Coverage(e.coverage)}].concat(W.tableList("ligSet",e.ligatureSets,function(i){return new W.Table("ligatureSetTable",W.tableList("ligature",i,function(n){return new W.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:n.ligGlyph}].concat(W.ushortList("component",n.components,n.components.length+1)))}))})))};const Rs=function(e,i){const n=new Q(e,i=i||0),a=n.parseVersion(1);return g.argument(a===1||a===1.1,"Unsupported GSUB table version."),a===1?{version:a,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Ye)}:{version:a,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Ye),variations:n.parseFeatureVariationsList()}},As=function(e){return new W.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new W.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new W.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new W.LookupList(e.lookups,At)}])},Ts=function(e,i){const n=new fe.Parser(e,i),a=n.parseULong();g.argument(a===1,"Unsupported META table version."),n.parseULong(),n.parseULong();const C=n.parseULong(),x={};for(let k=0;k<C;k++){const M=n.parseTag(),R=n.parseULong(),N=n.parseULong(),$=v.UTF8(e,i+R,N);x[M]=$}return x},Ds=function(e){const i=Object.keys(e).length;let n="";const a=16+12*i,C=new W.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:a},{name:"numTags",type:"ULONG",value:i}]);for(let x in e){const k=n.length;n+=e[x],C.fields.push({name:"tag "+x,type:"TAG",value:x}),C.fields.push({name:"offset "+x,type:"ULONG",value:a+k}),C.fields.push({name:"length "+x,type:"ULONG",value:e[x].length})}return C.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),C};function Gi(e){return Math.log(e)/Math.log(2)|0}function ji(e){for(;e.length%4!=0;)e.push(0);let i=0;for(let n=0;n<e.length;n+=4)i+=(e[n]<<24)+(e[n+1]<<16)+(e[n+2]<<8)+e[n+3];return i%=Math.pow(2,32),i}function zi(e,i,n,a){return new W.Record("Table Record",[{name:"tag",type:"TAG",value:e!==void 0?e:""},{name:"checkSum",type:"ULONG",value:i!==void 0?i:0},{name:"offset",type:"ULONG",value:n!==void 0?n:0},{name:"length",type:"ULONG",value:a!==void 0?a:0}])}function Ms(e){const i=new W.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);i.tables=e,i.numTables=e.length;const n=Math.pow(2,Gi(i.numTables));i.searchRange=16*n,i.entrySelector=Gi(n),i.rangeShift=16*i.numTables-i.searchRange;const a=[],C=[];let x=i.sizeOf()+zi().sizeOf()*i.numTables;for(;x%4!=0;)x+=1,C.push({name:"padding",type:"BYTE",value:0});for(let k=0;k<e.length;k+=1){const M=e[k];g.argument(M.tableName.length===4,"Table name"+M.tableName+" is invalid.");const R=M.sizeOf(),N=zi(M.tableName,ji(M.encode()),x,R);for(a.push({name:N.tag+" Table Record",type:"RECORD",value:N}),C.push({name:M.tableName+" table",type:"RECORD",value:M}),x+=R,g.argument(!isNaN(x),"Something went wrong calculating the offset.");x%4!=0;)x+=1,C.push({name:"padding",type:"BYTE",value:0})}return a.sort(function(k,M){return k.value.tag>M.value.tag?1:-1}),i.fields=i.fields.concat(a),i.fields=i.fields.concat(C),i}function $i(e,i,n){for(let a=0;a<i.length;a+=1){const C=e.charToGlyphIndex(i[a]);if(C>0)return e.glyphs.get(C).getMetrics()}return n}function Bs(e){let i=0;for(let n=0;n<e.length;n+=1)i+=e[n];return i/e.length}const Os=function(e){const i=[],n=[],a=[],C=[],x=[],k=[],M=[];let R,N=0,$=0,Y=0,Z=0,de=0;for(let Xe=0;Xe<e.glyphs.length;Xe+=1){const mt=e.glyphs.get(Xe),yt=0|mt.unicode;if(isNaN(mt.advanceWidth))throw new Error("Glyph "+mt.name+" ("+Xe+"): advanceWidth is not a number.");(R>yt||R===void 0)&&yt>0&&(R=yt),N<yt&&(N=yt);const ut=Ls(yt);if(ut<32)$|=1<<ut;else if(ut<64)Y|=1<<ut-32;else if(ut<96)Z|=1<<ut-64;else{if(!(ut<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");de|=1<<ut-96}if(mt.name===".notdef")continue;const St=mt.getMetrics();i.push(St.xMin),n.push(St.yMin),a.push(St.xMax),C.push(St.yMax),k.push(St.leftSideBearing),M.push(St.rightSideBearing),x.push(mt.advanceWidth)}const ae={xMin:Math.min.apply(null,i),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,a),yMax:Math.max.apply(null,C),advanceWidthMax:Math.max.apply(null,x),advanceWidthAvg:Bs(x),minLeftSideBearing:Math.min.apply(null,k),maxLeftSideBearing:Math.max.apply(null,k),minRightSideBearing:Math.min.apply(null,M)};ae.ascender=e.ascender,ae.descender=e.descender;const ye=ls({flags:3,unitsPerEm:e.unitsPerEm,xMin:ae.xMin,yMin:ae.yMin,xMax:ae.xMax,yMax:ae.yMax,lowestRecPPEM:3,createdTimestamp:e.createdTimestamp}),oe=hs({ascender:ae.ascender,descender:ae.descender,advanceWidthMax:ae.advanceWidthMax,minLeftSideBearing:ae.minLeftSideBearing,minRightSideBearing:ae.minRightSideBearing,xMaxExtent:ae.maxLeftSideBearing+(ae.xMax-ae.xMin),numberOfHMetrics:e.glyphs.length}),le=gs(e.glyphs.length),me=xs({xAvgCharWidth:Math.round(ae.advanceWidthAvg),usWeightClass:e.tables.os2.usWeightClass,usWidthClass:e.tables.os2.usWidthClass,usFirstCharIndex:R,usLastCharIndex:N,ulUnicodeRange1:$,ulUnicodeRange2:Y,ulUnicodeRange3:Z,ulUnicodeRange4:de,fsSelection:e.tables.os2.fsSelection,sTypoAscender:ae.ascender,sTypoDescender:ae.descender,sTypoLineGap:0,usWinAscent:ae.yMax,usWinDescent:Math.abs(ae.yMin),ulCodePageRange1:1,sxHeight:$i(e,"xyvw",{yMax:Math.round(ae.ascender/2)}).yMax,sCapHeight:$i(e,"HIKLEFJMNTZBDPRAGOQSUVWXY",ae).yMax,usDefaultChar:e.hasChar(" ")?32:0,usBreakChar:e.hasChar(" ")?32:0}),be=ds(e.glyphs),Ee=ie(e.glyphs),_e=e.getEnglishName("fontFamily"),ue=e.getEnglishName("fontSubfamily"),ge=_e+" "+ue;let Te=e.getEnglishName("postScriptName");Te||(Te=_e.replace(/\s/g,"")+"-"+ue);const we={};for(let Xe in e.names)we[Xe]=e.names[Xe];we.uniqueID||(we.uniqueID={en:e.getEnglishName("manufacturer")+":"+ge}),we.postScriptName||(we.postScriptName={en:Te}),we.preferredFamily||(we.preferredFamily=e.names.fontFamily),we.preferredSubfamily||(we.preferredSubfamily=e.names.fontSubfamily);const Ie=[],We=Cs(we,Ie),qe=Ie.length>0?fs(Ie):void 0,Fe=ks(),ze=os(e.glyphs,{version:e.getEnglishName("version"),fullName:ge,familyName:_e,weightName:ue,postScriptName:Te,unitsPerEm:e.unitsPerEm,fontBBox:[0,ae.yMin,ae.ascender,ae.advanceWidthMax]}),Ue=e.metas&&Object.keys(e.metas).length>0?Ds(e.metas):void 0,Ge=[ye,oe,le,me,We,Ee,Fe,ze,be];qe&&Ge.push(qe),e.tables.gsub&&Ge.push(As(e.tables.gsub)),Ue&&Ge.push(Ue);const He=Ms(Ge),Ke=ji(He.encode()),Be=He.fields;let $e=!1;for(let Xe=0;Xe<Be.length;Xe+=1)if(Be[Xe].name==="head table"){Be[Xe].value.checkSumAdjustment=2981146554-Ke,$e=!0;break}if(!$e)throw new Error("Could not find head table with checkSum to adjust.");return He};function Wt(e,i){let n=0,a=e.length-1;for(;n<=a;){const C=n+a>>>1,x=e[C].tag;if(x===i)return C;x<i?n=C+1:a=C-1}return-n-1}function qi(e,i){let n=0,a=e.length-1;for(;n<=a;){const C=n+a>>>1,x=e[C];if(x===i)return C;x<i?n=C+1:a=C-1}return-n-1}function Vi(e,i){let n,a=0,C=e.length-1;for(;a<=C;){const x=a+C>>>1;n=e[x];const k=n.start;if(k===i)return n;k<i?a=x+1:C=x-1}if(a>0)return n=e[a-1],i>n.end?0:n}function Ki(e,i){this.font=e,this.tableName=i}Ki.prototype={searchTag:Wt,binSearch:qi,getTable:function(e){let i=this.font.tables[this.tableName];return!i&&e&&(i=this.font.tables[this.tableName]=this.createDefaultTable()),i},getScriptNames:function(){let e=this.getTable();return e?e.scripts.map(function(i){return i.tag}):[]},getDefaultScriptName:function(){let e=this.getTable();if(!e)return;let i=!1;for(let n=0;n<e.scripts.length;n++){const a=e.scripts[n].tag;if(a==="DFLT")return a;a==="latn"&&(i=!0)}return i?"latn":void 0},getScriptTable:function(e,i){const n=this.getTable(i);if(n){e=e||"DFLT";const a=n.scripts,C=Wt(n.scripts,e);if(C>=0)return a[C].script;if(i){const x={tag:e,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return a.splice(-1-C,0,x),x.script}}},getLangSysTable:function(e,i,n){const a=this.getScriptTable(e,n);if(a){if(!i||i==="dflt"||i==="DFLT")return a.defaultLangSys;const C=Wt(a.langSysRecords,i);if(C>=0)return a.langSysRecords[C].langSys;if(n){const x={tag:i,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return a.langSysRecords.splice(-1-C,0,x),x.langSys}}},getFeatureTable:function(e,i,n,a){const C=this.getLangSysTable(e,i,a);if(C){let x;const k=C.featureIndexes,M=this.font.tables[this.tableName].features;for(let R=0;R<k.length;R++)if(x=M[k[R]],x.tag===n)return x.feature;if(a){const R=M.length;return g.assert(R===0||n>=M[R-1].tag,"Features must be added in alphabetical order."),x={tag:n,feature:{params:0,lookupListIndexes:[]}},M.push(x),k.push(R),x.feature}}},getLookupTables:function(e,i,n,a,C){const x=this.getFeatureTable(e,i,n,C),k=[];if(x){let M;const R=x.lookupListIndexes,N=this.font.tables[this.tableName].lookups;for(let $=0;$<R.length;$++)M=N[R[$]],M.lookupType===a&&k.push(M);if(k.length===0&&C){M={lookupType:a,lookupFlag:0,subtables:[],markFilteringSet:void 0};const $=N.length;return N.push(M),R.push($),[M]}}return k},getGlyphClass:function(e,i){switch(e.format){case 1:return e.startGlyph<=i&&i<e.startGlyph+e.classes.length?e.classes[i-e.startGlyph]:0;case 2:const n=Vi(e.ranges,i);return n?n.classId:0}},getCoverageIndex:function(e,i){switch(e.format){case 1:const n=qi(e.glyphs,i);return n>=0?n:-1;case 2:const a=Vi(e.ranges,i);return a?a.index+i-a.start:-1}},expandCoverage:function(e){if(e.format===1)return e.glyphs;{const i=[],n=e.ranges;for(let a=0;a<n.length;a++){const C=n[a],x=C.start,k=C.end;for(let M=x;M<=k;M++)i.push(M)}return i}}};const Tt=Ki;function Dt(e){Tt.call(this,e,"gpos")}Dt.prototype=Tt.prototype,Dt.prototype.getKerningValue=function(e,i,n){for(let a=0;a<e.length;a++){const C=e[a].subtables;for(let x=0;x<C.length;x++){const k=C[x],M=this.getCoverageIndex(k.coverage,i);if(!(M<0))switch(k.posFormat){case 1:let R=k.pairSets[M];for(let Z=0;Z<R.length;Z++){let de=R[Z];if(de.secondGlyph===n)return de.value1&&de.value1.xAdvance||0}break;case 2:const N=this.getGlyphClass(k.classDef1,i),$=this.getGlyphClass(k.classDef2,n),Y=k.classRecords[N][$];return Y.value1&&Y.value1.xAdvance||0}}}return 0},Dt.prototype.getKerningTables=function(e,i){if(this.font.tables.gpos)return this.getLookupTables(e,i,"kern",2)};const Is=Dt;function Ze(e){Tt.call(this,e,"gsub")}function Ps(e,i){const n=e.length;if(n!==i.length)return!1;for(let a=0;a<n;a++)if(e[a]!==i[a])return!1;return!0}function Xi(e,i,n){const a=e.subtables;for(let C=0;C<a.length;C++){const x=a[C];if(x.substFormat===i)return x}if(n)return a.push(n),n}Ze.prototype=Tt.prototype,Ze.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},Ze.prototype.getSingle=function(e,i,n){const a=[],C=this.getLookupTables(i,n,e,1);for(let x=0;x<C.length;x++){const k=C[x].subtables;for(let M=0;M<k.length;M++){const R=k[M],N=this.expandCoverage(R.coverage);let $;if(R.substFormat===1){const Y=R.deltaGlyphId;for($=0;$<N.length;$++){const Z=N[$];a.push({sub:Z,by:Z+Y})}}else{const Y=R.substitute;for($=0;$<N.length;$++)a.push({sub:N[$],by:Y[$]})}}}return a},Ze.prototype.getAlternates=function(e,i,n){const a=[],C=this.getLookupTables(i,n,e,3);for(let x=0;x<C.length;x++){const k=C[x].subtables;for(let M=0;M<k.length;M++){const R=k[M],N=this.expandCoverage(R.coverage),$=R.alternateSets;for(let Y=0;Y<N.length;Y++)a.push({sub:N[Y],by:$[Y]})}}return a},Ze.prototype.getLigatures=function(e,i,n){const a=[],C=this.getLookupTables(i,n,e,4);for(let x=0;x<C.length;x++){const k=C[x].subtables;for(let M=0;M<k.length;M++){const R=k[M],N=this.expandCoverage(R.coverage),$=R.ligatureSets;for(let Y=0;Y<N.length;Y++){const Z=N[Y],de=$[Y];for(let ae=0;ae<de.length;ae++){const ye=de[ae];a.push({sub:[Z].concat(ye.components),by:ye.ligGlyph})}}}}return a},Ze.prototype.addSingle=function(e,i,n,a){const C=Xi(this.getLookupTables(n,a,e,1,!0)[0],2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});g.assert(C.coverage.format===1,"Ligature: unable to modify coverage table format "+C.coverage.format);const x=i.sub;let k=this.binSearch(C.coverage.glyphs,x);k<0&&(k=-1-k,C.coverage.glyphs.splice(k,0,x),C.substitute.splice(k,0,0)),C.substitute[k]=i.by},Ze.prototype.addAlternate=function(e,i,n,a){const C=Xi(this.getLookupTables(n,a,e,3,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});g.assert(C.coverage.format===1,"Ligature: unable to modify coverage table format "+C.coverage.format);const x=i.sub;let k=this.binSearch(C.coverage.glyphs,x);k<0&&(k=-1-k,C.coverage.glyphs.splice(k,0,x),C.alternateSets.splice(k,0,0)),C.alternateSets[k]=i.by},Ze.prototype.addLigature=function(e,i,n,a){const C=this.getLookupTables(n,a,e,4,!0)[0];let x=C.subtables[0];x||(x={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},C.subtables[0]=x),g.assert(x.coverage.format===1,"Ligature: unable to modify coverage table format "+x.coverage.format);const k=i.sub[0],M=i.sub.slice(1),R={ligGlyph:i.by,components:M};let N=this.binSearch(x.coverage.glyphs,k);if(N>=0){const $=x.ligatureSets[N];for(let Y=0;Y<$.length;Y++)if(Ps($[Y].components,M))return;$.push(R)}else N=-1-N,x.coverage.glyphs.splice(N,0,k),x.ligatureSets.splice(N,0,[R])},Ze.prototype.getFeature=function(e,i,n){if(/ss\d\d/.test(e))return this.getSingle(e,i,n);switch(e){case"aalt":case"salt":return this.getSingle(e,i,n).concat(this.getAlternates(e,i,n));case"dlig":case"liga":case"rlig":return this.getLigatures(e,i,n)}},Ze.prototype.add=function(e,i,n,a){if(/ss\d\d/.test(e))return this.addSingle(e,i,n,a);switch(e){case"aalt":case"salt":return typeof i.by=="number"?this.addSingle(e,i,n,a):this.addAlternate(e,i,n,a);case"dlig":case"liga":case"rlig":return this.addLigature(e,i,n,a)}};const Us=Ze;function Yi(e){const i=new ArrayBuffer(e.length),n=new Uint8Array(i);for(let a=0;a<e.length;++a)n[a]=e[a];return i}function vt(e,i){if(!e)throw i}let Zi,pt,Ji,Gt;function Qi(e){this.font=e,this._fpgmState=this._prepState=void 0,this._errorState=0}function Fs(e){return e}function er(e){return Math.sign(e)*Math.round(Math.abs(e))}function Hs(e){return Math.sign(e)*Math.round(Math.abs(2*e))/2}function Ns(e){return Math.sign(e)*(Math.round(Math.abs(e)+.5)-.5)}function Ws(e){return Math.sign(e)*Math.ceil(Math.abs(e))}function Gs(e){return Math.sign(e)*Math.floor(Math.abs(e))}const tr=function(e){const i=this.srPeriod;let n=this.srPhase,a=1;return e<0&&(e=-e,a=-1),e+=this.srThreshold-n,e=Math.trunc(e/i)*i,(e+=n)<0?n*a:e*a},tt={x:1,y:0,axis:"x",distance:function(e,i,n,a){return(n?e.xo:e.x)-(a?i.xo:i.x)},interpolate:function(e,i,n,a){let C,x,k,M,R,N,$;if(!a||a===this)return C=e.xo-i.xo,x=e.xo-n.xo,R=i.x-i.xo,N=n.x-n.xo,k=Math.abs(C),M=Math.abs(x),$=k+M,$===0?void(e.x=e.xo+(R+N)/2):void(e.x=e.xo+(R*M+N*k)/$);C=a.distance(e,i,!0,!0),x=a.distance(e,n,!0,!0),R=a.distance(i,i,!1,!0),N=a.distance(n,n,!1,!0),k=Math.abs(C),M=Math.abs(x),$=k+M,$!==0?tt.setRelative(e,e,(R*M+N*k)/$,a,!0):tt.setRelative(e,e,(R+N)/2,a,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(e,i,n,a,C){if(!a||a===this)return void(e.x=(C?i.xo:i.x)+n);const x=C?i.xo:i.x,k=C?i.yo:i.y,M=x+n*a.x,R=k+n*a.y;e.x=M+(e.y-R)/a.normalSlope},slope:0,touch:function(e){e.xTouched=!0},touched:function(e){return e.xTouched},untouch:function(e){e.xTouched=!1}},it={x:0,y:1,axis:"y",distance:function(e,i,n,a){return(n?e.yo:e.y)-(a?i.yo:i.y)},interpolate:function(e,i,n,a){let C,x,k,M,R,N,$;if(!a||a===this)return C=e.yo-i.yo,x=e.yo-n.yo,R=i.y-i.yo,N=n.y-n.yo,k=Math.abs(C),M=Math.abs(x),$=k+M,$===0?void(e.y=e.yo+(R+N)/2):void(e.y=e.yo+(R*M+N*k)/$);C=a.distance(e,i,!0,!0),x=a.distance(e,n,!0,!0),R=a.distance(i,i,!1,!0),N=a.distance(n,n,!1,!0),k=Math.abs(C),M=Math.abs(x),$=k+M,$!==0?it.setRelative(e,e,(R*M+N*k)/$,a,!0):it.setRelative(e,e,(R+N)/2,a,!0)},normalSlope:0,setRelative:function(e,i,n,a,C){if(!a||a===this)return void(e.y=(C?i.yo:i.y)+n);const x=C?i.xo:i.x,k=C?i.yo:i.y,M=x+n*a.x,R=k+n*a.y;e.y=R+a.normalSlope*(e.x-M)},slope:Number.POSITIVE_INFINITY,touch:function(e){e.yTouched=!0},touched:function(e){return e.yTouched},untouch:function(e){e.yTouched=!1}};function wt(e,i){this.x=e,this.y=i,this.axis=void 0,this.slope=i/e,this.normalSlope=-e/i,Object.freeze(this)}function xt(e,i){const n=Math.sqrt(e*e+i*i);return i/=n,(e/=n)==1&&i===0?tt:e===0&&i===1?it:new wt(e,i)}function rt(e,i,n,a){this.x=this.xo=Math.round(64*e)/64,this.y=this.yo=Math.round(64*i)/64,this.lastPointOfContour=n,this.onCurve=a,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Object.freeze(tt),Object.freeze(it),wt.prototype.distance=function(e,i,n,a){return this.x*tt.distance(e,i,n,a)+this.y*it.distance(e,i,n,a)},wt.prototype.interpolate=function(e,i,n,a){let C,x,k,M,R,N,$;k=a.distance(e,i,!0,!0),M=a.distance(e,n,!0,!0),C=a.distance(i,i,!1,!0),x=a.distance(n,n,!1,!0),R=Math.abs(k),N=Math.abs(M),$=R+N,$!==0?this.setRelative(e,e,(C*N+x*R)/$,a,!0):this.setRelative(e,e,(C+x)/2,a,!0)},wt.prototype.setRelative=function(e,i,n,a,C){a=a||this;const x=C?i.xo:i.x,k=C?i.yo:i.y,M=x+n*a.x,R=k+n*a.y,N=a.normalSlope,$=this.slope,Y=e.x,Z=e.y;e.x=($*Y-N*M+R-Z)/($-N),e.y=$*(e.x-Y)+Z},wt.prototype.touch=function(e){e.xTouched=!0,e.yTouched=!0},rt.prototype.nextTouched=function(e){let i=this.nextPointOnContour;for(;!e.touched(i)&&i!==this;)i=i.nextPointOnContour;return i},rt.prototype.prevTouched=function(e){let i=this.prevPointOnContour;for(;!e.touched(i)&&i!==this;)i=i.prevPointOnContour;return i};const Lt=Object.freeze(new rt(0,0)),js={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function lt(e,i){switch(this.env=e,this.stack=[],this.prog=i,e){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=tt,this.round=er}}function Mt(e){const i=e.tZone=new Array(e.gZone.length);for(let n=0;n<i.length;n++)i[n]=new rt(0,0)}function ir(e,i){const n=e.prog;let a,C=e.ip,x=1;do if(a=n[++C],a===88)x++;else if(a===89)x--;else if(a===64)C+=n[C+1]+1;else if(a===65)C+=2*n[C+1]+1;else if(a>=176&&a<=183)C+=a-176+1;else if(a>=184&&a<=191)C+=2*(a-184+1);else if(i&&x===1&&a===27)break;while(x>0);e.ip=C}function rr(e,i){H.DEBUG&&console.log(i.step,"SVTCA["+e.axis+"]"),i.fv=i.pv=i.dpv=e}function sr(e,i){H.DEBUG&&console.log(i.step,"SPVTCA["+e.axis+"]"),i.pv=i.dpv=e}function nr(e,i){H.DEBUG&&console.log(i.step,"SFVTCA["+e.axis+"]"),i.fv=e}function or(e,i){const n=i.stack,a=n.pop(),C=n.pop(),x=i.z2[a],k=i.z1[C];let M,R;H.DEBUG&&console.log("SPVTL["+e+"]",a,C),e?(M=x.y-k.y,R=k.x-x.x):(M=k.x-x.x,R=k.y-x.y),i.pv=i.dpv=xt(M,R)}function ar(e,i){const n=i.stack,a=n.pop(),C=n.pop(),x=i.z2[a],k=i.z1[C];let M,R;H.DEBUG&&console.log("SFVTL["+e+"]",a,C),e?(M=x.y-k.y,R=k.x-x.x):(M=k.x-x.x,R=k.y-x.y),i.fv=xt(M,R)}function jt(e){H.DEBUG&&console.log(e.step,"POP[]"),e.stack.pop()}function lr(e,i){const n=i.stack.pop(),a=i.z0[n],C=i.fv,x=i.pv;H.DEBUG&&console.log(i.step,"MDAP["+e+"]",n);let k=x.distance(a,Lt);e&&(k=i.round(k)),C.setRelative(a,Lt,k,x),C.touch(a),i.rp0=i.rp1=n}function cr(e,i){const n=i.z2,a=n.length-2;let C,x,k;H.DEBUG&&console.log(i.step,"IUP["+e.axis+"]");for(let M=0;M<a;M++)C=n[M],e.touched(C)||(x=C.prevTouched(e),x!==C&&(k=C.nextTouched(e),x===k&&e.setRelative(C,C,e.distance(x,x,!1,!0),e,!0),e.interpolate(C,x,k,e)))}function hr(e,i){const n=i.stack,a=e?i.rp1:i.rp2,C=(e?i.z0:i.z1)[a],x=i.fv,k=i.pv;let M=i.loop;const R=i.z2;for(;M--;){const N=n.pop(),$=R[N],Y=k.distance(C,C,!1,!0);x.setRelative($,$,Y,k),x.touch($),H.DEBUG&&console.log(i.step,(i.loop>1?"loop "+(i.loop-M)+": ":"")+"SHP["+(e?"rp1":"rp2")+"]",N)}i.loop=1}function ur(e,i){const n=i.stack,a=e?i.rp1:i.rp2,C=(e?i.z0:i.z1)[a],x=i.fv,k=i.pv,M=n.pop(),R=i.z2[i.contours[M]];let N=R;H.DEBUG&&console.log(i.step,"SHC["+e+"]",M);const $=k.distance(C,C,!1,!0);do N!==C&&x.setRelative(N,N,$,k),N=N.nextPointOnContour;while(N!==R)}function dr(e,i){const n=i.stack,a=e?i.rp1:i.rp2,C=(e?i.z0:i.z1)[a],x=i.fv,k=i.pv,M=n.pop();let R,N;switch(H.DEBUG&&console.log(i.step,"SHZ["+e+"]",M),M){case 0:R=i.tZone;break;case 1:R=i.gZone;break;default:throw new Error("Invalid zone")}const $=k.distance(C,C,!1,!0),Y=R.length-2;for(let Z=0;Z<Y;Z++)N=R[Z],x.setRelative(N,N,$,k)}function fr(e,i){const n=i.stack,a=n.pop()/64,C=n.pop(),x=i.z1[C],k=i.z0[i.rp0],M=i.fv,R=i.pv;M.setRelative(x,k,a,R),M.touch(x),H.DEBUG&&console.log(i.step,"MSIRP["+e+"]",a,C),i.rp1=i.rp0,i.rp2=C,e&&(i.rp0=C)}function pr(e,i){const n=i.stack,a=n.pop(),C=n.pop(),x=i.z0[C],k=i.fv,M=i.pv;let R=i.cvt[a];H.DEBUG&&console.log(i.step,"MIAP["+e+"]",a,"(",R,")",C);let N=M.distance(x,Lt);e&&(Math.abs(N-R)<i.cvCutIn&&(N=R),N=i.round(N)),k.setRelative(x,Lt,N,M),i.zp0===0&&(x.xo=x.x,x.yo=x.y),k.touch(x),i.rp0=i.rp1=C}function _r(e,i){const n=i.stack,a=n.pop(),C=i.z2[a];H.DEBUG&&console.log(i.step,"GC["+e+"]",a),n.push(64*i.dpv.distance(C,Lt,e,!1))}function gr(e,i){const n=i.stack,a=n.pop(),C=n.pop(),x=i.z1[a],k=i.z0[C],M=i.dpv.distance(k,x,e,e);H.DEBUG&&console.log(i.step,"MD["+e+"]",a,C,"->",M),i.stack.push(Math.round(64*M))}function zt(e,i){const n=i.stack,a=n.pop(),C=i.fv,x=i.pv,k=i.ppem,M=i.deltaBase+16*(e-1),R=i.deltaShift,N=i.z0;H.DEBUG&&console.log(i.step,"DELTAP["+e+"]",a,n);for(let $=0;$<a;$++){const Y=n.pop(),Z=n.pop();if(M+((240&Z)>>4)!==k)continue;let de=(15&Z)-8;de>=0&&de++,H.DEBUG&&console.log(i.step,"DELTAPFIX",Y,"by",de*R);const ae=N[Y];C.setRelative(ae,ae,de*R,x)}}function Bt(e,i){const n=i.stack,a=n.pop();H.DEBUG&&console.log(i.step,"ROUND[]"),n.push(64*i.round(a/64))}function $t(e,i){const n=i.stack,a=n.pop(),C=i.ppem,x=i.deltaBase+16*(e-1),k=i.deltaShift;H.DEBUG&&console.log(i.step,"DELTAC["+e+"]",a,n);for(let M=0;M<a;M++){const R=n.pop(),N=n.pop();if(x+((240&N)>>4)!==C)continue;let $=(15&N)-8;$>=0&&$++;const Y=$*k;H.DEBUG&&console.log(i.step,"DELTACFIX",R,"by",Y),i.cvt[R]+=Y}}function vr(e,i){const n=i.stack,a=n.pop(),C=n.pop(),x=i.z2[a],k=i.z1[C];let M,R;H.DEBUG&&console.log(i.step,"SDPVTL["+e+"]",a,C),e?(M=x.y-k.y,R=k.x-x.x):(M=k.x-x.x,R=k.y-x.y),i.dpv=xt(M,R)}function ct(e,i){const n=i.stack,a=i.prog;let C=i.ip;H.DEBUG&&console.log(i.step,"PUSHB["+e+"]");for(let x=0;x<e;x++)n.push(a[++C]);i.ip=C}function ht(e,i){let n=i.ip;const a=i.prog,C=i.stack;H.DEBUG&&console.log(i.ip,"PUSHW["+e+"]");for(let x=0;x<e;x++){let k=a[++n]<<8|a[++n];32768&k&&(k=-(1+(65535^k))),C.push(k)}i.ip=n}function ve(e,i,n,a,C,x){const k=x.stack,M=e&&k.pop(),R=k.pop(),N=x.rp0,$=x.z0[N],Y=x.z1[R],Z=x.minDis,de=x.fv,ae=x.dpv;let ye,oe,le,me;oe=ye=ae.distance(Y,$,!0,!0),le=oe>=0?1:-1,oe=Math.abs(oe),e&&(me=x.cvt[M],a&&Math.abs(oe-me)<x.cvCutIn&&(oe=me)),n&&oe<Z&&(oe=Z),a&&(oe=x.round(oe)),de.setRelative(Y,$,le*oe,ae),de.touch(Y),H.DEBUG&&console.log(x.step,(e?"MIRP[":"MDRP[")+(i?"M":"m")+(n?">":"_")+(a?"R":"_")+(C===0?"Gr":C===1?"Bl":C===2?"Wh":"")+"]",e?M+"("+x.cvt[M]+","+me+")":"",R,"(d =",ye,"->",le*oe,")"),x.rp1=x.rp0,x.rp2=R,i&&(x.rp0=R)}Qi.prototype.exec=function(e,i){if(typeof i!="number")throw new Error("Point size is not a number!");if(this._errorState>2)return;const n=this.font;let a=this._prepState;if(!a||a.ppem!==i){let C=this._fpgmState;if(!C){lt.prototype=js,C=this._fpgmState=new lt("fpgm",n.tables.fpgm),C.funcs=[],C.font=n,H.DEBUG&&(console.log("---EXEC FPGM---"),C.step=-1);try{pt(C)}catch(k){return console.log("Hinting error in FPGM:"+k),void(this._errorState=3)}}lt.prototype=C,a=this._prepState=new lt("prep",n.tables.prep),a.ppem=i;const x=n.tables.cvt;if(x){const k=a.cvt=new Array(x.length),M=i/n.unitsPerEm;for(let R=0;R<x.length;R++)k[R]=x[R]*M}else a.cvt=[];H.DEBUG&&(console.log("---EXEC PREP---"),a.step=-1);try{pt(a)}catch(k){this._errorState<2&&console.log("Hinting error in PREP:"+k),this._errorState=2}}if(!(this._errorState>1))try{return Ji(e,a)}catch(C){return this._errorState<1&&(console.log("Hinting error:"+C),console.log("Note: further hinting errors are silenced")),void(this._errorState=1)}},Ji=function(e,i){const n=i.ppem/i.font.unitsPerEm,a=n;let C,x,k,M=e.components;if(lt.prototype=i,M){const R=i.font;x=[],C=[];for(let N=0;N<M.length;N++){const $=M[N],Y=R.glyphs.get($.glyphIndex);k=new lt("glyf",Y.instructions),H.DEBUG&&(console.log("---EXEC COMP "+N+"---"),k.step=-1),Gt(Y,k,n,a);const Z=Math.round($.dx*n),de=Math.round($.dy*a),ae=k.gZone,ye=k.contours;for(let le=0;le<ae.length;le++){const me=ae[le];me.xTouched=me.yTouched=!1,me.xo=me.x=me.x+Z,me.yo=me.y=me.y+de}const oe=x.length;x.push.apply(x,ae);for(let le=0;le<ye.length;le++)C.push(ye[le]+oe)}e.instructions&&!k.inhibitGridFit&&(k=new lt("glyf",e.instructions),k.gZone=k.z0=k.z1=k.z2=x,k.contours=C,x.push(new rt(0,0),new rt(Math.round(e.advanceWidth*n),0)),H.DEBUG&&(console.log("---EXEC COMPOSITE---"),k.step=-1),pt(k),x.length-=2)}else k=new lt("glyf",e.instructions),H.DEBUG&&(console.log("---EXEC GLYPH---"),k.step=-1),Gt(e,k,n,a),x=k.gZone;return x},Gt=function(e,i,n,a){const C=e.points||[],x=C.length,k=i.gZone=i.z0=i.z1=i.z2=[],M=i.contours=[];let R,N,$;for(let Y=0;Y<x;Y++)R=C[Y],k[Y]=new rt(R.x*n,R.y*a,R.lastPointOfContour,R.onCurve);for(let Y=0;Y<x;Y++)R=k[Y],N||(N=R,M.push(Y)),R.lastPointOfContour?(R.nextPointOnContour=N,N.prevPointOnContour=R,N=void 0):($=k[Y+1],R.nextPointOnContour=$,$.prevPointOnContour=R);if(!i.inhibitGridFit){if(H.DEBUG){console.log("PROCESSING GLYPH",i.stack);for(let Y=0;Y<x;Y++)console.log(Y,k[Y].x,k[Y].y)}if(k.push(new rt(0,0),new rt(Math.round(e.advanceWidth*n),0)),pt(i),k.length-=2,H.DEBUG){console.log("FINISHED GLYPH",i.stack);for(let Y=0;Y<x;Y++)console.log(Y,k[Y].x,k[Y].y)}}},pt=function(e){let i=e.prog;if(!i)return;const n=i.length;let a;for(e.ip=0;e.ip<n;e.ip++){if(H.DEBUG&&e.step++,a=Zi[i[e.ip]],!a)throw new Error("unknown instruction: 0x"+Number(i[e.ip]).toString(16));a(e)}},Zi=[rr.bind(void 0,it),rr.bind(void 0,tt),sr.bind(void 0,it),sr.bind(void 0,tt),nr.bind(void 0,it),nr.bind(void 0,tt),or.bind(void 0,0),or.bind(void 0,1),ar.bind(void 0,0),ar.bind(void 0,1),function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"SPVFS[]",n,a),e.pv=e.dpv=xt(a,n)},function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"SPVFS[]",n,a),e.fv=xt(a,n)},function(e){const i=e.stack,n=e.pv;H.DEBUG&&console.log(e.step,"GPV[]"),i.push(16384*n.x),i.push(16384*n.y)},function(e){const i=e.stack,n=e.fv;H.DEBUG&&console.log(e.step,"GFV[]"),i.push(16384*n.x),i.push(16384*n.y)},function(e){e.fv=e.pv,H.DEBUG&&console.log(e.step,"SFVTPV[]")},function(e){const i=e.stack,n=i.pop(),a=i.pop(),C=i.pop(),x=i.pop(),k=i.pop(),M=e.z0,R=e.z1,N=M[n],$=M[a],Y=R[C],Z=R[x],de=e.z2[k];H.DEBUG&&console.log("ISECT[], ",n,a,C,x,k);const ae=N.x,ye=N.y,oe=$.x,le=$.y,me=Y.x,be=Y.y,Ee=Z.x,_e=Z.y,ue=(ae-oe)*(be-_e)-(ye-le)*(me-Ee),ge=ae*le-ye*oe,Te=me*_e-be*Ee;de.x=(ge*(me-Ee)-Te*(ae-oe))/ue,de.y=(ge*(be-_e)-Te*(ye-le))/ue},function(e){e.rp0=e.stack.pop(),H.DEBUG&&console.log(e.step,"SRP0[]",e.rp0)},function(e){e.rp1=e.stack.pop(),H.DEBUG&&console.log(e.step,"SRP1[]",e.rp1)},function(e){e.rp2=e.stack.pop(),H.DEBUG&&console.log(e.step,"SRP2[]",e.rp2)},function(e){const i=e.stack.pop();switch(H.DEBUG&&console.log(e.step,"SZP0[]",i),e.zp0=i,i){case 0:e.tZone||Mt(e),e.z0=e.tZone;break;case 1:e.z0=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){const i=e.stack.pop();switch(H.DEBUG&&console.log(e.step,"SZP1[]",i),e.zp1=i,i){case 0:e.tZone||Mt(e),e.z1=e.tZone;break;case 1:e.z1=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){const i=e.stack.pop();switch(H.DEBUG&&console.log(e.step,"SZP2[]",i),e.zp2=i,i){case 0:e.tZone||Mt(e),e.z2=e.tZone;break;case 1:e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){const i=e.stack.pop();switch(H.DEBUG&&console.log(e.step,"SZPS[]",i),e.zp0=e.zp1=e.zp2=i,i){case 0:e.tZone||Mt(e),e.z0=e.z1=e.z2=e.tZone;break;case 1:e.z0=e.z1=e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){e.loop=e.stack.pop(),H.DEBUG&&console.log(e.step,"SLOOP[]",e.loop)},function(e){H.DEBUG&&console.log(e.step,"RTG[]"),e.round=er},function(e){H.DEBUG&&console.log(e.step,"RTHG[]"),e.round=Ns},function(e){const i=e.stack.pop();H.DEBUG&&console.log(e.step,"SMD[]",i),e.minDis=i/64},function(e){H.DEBUG&&console.log(e.step,"ELSE[]"),ir(e,!1)},function(e){const i=e.stack.pop();H.DEBUG&&console.log(e.step,"JMPR[]",i),e.ip+=i-1},function(e){const i=e.stack.pop();H.DEBUG&&console.log(e.step,"SCVTCI[]",i),e.cvCutIn=i/64},void 0,void 0,function(e){const i=e.stack;H.DEBUG&&console.log(e.step,"DUP[]"),i.push(i[i.length-1])},jt,function(e){H.DEBUG&&console.log(e.step,"CLEAR[]"),e.stack.length=0},function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"SWAP[]"),i.push(n),i.push(a)},function(e){const i=e.stack;H.DEBUG&&console.log(e.step,"DEPTH[]"),i.push(i.length)},function(e){const i=e.stack,n=i.pop();H.DEBUG&&console.log(e.step,"CINDEX[]",n),i.push(i[i.length-n])},function(e){const i=e.stack,n=i.pop();H.DEBUG&&console.log(e.step,"MINDEX[]",n),i.push(i.splice(i.length-n,1)[0])},void 0,void 0,void 0,function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"LOOPCALL[]",n,a);const C=e.ip,x=e.prog;e.prog=e.funcs[n];for(let k=0;k<a;k++)pt(e),H.DEBUG&&console.log(++e.step,k+1<a?"next loopcall":"done loopcall",k);e.ip=C,e.prog=x},function(e){const i=e.stack.pop();H.DEBUG&&console.log(e.step,"CALL[]",i);const n=e.ip,a=e.prog;e.prog=e.funcs[i],pt(e),e.ip=n,e.prog=a,H.DEBUG&&console.log(++e.step,"returning from",i)},function(e){if(e.env!=="fpgm")throw new Error("FDEF not allowed here");const i=e.stack,n=e.prog;let a=e.ip;const C=i.pop(),x=a;for(H.DEBUG&&console.log(e.step,"FDEF[]",C);n[++a]!==45;);e.ip=a,e.funcs[C]=n.slice(x+1,a)},void 0,lr.bind(void 0,0),lr.bind(void 0,1),cr.bind(void 0,it),cr.bind(void 0,tt),hr.bind(void 0,0),hr.bind(void 0,1),ur.bind(void 0,0),ur.bind(void 0,1),dr.bind(void 0,0),dr.bind(void 0,1),function(e){const i=e.stack;let n=e.loop;const a=e.fv,C=i.pop()/64,x=e.z2;for(;n--;){const k=i.pop(),M=x[k];H.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-n)+": ":"")+"SHPIX[]",k,C),a.setRelative(M,M,C),a.touch(M)}e.loop=1},function(e){const i=e.stack,n=e.rp1,a=e.rp2;let C=e.loop;const x=e.z0[n],k=e.z1[a],M=e.fv,R=e.dpv,N=e.z2;for(;C--;){const $=i.pop(),Y=N[$];H.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-C)+": ":"")+"IP[]",$,n,"<->",a),M.interpolate(Y,x,k,R),M.touch(Y)}e.loop=1},fr.bind(void 0,0),fr.bind(void 0,1),function(e){const i=e.stack,n=e.rp0,a=e.z0[n];let C=e.loop;const x=e.fv,k=e.pv,M=e.z1;for(;C--;){const R=i.pop(),N=M[R];H.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-C)+": ":"")+"ALIGNRP[]",R),x.setRelative(N,a,0,k),x.touch(N)}e.loop=1},function(e){H.DEBUG&&console.log(e.step,"RTDG[]"),e.round=Hs},pr.bind(void 0,0),pr.bind(void 0,1),function(e){const i=e.prog;let n=e.ip;const a=e.stack,C=i[++n];H.DEBUG&&console.log(e.step,"NPUSHB[]",C);for(let x=0;x<C;x++)a.push(i[++n]);e.ip=n},function(e){let i=e.ip;const n=e.prog,a=e.stack,C=n[++i];H.DEBUG&&console.log(e.step,"NPUSHW[]",C);for(let x=0;x<C;x++){let k=n[++i]<<8|n[++i];32768&k&&(k=-(1+(65535^k))),a.push(k)}e.ip=i},function(e){const i=e.stack;let n=e.store;n||(n=e.store=[]);const a=i.pop(),C=i.pop();H.DEBUG&&console.log(e.step,"WS",a,C),n[C]=a},function(e){const i=e.stack,n=e.store,a=i.pop();H.DEBUG&&console.log(e.step,"RS",a);const C=n&&n[a]||0;i.push(C)},function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"WCVTP",n,a),e.cvt[a]=n/64},function(e){const i=e.stack,n=i.pop();H.DEBUG&&console.log(e.step,"RCVT",n),i.push(64*e.cvt[n])},_r.bind(void 0,0),_r.bind(void 0,1),void 0,gr.bind(void 0,0),gr.bind(void 0,1),function(e){H.DEBUG&&console.log(e.step,"MPPEM[]"),e.stack.push(e.ppem)},void 0,function(e){H.DEBUG&&console.log(e.step,"FLIPON[]"),e.autoFlip=!0},void 0,void 0,function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"LT[]",n,a),i.push(a<n?1:0)},function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"LTEQ[]",n,a),i.push(a<=n?1:0)},function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"GT[]",n,a),i.push(a>n?1:0)},function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"GTEQ[]",n,a),i.push(a>=n?1:0)},function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"EQ[]",n,a),i.push(n===a?1:0)},function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"NEQ[]",n,a),i.push(n!==a?1:0)},function(e){const i=e.stack,n=i.pop();H.DEBUG&&console.log(e.step,"ODD[]",n),i.push(Math.trunc(n)%2?1:0)},function(e){const i=e.stack,n=i.pop();H.DEBUG&&console.log(e.step,"EVEN[]",n),i.push(Math.trunc(n)%2?0:1)},function(e){let i=e.stack.pop();H.DEBUG&&console.log(e.step,"IF[]",i),i||(ir(e,!0),H.DEBUG&&console.log(e.step,"EIF[]"))},function(e){H.DEBUG&&console.log(e.step,"EIF[]")},function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"AND[]",n,a),i.push(n&&a?1:0)},function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"OR[]",n,a),i.push(n||a?1:0)},function(e){const i=e.stack,n=i.pop();H.DEBUG&&console.log(e.step,"NOT[]",n),i.push(n?0:1)},zt.bind(void 0,1),function(e){const i=e.stack.pop();H.DEBUG&&console.log(e.step,"SDB[]",i),e.deltaBase=i},function(e){const i=e.stack.pop();H.DEBUG&&console.log(e.step,"SDS[]",i),e.deltaShift=Math.pow(.5,i)},function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"ADD[]",n,a),i.push(a+n)},function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"SUB[]",n,a),i.push(a-n)},function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"DIV[]",n,a),i.push(64*a/n)},function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"MUL[]",n,a),i.push(a*n/64)},function(e){const i=e.stack,n=i.pop();H.DEBUG&&console.log(e.step,"ABS[]",n),i.push(Math.abs(n))},function(e){const i=e.stack;let n=i.pop();H.DEBUG&&console.log(e.step,"NEG[]",n),i.push(-n)},function(e){const i=e.stack,n=i.pop();H.DEBUG&&console.log(e.step,"FLOOR[]",n),i.push(64*Math.floor(n/64))},function(e){const i=e.stack,n=i.pop();H.DEBUG&&console.log(e.step,"CEILING[]",n),i.push(64*Math.ceil(n/64))},Bt.bind(void 0,0),Bt.bind(void 0,1),Bt.bind(void 0,2),Bt.bind(void 0,3),void 0,void 0,void 0,void 0,function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"WCVTF[]",n,a),e.cvt[a]=n*e.ppem/e.font.unitsPerEm},zt.bind(void 0,2),zt.bind(void 0,3),$t.bind(void 0,1),$t.bind(void 0,2),$t.bind(void 0,3),function(e){let i,n=e.stack.pop();switch(H.DEBUG&&console.log(e.step,"SROUND[]",n),e.round=tr,192&n){case 0:i=.5;break;case 64:i=1;break;case 128:i=2;break;default:throw new Error("invalid SROUND value")}switch(e.srPeriod=i,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*i;break;case 32:e.srPhase=.5*i;break;case 48:e.srPhase=.75*i;break;default:throw new Error("invalid SROUND value")}n&=15,e.srThreshold=n===0?0:(n/8-.5)*i},function(e){let i,n=e.stack.pop();switch(H.DEBUG&&console.log(e.step,"S45ROUND[]",n),e.round=tr,192&n){case 0:i=Math.sqrt(2)/2;break;case 64:i=Math.sqrt(2);break;case 128:i=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(e.srPeriod=i,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*i;break;case 32:e.srPhase=.5*i;break;case 48:e.srPhase=.75*i;break;default:throw new Error("invalid S45ROUND value")}n&=15,e.srThreshold=n===0?0:(n/8-.5)*i},void 0,void 0,function(e){H.DEBUG&&console.log(e.step,"ROFF[]"),e.round=Fs},void 0,function(e){H.DEBUG&&console.log(e.step,"RUTG[]"),e.round=Ws},function(e){H.DEBUG&&console.log(e.step,"RDTG[]"),e.round=Gs},jt,jt,void 0,void 0,void 0,void 0,void 0,function(e){const i=e.stack.pop();H.DEBUG&&console.log(e.step,"SCANCTRL[]",i)},vr.bind(void 0,0),vr.bind(void 0,1),function(e){const i=e.stack,n=i.pop();let a=0;H.DEBUG&&console.log(e.step,"GETINFO[]",n),1&n&&(a=35),32&n&&(a|=4096),i.push(a)},void 0,function(e){const i=e.stack,n=i.pop(),a=i.pop(),C=i.pop();H.DEBUG&&console.log(e.step,"ROLL[]"),i.push(a),i.push(n),i.push(C)},function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"MAX[]",n,a),i.push(Math.max(a,n))},function(e){const i=e.stack,n=i.pop(),a=i.pop();H.DEBUG&&console.log(e.step,"MIN[]",n,a),i.push(Math.min(a,n))},function(e){const i=e.stack.pop();H.DEBUG&&console.log(e.step,"SCANTYPE[]",i)},function(e){const i=e.stack.pop();let n=e.stack.pop();switch(H.DEBUG&&console.log(e.step,"INSTCTRL[]",i,n),i){case 1:return void(e.inhibitGridFit=!!n);case 2:return void(e.ignoreCvt=!!n);default:throw new Error("invalid INSTCTRL[] selector")}},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ct.bind(void 0,1),ct.bind(void 0,2),ct.bind(void 0,3),ct.bind(void 0,4),ct.bind(void 0,5),ct.bind(void 0,6),ct.bind(void 0,7),ct.bind(void 0,8),ht.bind(void 0,1),ht.bind(void 0,2),ht.bind(void 0,3),ht.bind(void 0,4),ht.bind(void 0,5),ht.bind(void 0,6),ht.bind(void 0,7),ht.bind(void 0,8),ve.bind(void 0,0,0,0,0,0),ve.bind(void 0,0,0,0,0,1),ve.bind(void 0,0,0,0,0,2),ve.bind(void 0,0,0,0,0,3),ve.bind(void 0,0,0,0,1,0),ve.bind(void 0,0,0,0,1,1),ve.bind(void 0,0,0,0,1,2),ve.bind(void 0,0,0,0,1,3),ve.bind(void 0,0,0,1,0,0),ve.bind(void 0,0,0,1,0,1),ve.bind(void 0,0,0,1,0,2),ve.bind(void 0,0,0,1,0,3),ve.bind(void 0,0,0,1,1,0),ve.bind(void 0,0,0,1,1,1),ve.bind(void 0,0,0,1,1,2),ve.bind(void 0,0,0,1,1,3),ve.bind(void 0,0,1,0,0,0),ve.bind(void 0,0,1,0,0,1),ve.bind(void 0,0,1,0,0,2),ve.bind(void 0,0,1,0,0,3),ve.bind(void 0,0,1,0,1,0),ve.bind(void 0,0,1,0,1,1),ve.bind(void 0,0,1,0,1,2),ve.bind(void 0,0,1,0,1,3),ve.bind(void 0,0,1,1,0,0),ve.bind(void 0,0,1,1,0,1),ve.bind(void 0,0,1,1,0,2),ve.bind(void 0,0,1,1,0,3),ve.bind(void 0,0,1,1,1,0),ve.bind(void 0,0,1,1,1,1),ve.bind(void 0,0,1,1,1,2),ve.bind(void 0,0,1,1,1,3),ve.bind(void 0,1,0,0,0,0),ve.bind(void 0,1,0,0,0,1),ve.bind(void 0,1,0,0,0,2),ve.bind(void 0,1,0,0,0,3),ve.bind(void 0,1,0,0,1,0),ve.bind(void 0,1,0,0,1,1),ve.bind(void 0,1,0,0,1,2),ve.bind(void 0,1,0,0,1,3),ve.bind(void 0,1,0,1,0,0),ve.bind(void 0,1,0,1,0,1),ve.bind(void 0,1,0,1,0,2),ve.bind(void 0,1,0,1,0,3),ve.bind(void 0,1,0,1,1,0),ve.bind(void 0,1,0,1,1,1),ve.bind(void 0,1,0,1,1,2),ve.bind(void 0,1,0,1,1,3),ve.bind(void 0,1,1,0,0,0),ve.bind(void 0,1,1,0,0,1),ve.bind(void 0,1,1,0,0,2),ve.bind(void 0,1,1,0,0,3),ve.bind(void 0,1,1,0,1,0),ve.bind(void 0,1,1,0,1,1),ve.bind(void 0,1,1,0,1,2),ve.bind(void 0,1,1,0,1,3),ve.bind(void 0,1,1,1,0,0),ve.bind(void 0,1,1,1,0,1),ve.bind(void 0,1,1,1,0,2),ve.bind(void 0,1,1,1,0,3),ve.bind(void 0,1,1,1,1,0),ve.bind(void 0,1,1,1,1,1),ve.bind(void 0,1,1,1,1,2),ve.bind(void 0,1,1,1,1,3)];const zs=Qi;function De(e){(e=e||{}).empty||(vt(e.familyName,"When creating a new Font object, familyName is required."),vt(e.styleName,"When creating a new Font object, styleName is required."),vt(e.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),vt(e.ascender,"When creating a new Font object, ascender is required."),vt(e.descender,"When creating a new Font object, descender is required."),vt(e.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:e.familyName||" "},fontSubfamily:{en:e.styleName||" "},fullName:{en:e.fullName||e.familyName+" "+e.styleName},postScriptName:{en:e.postScriptName||e.familyName+e.styleName},designer:{en:e.designer||" "},designerURL:{en:e.designerURL||" "},manufacturer:{en:e.manufacturer||" "},manufacturerURL:{en:e.manufacturerURL||" "},license:{en:e.license||" "},licenseURL:{en:e.licenseURL||" "},version:{en:e.version||"Version 0.1"},description:{en:e.description||" "},copyright:{en:e.copyright||" "},trademark:{en:e.trademark||" "}},this.unitsPerEm=e.unitsPerEm||1e3,this.ascender=e.ascender,this.descender=e.descender,this.createdTimestamp=e.createdTimestamp,this.tables={os2:{usWeightClass:e.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:e.widthClass||this.usWidthClasses.MEDIUM,fsSelection:e.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new _t.GlyphSet(this,e.glyphs||[]),this.encoding=new Ne(this),this.position=new Is(this),this.substitution=new Us(this),this.tables=this.tables||{},Object.defineProperty(this,"hinting",{get:function(){return this._hinting?this._hinting:this.outlinesFormat==="truetype"?this._hinting=new zs(this):void 0}})}De.prototype.hasChar=function(e){return this.encoding.charToGlyphIndex(e)!==null},De.prototype.charToGlyphIndex=function(e){return this.encoding.charToGlyphIndex(e)},De.prototype.charToGlyph=function(e){const i=this.charToGlyphIndex(e);let n=this.glyphs.get(i);return n||(n=this.glyphs.get(0)),n},De.prototype.stringToGlyphs=function(e,i){i=i||this.defaultRenderOptions;const n=[];for(let k=0;k<e.length;k+=1){const M=e[k];n.push(this.charToGlyphIndex(M))}let a=n.length;if(i.features){const k=i.script||this.substitution.getDefaultScriptName();let M=[];i.features.liga&&(M=M.concat(this.substitution.getFeature("liga",k,i.language))),i.features.rlig&&(M=M.concat(this.substitution.getFeature("rlig",k,i.language)));for(let R=0;R<a;R+=1)for(let N=0;N<M.length;N++){const $=M[N],Y=$.sub,Z=Y.length;let de=0;for(;de<Z&&Y[de]===n[R+de];)de++;de===Z&&(n.splice(R,Z,$.by),a=a-Z+1)}}const C=new Array(a),x=this.glyphs.get(0);for(let k=0;k<a;k+=1)C[k]=this.glyphs.get(n[k])||x;return C},De.prototype.nameToGlyphIndex=function(e){return this.glyphNames.nameToGlyphIndex(e)},De.prototype.nameToGlyph=function(e){const i=this.nameToGlyphIndex(e);let n=this.glyphs.get(i);return n||(n=this.glyphs.get(0)),n},De.prototype.glyphIndexToName=function(e){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(e):""},De.prototype.getKerningValue=function(e,i){return e=e.index||e,i=i.index||i,this.kerningPairs[e+","+i]||0},De.prototype.defaultRenderOptions={kerning:!0,features:{liga:!0,rlig:!0}},De.prototype.forEachGlyph=function(e,i,n,a,C,x){i=i!==void 0?i:0,n=n!==void 0?n:0,a=a!==void 0?a:72,C=C||this.defaultRenderOptions;const k=1/this.unitsPerEm*a,M=this.stringToGlyphs(e,C);let R;if(C.kerning){const N=C.script||this.position.getDefaultScriptName();R=this.position.getKerningTables(N,C.language)}for(let N=0;N<M.length;N+=1){const $=M[N];x.call(this,$,i,n,a,C),$.advanceWidth&&(i+=$.advanceWidth*k),C.kerning&&N<M.length-1&&(i+=(R?this.position.getKerningValue(R,$.index,M[N+1].index):this.getKerningValue($,M[N+1]))*k),C.letterSpacing?i+=C.letterSpacing*a:C.tracking&&(i+=C.tracking/1e3*a)}return i},De.prototype.getPath=function(e,i,n,a,C){const x=new r;return this.forEachGlyph(e,i,n,a,C,function(k,M,R,N){const $=k.getPath(M,R,N,C,this);x.extend($)}),x},De.prototype.getPaths=function(e,i,n,a,C){const x=[];return this.forEachGlyph(e,i,n,a,C,function(k,M,R,N){const $=k.getPath(M,R,N,C,this);x.push($)}),x},De.prototype.getAdvanceWidth=function(e,i,n){return this.forEachGlyph(e,0,0,i,n,function(){})},De.prototype.draw=function(e,i,n,a,C,x){this.getPath(i,n,a,C,x).draw(e)},De.prototype.drawPoints=function(e,i,n,a,C,x){this.forEachGlyph(i,n,a,C,x,function(k,M,R,N){k.drawPoints(e,M,R,N)})},De.prototype.drawMetrics=function(e,i,n,a,C,x){this.forEachGlyph(i,n,a,C,x,function(k,M,R,N){k.drawMetrics(e,M,R,N)})},De.prototype.getEnglishName=function(e){const i=this.names[e];if(i)return i.en},De.prototype.validate=function(){const e=this;function i(a,C){}function n(a){const C=e.getEnglishName(a);C&&C.trim().length>0}n("fontFamily"),n("weightName"),n("manufacturer"),n("copyright"),n("version"),this.unitsPerEm>0},De.prototype.toTables=function(){return Os(this)},De.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},De.prototype.toArrayBuffer=function(){const e=this.toTables().encode(),i=new ArrayBuffer(e.length),n=new Uint8Array(i);for(let a=0;a<e.length;a++)n[a]=e[a];return i},De.prototype.download=function(e){const i=this.getEnglishName("fontFamily"),n=this.getEnglishName("fontSubfamily");e=e||i.replace(/\s/g,"")+"-"+n+".otf";const a=this.toArrayBuffer();if(typeof window<"u")window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,a.byteLength,function(C){C.root.getFile(e,{create:!0},function(x){x.createWriter(function(k){const M=new DataView(a),R=new Blob([M],{type:"font/opentype"});k.write(R),k.addEventListener("writeend",function(){location.href=x.toURL()},!1)})})},function(C){throw new Error(C.name+": "+C.message)});else{const C=d(89),x=function(k){const M=new Buffer(k.byteLength),R=new Uint8Array(k);for(let N=0;N<M.length;++N)M[N]=R[N];return M}(a);C.writeFileSync(e,x)}},De.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},De.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},De.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};const mr=De;function $s(e,i,n){const a={},C=new fe.Parser(e,i);return a.tag=C.parseTag(),a.minValue=C.parseFixed(),a.defaultValue=C.parseFixed(),a.maxValue=C.parseFixed(),C.skip("uShort",1),a.name=n[C.parseUShort()]||{},a}function qs(e,i,n,a){const C={},x=new fe.Parser(e,i);C.name=a[x.parseUShort()]||{},x.skip("uShort",1),C.coordinates={};for(let k=0;k<n.length;++k)C.coordinates[n[k].tag]=x.parseFixed();return C}const Vs=function(e,i,n){const a=new fe.Parser(e,i),C=a.parseULong();g.argument(C===65536,"Unsupported fvar table version.");const x=a.parseOffset16();a.skip("uShort",1);const k=a.parseUShort(),M=a.parseUShort(),R=a.parseUShort(),N=a.parseUShort(),$=[];for(let de=0;de<k;de++)$.push($s(e,i+x+de*M,n));const Y=[],Z=i+x+k*M;for(let de=0;de<R;de++)Y.push(qs(e,Z+de*N,$,n));return{axes:$,instances:Y}},Je=new Array(10);Je[1]=function(){const e=this.offset+this.relativeOffset,i=this.parseUShort();return i===1?{posFormat:1,coverage:this.parsePointer(Q.coverage),value:this.parseValueRecord()}:i===2?{posFormat:2,coverage:this.parsePointer(Q.coverage),values:this.parseValueRecordList()}:void g.assert(!1,"0x"+e.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},Je[2]=function(){const e=this.offset+this.relativeOffset,i=this.parseUShort(),n=this.parsePointer(Q.coverage),a=this.parseUShort(),C=this.parseUShort();if(i===1)return{posFormat:i,coverage:n,valueFormat1:a,valueFormat2:C,pairSets:this.parseList(Q.pointer(Q.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(a),value2:this.parseValueRecord(C)}})))};if(i===2){const x=this.parsePointer(Q.classDef),k=this.parsePointer(Q.classDef),M=this.parseUShort(),R=this.parseUShort();return{posFormat:i,coverage:n,valueFormat1:a,valueFormat2:C,classDef1:x,classDef2:k,class1Count:M,class2Count:R,classRecords:this.parseList(M,Q.list(R,function(){return{value1:this.parseValueRecord(a),value2:this.parseValueRecord(C)}}))}}g.assert(!1,"0x"+e.toString(16)+": GPOS lookup type 2 format must be 1 or 2.")},Je[3]=function(){return{error:"GPOS Lookup 3 not supported"}},Je[4]=function(){return{error:"GPOS Lookup 4 not supported"}},Je[5]=function(){return{error:"GPOS Lookup 5 not supported"}},Je[6]=function(){return{error:"GPOS Lookup 6 not supported"}},Je[7]=function(){return{error:"GPOS Lookup 7 not supported"}},Je[8]=function(){return{error:"GPOS Lookup 8 not supported"}},Je[9]=function(){return{error:"GPOS Lookup 9 not supported"}},new Array(10);const Ks=function(e,i){const n=new Q(e,i=i||0),a=n.parseVersion(1);return g.argument(a===1||a===1.1,"Unsupported GPOS table version "+a),a===1?{version:a,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Je)}:{version:a,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Je),variations:n.parseFeatureVariationsList()}},Xs=function(e,i){const n=new fe.Parser(e,i),a=n.parseUShort();if(a===0)return function(C){const x={};C.skip("uShort");const k=C.parseUShort();g.argument(k===0,"Unsupported kern sub-table version."),C.skip("uShort",2);const M=C.parseUShort();C.skip("uShort",3);for(let R=0;R<M;R+=1){const N=C.parseUShort(),$=C.parseUShort(),Y=C.parseShort();x[N+","+$]=Y}return x}(n);if(a===1)return function(C){const x={};C.skip("uShort"),C.parseULong()>1&&console.warn("Only the first kern subtable is supported."),C.skip("uLong");const k=255&C.parseUShort();if(C.skip("uShort"),k===0){const M=C.parseUShort();C.skip("uShort",3);for(let R=0;R<M;R+=1){const N=C.parseUShort(),$=C.parseUShort(),Y=C.parseShort();x[N+","+$]=Y}}return x}(n);throw new Error("Unsupported kern table version ("+a+").")},Ys=function(e,i,n,a){const C=new fe.Parser(e,i),x=a?C.parseUShort:C.parseULong,k=[];for(let M=0;M<n+1;M+=1){let R=x.call(C);a&&(R*=2),k.push(R)}return k};function Zs(e,i){d(89).readFile(e,function(n,a){if(n)return i(n.message);i(null,Yi(a))})}function Js(e,i){const n=new XMLHttpRequest;n.open("get",e,!0),n.responseType="arraybuffer",n.onload=function(){return n.response?i(null,n.response):i("Font could not be loaded: "+n.statusText)},n.onerror=function(){i("Font could not be loaded")},n.send()}function yr(e,i){const n=[];let a=12;for(let C=0;C<i;C+=1){const x=fe.getTag(e,a),k=fe.getULong(e,a+4),M=fe.getULong(e,a+8),R=fe.getULong(e,a+12);n.push({tag:x,checksum:k,offset:M,length:R,compression:!1}),a+=16}return n}function Oe(e,i){if(i.compression==="WOFF"){const n=new Uint8Array(e.buffer,i.offset+2,i.compressedLength-2),a=new Uint8Array(i.length);if(_()(n,a),a.byteLength!==i.length)throw new Error("Decompression error: "+i.tag+" decompressed length doesn't match recorded length");return{data:new DataView(a.buffer,0),offset:0}}return{data:e,offset:i.offset}}function qt(e){let i,n;const a=new mr({empty:!0}),C=new DataView(e,0);let x,k=[];const M=fe.getTag(C,0);if(M===String.fromCharCode(0,1,0,0)||M==="true"||M==="typ1")a.outlinesFormat="truetype",x=fe.getUShort(C,4),k=yr(C,x);else if(M==="OTTO")a.outlinesFormat="cff",x=fe.getUShort(C,4),k=yr(C,x);else{if(M!=="wOFF")throw new Error("Unsupported OpenType signature "+M);{const _e=fe.getTag(C,4);if(_e===String.fromCharCode(0,1,0,0))a.outlinesFormat="truetype";else{if(_e!=="OTTO")throw new Error("Unsupported OpenType flavor "+M);a.outlinesFormat="cff"}x=fe.getUShort(C,12),k=function(ue,ge){const Te=[];let we=44;for(let Ie=0;Ie<ge;Ie+=1){const We=fe.getTag(ue,we),qe=fe.getULong(ue,we+4),Fe=fe.getULong(ue,we+8),ze=fe.getULong(ue,we+12);let Ue;Ue=Fe<ze&&"WOFF",Te.push({tag:We,offset:qe,compression:Ue,compressedLength:Fe,length:ze}),we+=20}return Te}(C,x)}}let R,N,$,Y,Z,de,ae,ye,oe,le,me;for(let _e=0;_e<x;_e+=1){const ue=k[_e];let ge;switch(ue.tag){case"cmap":ge=Oe(C,ue),a.tables.cmap=Re(ge.data,ge.offset),a.encoding=new nt(a.tables.cmap);break;case"cvt ":ge=Oe(C,ue),me=new fe.Parser(ge.data,ge.offset),a.tables.cvt=me.parseShortList(ue.length/2);break;case"fvar":N=ue;break;case"fpgm":ge=Oe(C,ue),me=new fe.Parser(ge.data,ge.offset),a.tables.fpgm=me.parseByteList(ue.length);break;case"head":ge=Oe(C,ue),a.tables.head=as(ge.data,ge.offset),a.unitsPerEm=a.tables.head.unitsPerEm,i=a.tables.head.indexToLocFormat;break;case"hhea":ge=Oe(C,ue),a.tables.hhea=cs(ge.data,ge.offset),a.ascender=a.tables.hhea.ascender,a.descender=a.tables.hhea.descender,a.numberOfHMetrics=a.tables.hhea.numberOfHMetrics;break;case"hmtx":de=ue;break;case"ltag":ge=Oe(C,ue),n=ps(ge.data,ge.offset);break;case"maxp":ge=Oe(C,ue),a.tables.maxp=_s(ge.data,ge.offset),a.numGlyphs=a.tables.maxp.numGlyphs;break;case"name":oe=ue;break;case"OS/2":ge=Oe(C,ue),a.tables.os2=ws(ge.data,ge.offset);break;case"post":ge=Oe(C,ue),a.tables.post=Es(ge.data,ge.offset),a.glyphNames=new je(a.tables.post);break;case"prep":ge=Oe(C,ue),me=new fe.Parser(ge.data,ge.offset),a.tables.prep=me.parseByteList(ue.length);break;case"glyf":$=ue;break;case"loca":ye=ue;break;case"CFF ":R=ue;break;case"kern":ae=ue;break;case"GPOS":Y=ue;break;case"GSUB":Z=ue;break;case"meta":le=ue}}const be=Oe(C,oe);if(a.tables.name=bs(be.data,be.offset,n),a.names=a.tables.name,$&&ye){const _e=i===0,ue=Oe(C,ye),ge=Ys(ue.data,ue.offset,a.numGlyphs,_e),Te=Oe(C,$);a.glyphs=wi.parse(Te.data,Te.offset,ge,a)}else{if(!R)throw new Error("Font doesn't contain TrueType or CFF outlines.");{const _e=Oe(C,R);ns(_e.data,_e.offset,a)}}const Ee=Oe(C,de);if(us(Ee.data,Ee.offset,a.numberOfHMetrics,a.numGlyphs,a.glyphs),function(_e){let ue;const ge=_e.tables.cmap.glyphIndexMap,Te=Object.keys(ge);for(let we=0;we<Te.length;we+=1){const Ie=Te[we],We=ge[Ie];ue=_e.glyphs.get(We),ue.addUnicode(parseInt(Ie))}for(let we=0;we<_e.glyphs.length;we+=1)ue=_e.glyphs.get(we),_e.cffEncoding?_e.isCIDFont?ue.name="gid"+we:ue.name=_e.cffEncoding.charset[we]:_e.glyphNames.names&&(ue.name=_e.glyphNames.glyphIndexToName(we))}(a),ae){const _e=Oe(C,ae);a.kerningPairs=Xs(_e.data,_e.offset)}else a.kerningPairs={};if(Y){const _e=Oe(C,Y);a.tables.gpos=Ks(_e.data,_e.offset)}if(Z){const _e=Oe(C,Z);a.tables.gsub=Rs(_e.data,_e.offset)}if(N){const _e=Oe(C,N);a.tables.fvar=Vs(_e.data,_e.offset,a.names)}if(le){const _e=Oe(C,le);a.tables.meta=Ts(_e.data,_e.offset),a.metas=a.tables.meta}return a}function Qs(e,i){(typeof window>"u"?Zs:Js)(e,function(n,a){if(n)return i(n);let C;try{C=qt(a)}catch(x){return i(x,null)}return i(null,C)})}function en(e){return qt(Yi(d(89).readFileSync(e)))}},896:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const y=d(978);class _ extends y.Writable{constructor(){super(...arguments),this.offset=0,this._waiters=[],this._closed=!1}_write(h,s,r){let l=0;const p=()=>{for(;this._waiters.length>0;){const g=this._waiters[0];if(this._buffer){const w=this._buffer.size-this._buffer.offset;if(!(w+h.length>=g.size)){if(!g.skip){const v=Buffer.alloc(w+h.length);this._buffer.buf.copy(v,0,this._buffer.offset,this._buffer.size),h.copy(v,w,0,h.length),this._buffer.buf=v}this._buffer.offset=0,this._buffer.size=w+h.length,r();break}if(g.skip)this._buffer=void 0,g.resolve();else{const v=Math.min(w,g.size),b=Buffer.alloc(g.size);this._buffer.buf.copy(b,0,this._buffer.offset,this._buffer.offset+v),h.copy(b,v,0,g.size-v),g.resolve(b)}if(this.offset+=g.size,this._waiters.shift(),this._buffer=void 0,w+h.length===g.size){r();break}l+=g.size-w}else{if(!(h.length-l>=g.size)){this._buffer={buf:g.skip?void 0:h.slice(l),offset:0,size:h.length-l},l=h.length,r();break}if(g.skip?g.resolve():g.resolve(h.slice(l,l+g.size)),this.offset+=g.size,this._waiters.shift(),l+=g.size,h.length===l){r();break}}}this._processTrigger=h.length-l>0?p:void 0};p()}_destroy(h,s){this._processTrigger=void 0;for(const r of this._waiters)r.reject(h||new Error("stream destroyed"));this._waiters=[],this._closed=!0}_final(h){this._processTrigger=void 0;for(const s of this._waiters)s.reject(new Error("not enough data in stream"));this._waiters=[],this._closed=!0}read(h){return new Promise((s,r)=>{this._closed&&r(new Error("stream is closed")),this._waiters.push({resolve:s,reject:r,size:h,skip:!1}),this._processTrigger&&this._processTrigger()})}skip(h){return new Promise((s,r)=>{this._closed&&r(new Error("stream is closed")),this._waiters.push({resolve:s,reject:r,size:h,skip:!0}),this._processTrigger&&this._processTrigger()})}}function o(){return new _}f.exports=Object.assign(o,{default:o}),u.default=o},311:f=>{function u(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function d(D,F){this.source=D,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=F,this.destLen=0,this.ltree=new u,this.dtree=new u}var y=new u,_=new u,o=new Uint8Array(30),t=new Uint16Array(30),h=new Uint8Array(30),s=new Uint16Array(30),r=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l=new u,p=new Uint8Array(320);function g(D,F,E,I){var O,P;for(O=0;O<E;++O)D[O]=0;for(O=0;O<30-E;++O)D[O+E]=O/E|0;for(P=I,O=0;O<30;++O)F[O]=P,P+=1<<D[O]}var w=new Uint16Array(16);function v(D,F,E,I){var O,P;for(O=0;O<16;++O)D.table[O]=0;for(O=0;O<I;++O)D.table[F[E+O]]++;for(D.table[0]=0,P=0,O=0;O<16;++O)w[O]=P,P+=D.table[O];for(O=0;O<I;++O)F[E+O]&&(D.trans[w[F[E+O]]++]=O)}function b(D){D.bitcount--||(D.tag=D.source[D.sourceIndex++],D.bitcount=7);var F=1&D.tag;return D.tag>>>=1,F}function L(D,F,E){if(!F)return E;for(;D.bitcount<24;)D.tag|=D.source[D.sourceIndex++]<<D.bitcount,D.bitcount+=8;var I=D.tag&65535>>>16-F;return D.tag>>>=F,D.bitcount-=F,I+E}function A(D,F){for(;D.bitcount<24;)D.tag|=D.source[D.sourceIndex++]<<D.bitcount,D.bitcount+=8;var E=0,I=0,O=0,P=D.tag;do I=2*I+(1&P),P>>>=1,++O,E+=F.table[O],I-=F.table[O];while(I>=0);return D.tag=P,D.bitcount-=O,F.trans[E+I]}function T(D,F,E){var I,O,P,J,j,X;for(I=L(D,5,257),O=L(D,5,1),P=L(D,4,4),J=0;J<19;++J)p[J]=0;for(J=0;J<P;++J){var V=L(D,3,0);p[r[J]]=V}for(v(l,p,0,19),j=0;j<I+O;){var re=A(D,l);switch(re){case 16:var G=p[j-1];for(X=L(D,2,3);X;--X)p[j++]=G;break;case 17:for(X=L(D,3,3);X;--X)p[j++]=0;break;case 18:for(X=L(D,7,11);X;--X)p[j++]=0;break;default:p[j++]=re}}v(F,p,0,I),v(E,p,I,O)}function B(D,F,E){for(;;){var I,O,P,J,j=A(D,F);if(j===256)return 0;if(j<256)D.dest[D.destLen++]=j;else for(I=L(D,o[j-=257],t[j]),O=A(D,E),J=P=D.destLen-L(D,h[O],s[O]);J<P+I;++J)D.dest[D.destLen++]=D.dest[J]}}function U(D){for(var F,E;D.bitcount>8;)D.sourceIndex--,D.bitcount-=8;if((F=256*(F=D.source[D.sourceIndex+1])+D.source[D.sourceIndex])!==(65535&~(256*D.source[D.sourceIndex+3]+D.source[D.sourceIndex+2])))return-3;for(D.sourceIndex+=4,E=F;E;--E)D.dest[D.destLen++]=D.source[D.sourceIndex++];return D.bitcount=0,0}(function(D,F){var E;for(E=0;E<7;++E)D.table[E]=0;for(D.table[7]=24,D.table[8]=152,D.table[9]=112,E=0;E<24;++E)D.trans[E]=256+E;for(E=0;E<144;++E)D.trans[24+E]=E;for(E=0;E<8;++E)D.trans[168+E]=280+E;for(E=0;E<112;++E)D.trans[176+E]=144+E;for(E=0;E<5;++E)F.table[E]=0;for(F.table[5]=32,E=0;E<32;++E)F.trans[E]=E})(y,_),g(o,t,4,3),g(h,s,2,1),o[28]=0,t[28]=258,f.exports=function(D,F){var E,I,O=new d(D,F);do{switch(E=b(O),L(O,2,0)){case 0:I=U(O);break;case 1:I=B(O,y,_);break;case 2:T(O,O.ltree,O.dtree),I=B(O,O.ltree,O.dtree);break;default:I=-3}if(I!==0)throw new Error("Data error")}while(!E);return O.destLen<O.dest.length?typeof O.dest.slice=="function"?O.dest.slice(0,O.destLen):O.dest.subarray(0,O.destLen):O.dest}},371:f=>{f.exports=function(u){u.prototype[Symbol.iterator]=function*(){for(let d=this.head;d;d=d.next)yield d.value}}},411:(f,u,d)=>{function y(s){var r=this;if(r instanceof y||(r=new y),r.tail=null,r.head=null,r.length=0,s&&typeof s.forEach=="function")s.forEach(function(g){r.push(g)});else if(arguments.length>0)for(var l=0,p=arguments.length;l<p;l++)r.push(arguments[l]);return r}function _(s,r,l){var p=r===s.head?new h(l,null,r,s):new h(l,r,r.next,s);return p.next===null&&(s.tail=p),p.prev===null&&(s.head=p),s.length++,p}function o(s,r){s.tail=new h(r,s.tail,null,s),s.head||(s.head=s.tail),s.length++}function t(s,r){s.head=new h(r,null,s.head,s),s.tail||(s.tail=s.head),s.length++}function h(s,r,l,p){if(!(this instanceof h))return new h(s,r,l,p);this.list=p,this.value=s,r?(r.next=this,this.prev=r):this.prev=null,l?(l.prev=this,this.next=l):this.next=null}f.exports=y,y.Node=h,y.create=y,y.prototype.removeNode=function(s){if(s.list!==this)throw new Error("removing node which does not belong to this list");var r=s.next,l=s.prev;return r&&(r.prev=l),l&&(l.next=r),s===this.head&&(this.head=r),s===this.tail&&(this.tail=l),s.list.length--,s.next=null,s.prev=null,s.list=null,r},y.prototype.unshiftNode=function(s){if(s!==this.head){s.list&&s.list.removeNode(s);var r=this.head;s.list=this,s.next=r,r&&(r.prev=s),this.head=s,this.tail||(this.tail=s),this.length++}},y.prototype.pushNode=function(s){if(s!==this.tail){s.list&&s.list.removeNode(s);var r=this.tail;s.list=this,s.prev=r,r&&(r.next=s),this.tail=s,this.head||(this.head=s),this.length++}},y.prototype.push=function(){for(var s=0,r=arguments.length;s<r;s++)o(this,arguments[s]);return this.length},y.prototype.unshift=function(){for(var s=0,r=arguments.length;s<r;s++)t(this,arguments[s]);return this.length},y.prototype.pop=function(){if(this.tail){var s=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,s}},y.prototype.shift=function(){if(this.head){var s=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,s}},y.prototype.forEach=function(s,r){r=r||this;for(var l=this.head,p=0;l!==null;p++)s.call(r,l.value,p,this),l=l.next},y.prototype.forEachReverse=function(s,r){r=r||this;for(var l=this.tail,p=this.length-1;l!==null;p--)s.call(r,l.value,p,this),l=l.prev},y.prototype.get=function(s){for(var r=0,l=this.head;l!==null&&r<s;r++)l=l.next;if(r===s&&l!==null)return l.value},y.prototype.getReverse=function(s){for(var r=0,l=this.tail;l!==null&&r<s;r++)l=l.prev;if(r===s&&l!==null)return l.value},y.prototype.map=function(s,r){r=r||this;for(var l=new y,p=this.head;p!==null;)l.push(s.call(r,p.value,this)),p=p.next;return l},y.prototype.mapReverse=function(s,r){r=r||this;for(var l=new y,p=this.tail;p!==null;)l.push(s.call(r,p.value,this)),p=p.prev;return l},y.prototype.reduce=function(s,r){var l,p=this.head;if(arguments.length>1)l=r;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");p=this.head.next,l=this.head.value}for(var g=0;p!==null;g++)l=s(l,p.value,g),p=p.next;return l},y.prototype.reduceReverse=function(s,r){var l,p=this.tail;if(arguments.length>1)l=r;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");p=this.tail.prev,l=this.tail.value}for(var g=this.length-1;p!==null;g--)l=s(l,p.value,g),p=p.prev;return l},y.prototype.toArray=function(){for(var s=new Array(this.length),r=0,l=this.head;l!==null;r++)s[r]=l.value,l=l.next;return s},y.prototype.toArrayReverse=function(){for(var s=new Array(this.length),r=0,l=this.tail;l!==null;r++)s[r]=l.value,l=l.prev;return s},y.prototype.slice=function(s,r){(r=r||this.length)<0&&(r+=this.length),(s=s||0)<0&&(s+=this.length);var l=new y;if(r<s||r<0)return l;s<0&&(s=0),r>this.length&&(r=this.length);for(var p=0,g=this.head;g!==null&&p<s;p++)g=g.next;for(;g!==null&&p<r;p++,g=g.next)l.push(g.value);return l},y.prototype.sliceReverse=function(s,r){(r=r||this.length)<0&&(r+=this.length),(s=s||0)<0&&(s+=this.length);var l=new y;if(r<s||r<0)return l;s<0&&(s=0),r>this.length&&(r=this.length);for(var p=this.length,g=this.tail;g!==null&&p>r;p--)g=g.prev;for(;g!==null&&p>s;p--,g=g.prev)l.push(g.value);return l},y.prototype.splice=function(s,r,...l){s>this.length&&(s=this.length-1),s<0&&(s=this.length+s);for(var p=0,g=this.head;g!==null&&p<s;p++)g=g.next;var w=[];for(p=0;g&&p<r;p++)w.push(g.value),g=this.removeNode(g);for(g===null&&(g=this.tail),g!==this.head&&g!==this.tail&&(g=g.prev),p=0;p<l.length;p++)g=_(this,g,l[p]);return w},y.prototype.reverse=function(){for(var s=this.head,r=this.tail,l=s;l!==null;l=l.prev){var p=l.prev;l.prev=l.next,l.next=p}return this.head=r,this.tail=s,this};try{d(371)(y)}catch{}},109:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0});const y=d(98),_=d(104);let o;u.default=async function(h,s){var r,l;if(!o){if(typeof navigator<"u"&&"fonts"in navigator){try{const w=await((l=(r=navigator.permissions).request)===null||l===void 0?void 0:l.call(r,{name:"local-fonts"}));if(w&&w.state!=="granted")throw new Error("Permission to access local fonts not granted.")}catch(w){if(w.name!=="TypeError")throw w}const g={};try{const w=await navigator.fonts.query();for(const v of w)g.hasOwnProperty(v.family)||(g[v.family]=[]),g[v.family].push(v);o=Promise.resolve(g)}catch(w){console.error(w.name,w.message)}}else if(typeof process!="object"&&"queryLocalFonts"in window){const g={};try{const w=await window.queryLocalFonts();for(const v of w)g.hasOwnProperty(v.family)||(g[v.family]=[]),g[v.family].push(v);o=Promise.resolve(g)}catch(w){console.error(w.name,w.message)}}o||(o=Promise.resolve({}))}const p=await o;for(const g of(0,_.default)(h)){if(t.includes(g))return;if(p.hasOwnProperty(g)&&p[g].length>0){const w=p[g][0];if("blob"in w){const v=await w.blob(),b=await v.arrayBuffer();return(0,y.loadBuffer)(b,{cacheSize:s})}return}}};const t=["serif","sans-serif","cursive","fantasy","monospace","system-ui","emoji","math","fangsong"]},833:(f,u,d)=>{Object.defineProperty(u,"__esModule",{value:!0}),u.enableLigatures=void 0;const y=d(109);u.enableLigatures=function(_,o=[]){let t,h,s,r=0;return _.registerCharacterJoiner(l=>{const p=_.options.fontFamily;if(p&&(r===0||t!==p)){h=void 0,r=1,t=p;const g=t;(0,y.default)(g,1e5).then(w=>{g===_.options.fontFamily&&(r=2,h=w,w&&_.refresh(0,_.rows-1))}).catch(w=>{g===_.options.fontFamily&&(r=3,_.options.logLevel==="debug"&&console.debug(s,new Error("Failure while loading font")),h=void 0,s=w)})}return h&&r===2?h.findLigatureRanges(l).map(g=>[g[0],g[1]]):function(g,w){const v=[];for(let b=0;b<g.length;b++)for(let L=0;L<w.length;L++)if(g.startsWith(w[L],b)){v.push([b,b+w[L].length]),b+=w[L].length-1;break}return v}(l,o)})}},104:(f,u)=>{function d(t,h){let s="",r=!1;for(;t.offset<t.input.length;){const l=t.input[t.offset++];if(r)/[\dA-Fa-f]/.test(l)?(t.offset--,s+=_(t)):l!==`
`&&(s+=l),r=!1;else switch(l){case h:return s;case"\\":r=!0;break;default:s+=l}}throw new Error("Unterminated string")}function y(t){let h="",s=!1;for(;t.offset<t.input.length;){const r=t.input[t.offset++];if(s)/[\dA-Fa-f]/.test(r)?(t.offset--,h+=_(t)):h+=r,s=!1;else switch(r){case"\\":s=!0;break;case",":return h;default:/\s/.test(r)?h.endsWith(" ")||(h+=" "):h+=r}}return h}function _(t){let h="";for(;t.offset<t.input.length;){const s=t.input[t.offset++];if(/\s/.test(s))return o(h);if(h.length>=6||!/[\dA-Fa-f]/.test(s))return t.offset--,o(h);h+=s}return o(h)}function o(t){return String.fromCodePoint(parseInt(t,16))}Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(t){if(typeof t!="string")throw new Error("Font family must be a string");const h={input:t,offset:0},s=[];let r="";for(;h.offset<h.input.length;){const l=h.input[h.offset++];switch(l){case"'":case'"':r+=d(h,l);break;case",":s.push(r),r="";break;default:/\s/.test(l)||(h.offset--,r+=y(h),s.push(r),r="")}}return s}},89:f=>{f.exports=ee},56:f=>{f.exports=se},978:f=>{f.exports=he},269:f=>{f.exports=pe},82:()=>{},456:()=>{}},c={};function S(f){var u=c[f];if(u!==void 0)return u.exports;var d=c[f]={exports:{}};return q[f].call(d.exports,d,d.exports,S),d.exports}S.n=f=>{var u=f&&f.__esModule?()=>f.default:()=>f;return S.d(u,{a:u}),u},S.d=(f,u)=>{for(var d in u)S.o(u,d)&&!S.o(f,d)&&Object.defineProperty(f,d,{enumerable:!0,get:u[d]})},S.o=(f,u)=>Object.prototype.hasOwnProperty.call(f,u),S.r=f=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(f,"__esModule",{value:!0})};var m={};return(()=>{var f=m;Object.defineProperty(f,"__esModule",{value:!0}),f.LigaturesAddon=void 0;const u=S(833);f.LigaturesAddon=class{constructor(d){this._fallbackLigatures=((d==null?void 0:d.fallbackLigatures)||["<--","<---","<<-","<-","->","->>","-->","--->","<==","<===","<<=","<=","=>","=>>","==>","===>",">=",">>=","<->","<-->","<--->","<---->","<=>","<==>","<===>","<====>","-------->","<~~","<~","~>","~~>","::",":::","==","!=","===","!==",":=",":-",":+","<*","<*>","*>","<|","<|>","|>","+:","-:","=:",":>","++","+++","<!--","<!---","<***>"]).sort((y,_)=>_.length-y.length)}activate(d){this._terminal=d,this._characterJoinerId=(0,u.enableLigatures)(d,this._fallbackLigatures)}dispose(){var d;this._characterJoinerId!==void 0&&((d=this._terminal)===null||d===void 0||d.deregisterCharacterJoiner(this._characterJoinerId),this._characterJoinerId=void 0)}}})(),m})()})})(vi,vi.exports);var xn=vi.exports,Qr={exports:{}};(function(K,H){(function(ee,se){K.exports=se()})(self,function(){return(()=>{var ee={345:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.forwardEvent=c.EventEmitter=void 0,c.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=S=>(this._listeners.push(S),{dispose:()=>{if(!this._disposed){for(let m=0;m<this._listeners.length;m++)if(this._listeners[m]===S)return void this._listeners.splice(m,1)}}})),this._event}fire(S,m){const f=[];for(let u=0;u<this._listeners.length;u++)f.push(this._listeners[u]);for(let u=0;u<f.length;u++)f[u].call(void 0,S,m)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},c.forwardEvent=function(S,m){return S(f=>m.fire(f))}}},se={};function pe(q){var c=se[q];if(c!==void 0)return c.exports;var S=se[q]={exports:{}};return ee[q](S,S.exports,pe),S.exports}var he={};return(()=>{var q=he;Object.defineProperty(q,"__esModule",{value:!0}),q.SearchAddon=void 0;const c=pe(345),S=" ~!@#$%^&*()+`-=[]{}|\\;:\"',./<>?";q.SearchAddon=class{constructor(){this._linesCacheTimeoutId=0,this._onDidChangeResults=new c.EventEmitter,this.onDidChangeResults=this._onDidChangeResults.event}activate(m){this._terminal=m,this._onDataDisposable=this._terminal.onWriteParsed(()=>this._updateMatches()),this._onResizeDisposable=this._terminal.onResize(()=>this._updateMatches())}_updateMatches(){var m;this._highlightTimeout&&window.clearTimeout(this._highlightTimeout),this._cachedSearchTerm&&(!((m=this._lastSearchOptions)===null||m===void 0)&&m.decorations)&&(this._highlightTimeout=setTimeout(()=>{var f,u;this.findPrevious(this._cachedSearchTerm,Object.assign(Object.assign({},this._lastSearchOptions),{incremental:!0,noScroll:!0})),this._resultIndex=this._searchResults?this._searchResults.size-1:-1,this._onDidChangeResults.fire({resultIndex:this._resultIndex,resultCount:(u=(f=this._searchResults)===null||f===void 0?void 0:f.size)!==null&&u!==void 0?u:-1})},200))}dispose(){var m,f;this.clearDecorations(),(m=this._onDataDisposable)===null||m===void 0||m.dispose(),(f=this._onResizeDisposable)===null||f===void 0||f.dispose()}clearDecorations(m){var f,u,d,y;(f=this._selectedDecoration)===null||f===void 0||f.dispose(),(u=this._searchResults)===null||u===void 0||u.clear(),(d=this._resultDecorations)===null||d===void 0||d.forEach(_=>{for(const o of _)o.dispose()}),(y=this._resultDecorations)===null||y===void 0||y.clear(),this._searchResults=void 0,this._resultDecorations=void 0,m||(this._cachedSearchTerm=void 0)}clearActiveDecoration(){var m;(m=this._selectedDecoration)===null||m===void 0||m.dispose(),this._selectedDecoration=void 0}findNext(m,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");return this._lastSearchOptions=f,f!=null&&f.decorations&&(this._resultIndex===void 0&&this._cachedSearchTerm!==void 0&&m===this._cachedSearchTerm||this._highlightAllMatches(m,f)),this._fireResults(m,this._findNextAndSelect(m,f),f)}_highlightAllMatches(m,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");if(!m||m.length===0)return void this.clearDecorations();f=f||{},this.clearDecorations(!0),this._searchResults=new Map,this._resultDecorations=new Map;const u=this._resultDecorations;let d=this._find(m,0,0,f);for(;d&&!this._searchResults.get(`${d.row}-${d.col}`);)if(this._searchResults.set(`${d.row}-${d.col}`,d),d=this._find(m,d.col+d.term.length>=this._terminal.cols?d.row+1:d.row,d.col+d.term.length>=this._terminal.cols?0:d.col+1,f),this._searchResults.size>1e3)return this.clearDecorations(),void(this._resultIndex=void 0);this._searchResults.forEach(y=>{const _=this._createResultDecoration(y,f.decorations);if(_){const o=u.get(_.marker.line)||[];o.push(_),u.set(_.marker.line,o)}})}_find(m,f,u,d){var y;if(!this._terminal||!m||m.length===0)return(y=this._terminal)===null||y===void 0||y.clearSelection(),void this.clearDecorations();if(u>this._terminal.cols)throw new Error(`Invalid col: ${u} to search in terminal of ${this._terminal.cols} cols`);let _;this._initLinesCache();const o={startRow:f,startCol:u};if(_=this._findInLine(m,o,d),!_)for(let t=f+1;t<this._terminal.buffer.active.baseY+this._terminal.rows&&(o.startRow=t,o.startCol=0,_=this._findInLine(m,o,d),!_);t++);return _}_findNextAndSelect(m,f){var u;if(!this._terminal||!m||m.length===0)return(u=this._terminal)===null||u===void 0||u.clearSelection(),this.clearDecorations(),this._cachedSearchTerm=void 0,this._resultIndex=-1,!1;this._cachedSearchTerm!==m&&(this._resultIndex=void 0,this._terminal.clearSelection());let d,y=0,_=0;if(this._terminal.hasSelection()){const h=!!f&&f.incremental;d=this._terminal.getSelectionPosition(),_=h?d.start.y:d.end.y,y=h?d.start.x:d.end.x}this._initLinesCache();const o={startRow:_,startCol:y};let t=this._findInLine(m,o,f);if(!t)for(let h=_+1;h<this._terminal.buffer.active.baseY+this._terminal.rows&&(o.startRow=h,o.startCol=0,t=this._findInLine(m,o,f),!t);h++);if(!t&&_!==0)for(let h=0;h<_&&(o.startRow=h,o.startCol=0,t=this._findInLine(m,o,f),!t);h++);return!t&&d&&(o.startRow=d.start.y,o.startCol=0,t=this._findInLine(m,o,f)),this._searchResults&&(this._searchResults.size===0?this._resultIndex=-1:this._resultIndex===void 0?this._resultIndex=0:(this._resultIndex++,this._resultIndex>=this._searchResults.size&&(this._resultIndex=0))),this._selectResult(t,f==null?void 0:f.decorations,f==null?void 0:f.noScroll)}findPrevious(m,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");return this._lastSearchOptions=f,f!=null&&f.decorations&&(this._resultIndex===void 0&&this._cachedSearchTerm!==void 0&&m===this._cachedSearchTerm||this._highlightAllMatches(m,f)),this._fireResults(m,this._findPreviousAndSelect(m,f),f)}_fireResults(m,f,u){var d;return u!=null&&u.decorations&&(this._resultIndex!==void 0&&((d=this._searchResults)===null||d===void 0?void 0:d.size)!==void 0?this._onDidChangeResults.fire({resultIndex:this._resultIndex,resultCount:this._searchResults.size}):this._onDidChangeResults.fire(void 0)),this._cachedSearchTerm=m,f}_findPreviousAndSelect(m,f){var u;if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");let d;if(!this._terminal||!m||m.length===0)return d=void 0,(u=this._terminal)===null||u===void 0||u.clearSelection(),this.clearDecorations(),this._resultIndex=-1,!1;this._cachedSearchTerm!==m&&(this._resultIndex=void 0,this._terminal.clearSelection());let y=this._terminal.buffer.active.baseY+this._terminal.rows,_=this._terminal.cols;const o=!0,t=!!f&&f.incremental;let h;this._terminal.hasSelection()&&(h=this._terminal.getSelectionPosition(),y=h.start.y,_=h.start.x),this._initLinesCache();const s={startRow:y,startCol:_};if(t?(d=this._findInLine(m,s,f,!1),d&&d.row===y&&d.col===_||(h&&(s.startRow=h.end.y,s.startCol=h.end.x),d=this._findInLine(m,s,f,!0))):d=this._findInLine(m,s,f,o),!d){s.startCol=Math.max(s.startCol,this._terminal.cols);for(let r=y-1;r>=0&&(s.startRow=r,d=this._findInLine(m,s,f,o),!d);r--);}if(!d&&y!==this._terminal.buffer.active.baseY+this._terminal.rows)for(let r=this._terminal.buffer.active.baseY+this._terminal.rows;r>=y&&(s.startRow=r,d=this._findInLine(m,s,f,o),!d);r--);return this._searchResults&&(this._searchResults.size===0?this._resultIndex=-1:this._resultIndex===void 0||this._resultIndex<0?this._resultIndex=this._searchResults.size-1:(this._resultIndex--,this._resultIndex===-1&&(this._resultIndex=this._searchResults.size-1))),!(d||!h)||this._selectResult(d,f==null?void 0:f.decorations,f==null?void 0:f.noScroll)}_initLinesCache(){const m=this._terminal;this._linesCache||(this._linesCache=new Array(m.buffer.active.length),this._cursorMoveListener=m.onCursorMove(()=>this._destroyLinesCache()),this._resizeListener=m.onResize(()=>this._destroyLinesCache())),window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=window.setTimeout(()=>this._destroyLinesCache(),15e3)}_destroyLinesCache(){this._linesCache=void 0,this._cursorMoveListener&&(this._cursorMoveListener.dispose(),this._cursorMoveListener=void 0),this._resizeListener&&(this._resizeListener.dispose(),this._resizeListener=void 0),this._linesCacheTimeoutId&&(window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=0)}_isWholeWord(m,f,u){return(m===0||S.includes(f[m-1]))&&(m+u.length===f.length||S.includes(f[m+u.length]))}_findInLine(m,f,u={},d=!1){var y;const _=this._terminal,o=f.startRow,t=f.startCol,h=_.buffer.active.getLine(o);if(h!=null&&h.isWrapped)return d?void(f.startCol+=_.cols):(f.startRow--,f.startCol+=_.cols,this._findInLine(m,f,u));let s=(y=this._linesCache)===null||y===void 0?void 0:y[o];s||(s=this._translateBufferLineToStringWithWrap(o,!0),this._linesCache&&(this._linesCache[o]=s));const[r,l]=s,p=this._bufferColsToStringOffset(o,t),g=u.caseSensitive?m:m.toLowerCase(),w=u.caseSensitive?r:r.toLowerCase();let v=-1;if(u.regex){const b=RegExp(g,"g");let L;if(d)for(;L=b.exec(w.slice(0,p));)v=b.lastIndex-L[0].length,m=L[0],b.lastIndex-=m.length-1;else L=b.exec(w.slice(p)),L&&L[0].length>0&&(v=p+(b.lastIndex-L[0].length),m=L[0])}else d?p-g.length>=0&&(v=w.lastIndexOf(g,p-g.length)):v=w.indexOf(g,p);if(v>=0){if(u.wholeWord&&!this._isWholeWord(v,w,m))return;let b=0;for(;b<l.length-1&&v>=l[b+1];)b++;let L=b;for(;L<l.length-1&&v+m.length>=l[L+1];)L++;const A=v-l[b],T=v+m.length-l[L],B=this._stringLengthToBufferSize(o+b,A);return{term:m,col:B,row:o+b,size:this._stringLengthToBufferSize(o+L,T)-B+_.cols*(L-b)}}}_stringLengthToBufferSize(m,f){const u=this._terminal.buffer.active.getLine(m);if(!u)return 0;for(let d=0;d<f;d++){const y=u.getCell(d);if(!y)break;const _=y.getChars();_.length>1&&(f-=_.length-1);const o=u.getCell(d+1);o&&o.getWidth()===0&&f++}return f}_bufferColsToStringOffset(m,f){const u=this._terminal;let d=m,y=0,_=u.buffer.active.getLine(d);for(;f>0&&_;){for(let o=0;o<f&&o<u.cols;o++){const t=_.getCell(o);if(!t)break;t.getWidth()&&(y+=t.getCode()===0?1:t.getChars().length)}if(d++,_=u.buffer.active.getLine(d),_&&!_.isWrapped)break;f-=u.cols}return y}_translateBufferLineToStringWithWrap(m,f){var u;const d=this._terminal,y=[],_=[0];let o=d.buffer.active.getLine(m);for(;o;){const t=d.buffer.active.getLine(m+1),h=!!t&&t.isWrapped;let s=o.translateToString(!h&&f);if(h&&t){const r=o.getCell(o.length-1);r&&r.getCode()===0&&r.getWidth()===1&&((u=t.getCell(0))===null||u===void 0?void 0:u.getWidth())===2&&(s=s.slice(0,-1))}if(y.push(s),!h)break;_.push(_[_.length-1]+s.length),m++,o=t}return[y.join(""),_]}_selectResult(m,f,u){var d,y;const _=this._terminal;if(this.clearActiveDecoration(),!m)return _.clearSelection(),!1;if(_.select(m.col,m.row,m.size),f){const o=_.registerMarker(-_.buffer.active.baseY-_.buffer.active.cursorY+m.row);o&&(this._selectedDecoration=_.registerDecoration({marker:o,x:m.col,width:m.size,backgroundColor:f.activeMatchBackground,layer:"top",overviewRulerOptions:{color:f.activeMatchColorOverviewRuler}}),(d=this._selectedDecoration)===null||d===void 0||d.onRender(t=>this._applyStyles(t,f.activeMatchBorder,!0)),(y=this._selectedDecoration)===null||y===void 0||y.onDispose(()=>o.dispose()))}if(!u&&(m.row>=_.buffer.active.viewportY+_.rows||m.row<_.buffer.active.viewportY)){let o=m.row-_.buffer.active.viewportY;o-=Math.floor(_.rows/2),_.scrollLines(o)}return!0}_applyStyles(m,f,u){m.clientWidth<=0||(m.classList.contains("xterm-find-result-decoration")||(m.classList.add("xterm-find-result-decoration"),f&&(m.style.outline=`1px solid ${f}`)),u&&m.classList.add("xterm-find-active-result-decoration"))}_createResultDecoration(m,f){var u;const d=this._terminal,y=d.registerMarker(-d.buffer.active.baseY-d.buffer.active.cursorY+m.row);if(!y)return;const _=d.registerDecoration({marker:y,x:m.col,width:m.size,backgroundColor:f.matchBackground,overviewRulerOptions:!((u=this._resultDecorations)===null||u===void 0)&&u.get(y.line)?void 0:{color:f.matchOverviewRuler,position:"center"}});return _==null||_.onRender(o=>this._applyStyles(o,f.matchBorder,!1)),_==null||_.onDispose(()=>y.dispose()),_}}})(),he})()})})(Qr);var Ln=Qr.exports,es={exports:{}};(function(K,H){(function(ee,se){K.exports=se()})(self,function(){return(()=>{var ee={6:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.LinkComputer=c.WebLinkProvider=void 0,c.WebLinkProvider=class{constructor(m,f,u,d={}){this._terminal=m,this._regex=f,this._handler=u,this._options=d}provideLinks(m,f){const u=S.computeLink(m,this._regex,this._terminal,this._handler);f(this._addCallbacks(u))}_addCallbacks(m){return m.map(f=>(f.leave=this._options.leave,f.hover=(u,d)=>{if(this._options.hover){const{range:y}=f;this._options.hover(u,d,y)}},f))}};class S{static computeLink(f,u,d,y){const _=new RegExp(u.source,(u.flags||"")+"g"),[o,t]=S._translateBufferLineToStringWithWrap(f-1,!1,d);let h,s=-1;const r=[];for(;(h=_.exec(o))!==null;){const l=h[1];if(!l){console.log("match found without corresponding matchIndex");break}if(s=o.indexOf(l,s+1),_.lastIndex=s+l.length,s<0)break;let p=s+l.length,g=t+1;for(;p>d.cols;)p-=d.cols,g++;let w=s+1,v=t+1;for(;w>d.cols;)w-=d.cols,v++;const b={start:{x:w,y:v},end:{x:p,y:g}};r.push({range:b,text:l,activate:y})}return r}static _translateBufferLineToStringWithWrap(f,u,d){let y,_,o="";do{const h=d.buffer.active.getLine(f);if(!h)break;h.isWrapped&&f--,_=h.isWrapped}while(_);const t=f;do{const h=d.buffer.active.getLine(f+1);y=!!h&&h.isWrapped;const s=d.buffer.active.getLine(f);if(!s)break;o+=s.translateToString(!y&&u).substring(0,d.cols),f++}while(y);return[o,t]}}c.LinkComputer=S}},se={};function pe(q){var c=se[q];if(c!==void 0)return c.exports;var S=se[q]={exports:{}};return ee[q](S,S.exports,pe),S.exports}var he={};return(()=>{var q=he;Object.defineProperty(q,"__esModule",{value:!0}),q.WebLinksAddon=void 0;const c=pe(6),S=new RegExp(`(?:^|[^\\da-z\\.-]+)((https?:\\/\\/)((([\\da-z\\.-]+)\\.([a-z\\.]{2,18}))|((\\d{1,3}\\.){3}\\d{1,3})|(localhost))(:\\d{1,5})?((\\/[\\/\\w\\.\\-%~:+@]*)*([^:"'\\s]))?(\\?[0-9\\w\\[\\]\\(\\)\\/\\?\\!#@$%&'*+,:;~\\=\\.\\-]*)?(#[0-9\\w\\[\\]\\(\\)\\/\\?\\!#@$%&'*+,:;~\\=\\.\\-]*)?)($|[^\\/\\w\\.\\-%]+)`);function m(f,u){const d=window.open();if(d){try{d.opener=null}catch{}d.location.href=u}else console.warn("Opening link blocked as opener could not be cleared")}q.WebLinksAddon=class{constructor(f=m,u={}){this._handler=f,this._options=u}activate(f){this._terminal=f;const u=this._options,d=u.urlRegex||S;this._linkProvider=this._terminal.registerLinkProvider(new c.WebLinkProvider(this._terminal,d,this._handler,u))}dispose(){var f;(f=this._linkProvider)===null||f===void 0||f.dispose()}}})(),he})()})})(es);var En=es.exports;const kn={foreground:"#eeeeec",background:"#300a24",cursor:"#bbbbbb",black:"#2e3436",brightBlack:"#555753",red:"#cc0000",brightRed:"#ef2929",green:"#4e9a06",brightGreen:"#8ae234",yellow:"#c4a000",brightYellow:"#fce94f",blue:"#3465a4",brightBlue:"#729fcf",magenta:"#75507b",brightMagenta:"#ad7fa8",cyan:"#06989a",brightCyan:"#34e2e2",white:"#d3d7cf",brightWhite:"#eeeeec"},Rn={foreground:"#F8F8F2",background:"#282A36",cursor:"#bbbbbb",selectionBackground:"#44475A",black:"#21222C",brightBlack:"#6272A4",red:"#FF5555",brightRed:"#FF6E6E",green:"#50FA7B",brightGreen:"#69FF94",yellow:"#F1FA8C",brightYellow:"#FFFFA5",blue:"#BD93F9",brightBlue:"#D6ACFF",magenta:"#FF79C6",brightMagenta:"#FF92DF",cyan:"#8BE9FD",brightCyan:"#A4FFFF",white:"#F8F8F2",brightWhite:"#FFFFFF"},An={foreground:"#abb2bf",background:"#282c34",cursor:"#bbbbbb",selectionBackground:"#abb2bf30",black:"#3f4451",brightBlack:"#4f5666",red:"#e05561",brightRed:"#ff616e",green:"#8cc265",brightGreen:"#a5e075",yellow:"#d18f52",brightYellow:"#f0a45d",blue:"#4aa5f0",brightBlue:"#4dc4ff",magenta:"#c162de",brightMagenta:"#de73ff",cyan:"#42b3c2",brightCyan:"#4cd1e0",white:"#d7dae0",brightWhite:"#e6e6e6"},Tn={foreground:"#C5C8C6",background:"#161719",cursor:"#D0D0D0",black:"#000000",brightBlack:"#000000",red:"#FD5FF1",brightRed:"#FD5FF1",green:"#87C38A",brightGreen:"#94FA36",yellow:"#FFD7B1",brightYellow:"#F5FFA8",blue:"#85BEFD",brightBlue:"#96CBFE",magenta:"#B9B6FC",brightMagenta:"#B9B6FC",cyan:"#85BEFD",brightCyan:"#85BEFD",white:"#E0E0E0",brightWhite:"#E0E0E0"},_i=K=>{switch(K){case"Ubuntu":return kn;case"Dracula":return Rn;case"Arthur":return Tn;case"OneDark":return An;case"Default":return}const H=document.documentElement.style;function ee(se){return H.getPropertyValue(se)}return{cursor:ee("--vscode-editorCursor-foreground"),foreground:ee("--vscode-terminal-foreground"),background:ee("--vscode-editor-background"),black:ee("--vscode-terminal-ansiBlack"),brightBlack:ee("--vscode-terminal-ansiBrightBlack"),blue:ee("--vscode-terminal-ansiBlue"),brightBlue:ee("--vscode-terminal-ansBrightiBlue"),green:ee("--vscode-terminal-ansiGreen"),brightGreen:ee("--vscode-terminal-ansiBrightGreen"),red:ee("--vscode-terminal-ansiRed"),brightRed:ee("--vscode-terminal-ansiBrightRed"),cyan:ee("--vscode-terminal-ansiCyan"),brightCyan:ee("--vscode-terminal-ansiBrightCyan"),magenta:ee("--vscode-terminal-ansiMagenta"),brightMagenta:ee("--vscode-terminal-ansiBrightMagenta"),yellow:ee("--vscode-terminal-ansiYellow"),brightYellow:ee("--vscode-terminal-ansiBrightYellow"),white:ee("--vscode-terminal-ansiWhite"),brightWhite:ee("--vscode-terminal-ansiBrightWhite"),selectionBackground:ee("--vscode-editor-selectionBackground")}};/*!
 * xterm-addon-search-bar.js v0.2.0
 * (c) 2018-2020 yinshuxun
 * Released under the MIT License.
 */function Dn(K,H){H===void 0&&(H={});var ee=H.insertAt;if(!(!K||typeof document>"u")){var se=document.head||document.getElementsByTagName("head")[0],pe=document.createElement("style");pe.type="text/css",ee==="top"&&se.firstChild?se.insertBefore(pe,se.firstChild):se.appendChild(pe),pe.styleSheet?pe.styleSheet.cssText=K:pe.appendChild(document.createTextNode(K))}}var Mn='.xterm-search-bar__addon{position:absolute;max-width:1467px;top:0;right:28px;color:#000;background:#fff;padding:5px 10px;box-shadow:0 2px 8px #000;background-color:#252526;z-index:999;display:flex}.xterm-search-bar__addon .search-bar__input{background-color:#3c3c3c;color:#ccc;border:0;padding:2px;height:20px;width:227px}.xterm-search-bar__addon .search-bar__btn{min-width:20px;width:20px;height:20px;display:flex;display:-webkit-flex;flex:initial;background-position:50%;margin-left:3px;background-repeat:no-repeat;background-color:#252526;border:0;cursor:pointer}.xterm-search-bar__addon .search-bar__btn:hover{background-color:#666}.xterm-search-bar__addon .search-bar__btn.prev{margin-left:20px;background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0iI2ZmZiI+PHBhdGggZD0iTTUuNCA4YS42LjYgMCAwMS4xNzYtLjQyNGw0LTRhLjU5OC41OTggMCAwMS44NDggMCAuNTk4LjU5OCAwIDAxMCAuODQ4TDYuODQ5IDhsMy41NzUgMy41NzZhLjU5OC41OTggMCAwMTAgLjg0OC41OTguNTk4IDAgMDEtLjg0OCAwbC00LTRBLjYuNiAwIDAxNS40IDgiLz48L3N2Zz4=")}.xterm-search-bar__addon .search-bar__btn.next{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0iI2ZmZiI+PHBhdGggZD0iTTEwLjYgOGEuNi42IDAgMDEtLjE3Ni40MjRsLTQgNGEuNTk4LjU5OCAwIDAxLS44NDggMCAuNTk4LjU5OCAwIDAxMC0uODQ4TDkuMTUxIDggNS41NzYgNC40MjRhLjU5OC41OTggMCAwMTAtLjg0OC41OTguNTk4IDAgMDEuODQ4IDBsNCA0QS42LjYgMCAwMTEwLjYgOCIvPjwvc3ZnPg==")}.xterm-search-bar__addon .search-bar__btn.close{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0iI2ZmZiI+PHBhdGggZD0iTTcgNmwyLTJhLjcxMS43MTEgMCAwMDAtMSAuNzExLjcxMSAwIDAwLTEgMEw2IDUgNCAzYS43MTEuNzExIDAgMDAtMSAwIC43MTEuNzExIDAgMDAwIDFsMiAyLTIgMmEuNzExLjcxMSAwIDAwMCAxIC43MTEuNzExIDAgMDAxIDBsMi0yIDIgMmEuNzExLjcxMSAwIDAwMSAwIC43MTEuNzExIDAgMDAwLTFMNyA2eiIvPjwvc3ZnPg==")}';Dn(Mn);const gi="xterm-search-bar__addon";class Bn{constructor(H){this.options=H||{},this.options&&this.options.searchAddon&&(this.searchAddon=this.options.searchAddon)}activate(H){this.terminal=H,this.searchAddon||console.error("Cannot use search bar addon until search addon has been loaded!")}dispose(){this.hidden()}show(){if(!this.terminal||!this.terminal.element)return;if(this.searchBarElement){this.searchBarElement.style.visibility="visible",this.searchBarElement.querySelector("input").select();return}this.terminal.element.style.position="relative";const H=document.createElement("div");H.innerHTML=`
       <input type="text" class="search-bar__input" name="search-bar__input"/>
       <button class="search-bar__btn prev"></button>
       <button class="search-bar__btn next"></button>
       <button class="search-bar__btn close"></button>
    `,H.className=gi;const ee=this.terminal.element.parentElement;this.searchBarElement=H,["relative","absoulte","fixed"].includes(ee.style.position)||(ee.style.position="relative"),ee.appendChild(this.searchBarElement),this.on(".search-bar__btn.close","click",()=>{this.hidden()}),this.on(".search-bar__btn.next","click",()=>{this.searchAddon.findNext(this.searchKey,{incremental:!1})}),this.on(".search-bar__btn.prev","click",()=>{this.searchAddon.findPrevious(this.searchKey,{incremental:!1})}),this.on(".search-bar__input","keyup",se=>{this.searchKey=se.target.value,this.searchAddon.findNext(this.searchKey,{incremental:se.key!=="Enter"})}),this.searchBarElement.querySelector("input").select()}hidden(){this.searchBarElement&&this.terminal.element.parentElement&&(this.searchBarElement.style.visibility="hidden")}on(H,ee,se){const pe=this.terminal.element.parentElement;pe.addEventListener(ee,he=>{let q=he.target;for(;q!==document.querySelector(H);){if(q===pe){q=null;break}q=q.parentElement}q===document.querySelector(H)&&(se.call(this,he),he.stopPropagation())})}addNewStyle(H){let ee=document.getElementById(gi);ee||(ee=document.createElement("style"),ee.type="text/css",ee.id=gi,document.getElementsByTagName("head")[0].appendChild(ee)),ee.appendChild(document.createTextNode(H))}}const On={props:["theme"],data(){return{themeList:["Auto","Arthur","Dracula","OneDark","Ubuntu","Default"]}},methods:{send(K){this.$emit("send",K)},showProgres(){let K="echo Top Memory Progress: && ps -eo pid,user,rss,pmem,pcpu,cputime,comm,cmd | ";K+=`awk 'NR<2{print $0;next}{print $0| "sort -k 3 -nr"}' | head -16 | `,K+="numfmt --header --to=iec --from-unit=1024 --field 3 | cut -c 1-130",this.send(K)},changeTheme(K){this.$emit("update:theme",K)}}};var In=function(){var H=this,ee=H._self._c;return ee("div",{staticClass:"terminal-toolbar pl-3 gap-x-4 h-[25px] flex items-center"},[ee("div",{staticClass:"terminal-toolbar-selection"},[H._v(" Vim: "),ee("i",{staticClass:"el-icon-edit",attrs:{title:"Edit Profile"},on:{click:function(se){return H.send("vi /etc/profile")}}}),ee("i",{staticClass:"el-icon-wind-power",attrs:{title:"Show Line Number"},on:{click:function(se){return H.send(":set nu")}}}),ee("i",{staticClass:"el-icon-set-up",attrs:{title:"Format"},on:{click:function(se){return H.send("gg=G")}}}),ee("i",{staticClass:"el-icon-check",attrs:{title:"Save"},on:{click:function(se){return H.send(":wq")}}}),ee("i",{staticClass:"el-icon-close",attrs:{title:"Close"},on:{click:function(se){return H.send(":q!")}}})]),ee("div",{staticClass:"terminal-toolbar-selection"},[H._v(" "+H._s(H.$t("ssh.util"))+": "),ee("i",{staticClass:"el-icon-coin",attrs:{title:"Disk Usage"},on:{click:function(se){return H.send("du -h -d 1| sort -h")}}}),ee("i",{staticClass:"el-icon-stopwatch",attrs:{title:"Listening Port"},on:{click:function(se){return H.send("netstat -anp|grep 'LISTEN\\b'|less")}}}),ee("i",{staticClass:"el-icon-data-line",attrs:{title:"List Progress"},on:{click:H.showProgres}}),ee("i",{staticClass:"el-icon-document-delete",attrs:{title:"Clear Screen"},on:{click:function(se){return H.send("clear")}}})]),ee("div",{staticClass:"terminal-toolbar-selection"},[H._v(" "+H._s(H.$t("ssh.theme"))+": "),ee("vsc-radio-group",{staticClass:"inline-block",attrs:{value:H.theme,size:"mini"},on:{input:H.changeTheme}},H._l(H.themeList,function(se,pe){return ee("vsc-radio-button",{key:pe,attrs:{label:se}})}),1)],1)])},Pn=[],Un=yi(On,In,Pn,!1,null,"e66ea9de",null,null);const Fn=Un.exports;const Hn={mixins:[Gr],data(){return{live:!0,lastTime:null,receivedData:!1,option:{query:null,previousMinute:30}}},mounted(){this.on("query",K=>{this.option.query||(this.option.query=K)}).on("lastTime",({lastTime:K,hasLog:H})=>{this.lastTime||setInterval(()=>{!this.live||!this.receivedData||(this.receivedData=!1,this.emit("getLogs",{live:!0,start:this.lastTime,hasLog:H,query:this.option.query}))},3e3),(!this.lastTime||H)&&(this.lastTime=K),this.receivedData=!0})},methods:{loadLogs(){this.emit("getLogs",this.option)},openDocument(){this.emit("openDocument")}}};var Nn=function(){var H=this,ee=H._self._c;return ee("div",{staticClass:"terminal-toolbar pl-3 gap-x-4 h-10 flex items-center"},[ee("vsc-input",{staticClass:"ml-1",staticStyle:{width:"300px"},attrs:{theme:"base","prefix-icon":"el-icon-search",size:"mini",placeholder:"Loki queries",clearable:!1},nativeOn:{keyup:function(se){return!se.type.indexOf("key")&&H._k(se.keyCode,"enter",13,se.key,"Enter")?null:H.loadLogs.apply(null,arguments)}},model:{value:H.option.query,callback:function(se){H.$set(H.option,"query",se)},expression:"option.query"}}),ee("i",{staticClass:"el-icon-document",attrs:{title:"Document"},on:{click:H.openDocument}}),ee(sn,{staticStyle:{width:"130px"},attrs:{placeholder:"Forever",size:"small"},on:{change:H.loadLogs},model:{value:H.option.previousMinute,callback:function(se){H.$set(H.option,"previousMinute",se)},expression:"option.previousMinute"}},[ee(dt,{attrs:{value:15,label:"Last 15 minutes"}}),ee(dt,{attrs:{value:30,label:"Last 30 minutes"}}),ee(dt,{attrs:{value:60,label:"Last 1 hours"}}),ee(dt,{attrs:{value:120,label:"Last 2 hours"}}),ee(dt,{attrs:{value:180,label:"Last 3 hours"}}),ee(dt,{attrs:{value:1440,label:"Last 24 hours"}}),ee(dt,{attrs:{value:2880,label:"Last 2 days"}}),ee(dt,{attrs:{value:10080,label:"Last 7 days"}})],1),ee("div",{staticClass:"inline-block ml-[-8px] mr-2"},[ee("label",{staticClass:"mr-2"},[H._v("Live")]),ee(rn,{model:{value:H.live,callback:function(se){H.live=se},expression:"live"}})],1),ee("i",{staticClass:"el-icon-refresh-left icon",staticStyle:{"margin-left":"-10px"},attrs:{title:"Refresh"},on:{click:H.loadLogs}})],1)},Wn=[],Gn=yi(Hn,Nn,Wn,!1,null,"7afb1dba",null,null);const jn=Gn.exports;const zn={components:{SSHToolbar:Fn,LokiToolbar:jn},mixins:[Gr],data(){return{theme:"vscode",dbType:null,terminal:null,isSSH:!1,remainHeight:756,listenThemeChange:!0}},watch:{theme(K){this.terminal.options.theme=_i(K),this.emit("updateOption",{key:"terminalTheme",value:K})}},mounted(){this.calcHeight(),this.on("terminalConfig",({fontSize:K,fontFamily:H,theme:ee,dbType:se})=>{this.dbType=se;let pe=!1;ee&&(this.theme=ee);const he=new on.Terminal({theme:_i(this.theme),cursorStyle:"bar",cursorBlink:!0,allowProposedApi:!0,fontSize:K,fontFamily:H,disableStdin:!1,lineHeight:1.1,cursorBlink:!0,scrollback:1e6,tabStopWidth:8,bellStyle:"sound"});this.terminal=he;const q=new ln.FitAddon;new ResizeObserver(()=>this.calcHeight(q)).observe(this.$refs.box);const c=new Ln.SearchAddon,S=new Bn({searchAddon:c});he.attachCustomKeyEventHandler(y=>{if(y.code=="Escape"&&S.hidden(),y.shiftKey&&y.code=="Insert")return!1;if(Ot(y)&&!y.altKey&&!y.shiftKey){const t=y.code;if(t=="KeyC"&&he.hasSelection())return document.execCommand("copy"),!1;if(t=="KeyV")return!1;if(t=="KeyF")return S.show(),!1;if(["PageDown","PageUp"].includes(t))return!1}else if(Ot(y)&&y.shiftKey&&y.code=="KeyV")return!1;const o=new y.constructor(y.type,y);return document.body.dispatchEvent(o),!0}),se=="SSH"&&(this.isSSH=!0,window.addEventListener("keyup",y=>{Ot(y)&&y.shiftKey&&y.code=="KeyV"&&this.emit("data",[22])}));const m=document.getElementById("terminal-container");he.open(m),he.loadAddon(q),he.loadAddon(c),he.loadAddon(S),he.loadAddon(new an.CanvasAddon),he.loadAddon(new xn.LigaturesAddon);let f;he.loadAddon(new En.WebLinksAddon((y,_)=>{if(!Ot(y)){const o=f;if(f=new Date().getTime(),!o||f-o>200)return}this.emit("openLink",_)})),q.fit(),he.focus(),he.onData(y=>{this.emit("data",y)});const u=()=>{this.calcHeight(),this.$nextTick(()=>{q.fit(),this.emit("resize",{cols:he.cols,rows:he.rows})})};window.addEventListener("resize",u,!1),window.onfocus=()=>{he.focus()},document.querySelector("#terminal-container").oncontextmenu=async y=>{if(y.stopPropagation(),he.hasSelection())document.execCommand("copy"),he.clearSelection();else{const _=await navigator.clipboard.readText();this.emit("data",_.replace(/\r\n/g,"\r"))}};let d=!1;this.on("connecting",y=>{he.write(y),he.write("\x1B[2K\r")}).on("data",y=>{d||(he.clear(),d=!0),he.write(y)}).on("init-terminal",y=>{u()}).on("error",y=>{pe||(pe=!0,he.write(y))}).on("theme",()=>{this.theme=="Auto"&&(he.options.theme=_i(this.theme))}),this.emit("initTerminal",{cols:he.cols,rows:he.rows})}).init()},methods:{calcHeight(K){let H=8;this.isSSH&&(H+=20),this.dbType==nn.LOKI&&(H+=35),this.remainHeight=window.innerHeight-H,K&&this.$nextTick(()=>{K.fit()})},send(K){this.emit("data",""),setTimeout(()=>{var H;this.emit("data",`${K}
\r`),(H=this.terminal)==null||H.focus()},100)}}};var $n=function(){var H=this,ee=H._self._c;return ee("div",{ref:"box",staticClass:"box"},[H.isSSH?ee("SSHToolbar",{attrs:{theme:H.theme},on:{"update:theme":function(se){H.theme=se},send:H.send}}):H._e(),H.dbType=="Loki"?ee("LokiToolbar",{on:{send:H.send}}):H._e(),ee("div",{style:{height:H.remainHeight+"px"},attrs:{id:"terminal-container"}})],1)},qn=[],Vn=yi(zn,$n,qn,!1,null,"2cc6dd4d",null,null);const to=Vn.exports;export{to as default};
