import{n as T}from"./notify-7ms8YXRV.js";import{s as B,h as U,j as L,_ as E,k as _,o as d,l as f,w as l,e as t,q as c,t as g,b as u,a as b,I as N,F as R,f as k,z as x,A as M,d as I}from"./app-Bf1EJw8l.js";import{E as $,a as z}from"./index-XXBVAC5S.js";import{E as q,a as G}from"./index-DGGgE9Vn.js";import{E as O}from"./index-87euUeSH.js";import{E as P}from"./index-CRCW-nZ8.js";import{E as j}from"./index-C6Zovpry.js";import{a as F,E as A}from"./index-j61gtqiN.js";import{E as W}from"./index-B_FZe6hO.js";import"./index-Dpstq9UH.js";import"./icon-CZcOhJQp.js";import"./use-global-config-0XpG2_0j.js";import"./focus-trap-DLD2w1Ia.js";import"./use-form-item-DdyI_hvh.js";import"./_baseClone-DEWKTuY-.js";import"./index-CFJCZjdX.js";import"./_initCloneObject-DbrZpPYH.js";import"./validator-Di5JEBAH.js";import"./scroll-DzYU1O0r.js";import"./index-Ds0zupmL.js";import"./flatten-BCYDgirk.js";import"./_baseIteratee-xh2dZROY.js";import"./index-BtYaA7w7.js";import"./isArrayLikeObject-DnFfw4hg.js";import"./index-CslgC0gF.js";import"./aria-46nDEFyt.js";var S=(e=>(e[e.Stop=0]="Stop",e[e.Running=1]="Running",e[e.AlreadyUsed=2]="AlreadyUsed",e))(S||{});const H=B("forward",{state:()=>({panel:{visible:!1,loading:!1,edit:{name:null,autoStartUp:null,type:null,localHost:null,localPort:null,remoteHost:null,remotePort:null}}})}),J={mixins:[U],data(){return{config:{}}},computed:{...L(H,{panel:e=>e.panel}),localPortPlaceHolder(){return this.panel.edit.type=="Dynamic"?"1080":"port"},forwardNotice(){switch(this.panel.edit.type){case"Local":return this.$t("ssh.portForward.local");case"Remote":return this.$t("ssh.portForward.remote")}return this.$t("ssh.portForward.dynamic")}},watch:{"panel.edit.type"(e){this.panel.edit.id||(this.panel.edit.remoteHost=e=="Remote"?this.config.host:"127.0.0.1")}},mounted(){this.on("config",e=>{this.config=e})},methods:{confirmSave(){this.$emit("save",this.panel.edit),this.panel.loading=!0}}},K=e=>(x("data-v-43f4ae04"),e=e(),M(),e),Q={class:"mb-2 ml-20"},X={class:"flex flex-row items-center w-72"},Y=K(()=>u("span",{class:"basis-14 text-center text-base"},":",-1)),Z={class:"forward-arrow"},ee={key:0,class:"el-icon-bottom"},te={key:1,class:"el-icon-top"},oe={class:"flex flex-row items-center w-72"},le=K(()=>u("span",{class:"basis-14 text-center text-base"},":",-1)),ae={class:"flex flex-row"};function ne(e,o,w,C,v,r){const y=_("RedMark"),i=$,s=z,m=q,h=O,V=P,a=G,p=_("vsc-button"),D=j;return d(),f(D,{ref:"editDialog",modelValue:e.panel.visible,"onUpdate:modelValue":o[11]||(o[11]=n=>e.panel.visible=n),title:"Port Fowarding",width:"550px",top:"3vh",closeOnClickModal:!1},{footer:l(()=>[t(p,{type:"secondary",onClick:o[10]||(o[10]=n=>e.panel.visible=!1)},{default:l(()=>[c(g(e.$t("common.cancel")),1)]),_:1}),t(p,{loading:e.panel.loading,onClick:r.confirmSave},{default:l(()=>[c("Save")]),_:1},8,["loading","onClick"])]),default:l(()=>[t(a,{ref:"infoForm",model:e.panel.edit,"label-width":"120px"},{default:l(()=>[u("div",Q,g(r.forwardNotice),1),t(m,null,{label:l(()=>[t(y),c("Type ")]),default:l(()=>[t(s,{modelValue:e.panel.edit.type,"onUpdate:modelValue":o[3]||(o[3]=n=>e.panel.edit.type=n),type:"relax"},{default:l(()=>[t(i,{modelValue:e.panel.edit.type,"onUpdate:modelValue":o[0]||(o[0]=n=>e.panel.edit.type=n),value:"Local"},{default:l(()=>[c("Local")]),_:1},8,["modelValue"]),t(i,{modelValue:e.panel.edit.type,"onUpdate:modelValue":o[1]||(o[1]=n=>e.panel.edit.type=n),value:"Remote"},{default:l(()=>[c("Remote")]),_:1},8,["modelValue"]),t(i,{modelValue:e.panel.edit.type,"onUpdate:modelValue":o[2]||(o[2]=n=>e.panel.edit.type=n),value:"Dynamic"},{default:l(()=>[c(" Dynamic(Socks Proxy) ")]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),t(m,null,{label:l(()=>[t(y),c("Local ")]),default:l(()=>[u("div",X,[t(h,{modelValue:e.panel.edit.localHost,"onUpdate:modelValue":o[4]||(o[4]=n=>e.panel.edit.localHost=n),class:"basis-72"},null,8,["modelValue"]),Y,t(h,{modelValue:e.panel.edit.localPort,"onUpdate:modelValue":o[5]||(o[5]=n=>e.panel.edit.localPort=n),placeholder:r.localPortPlaceHolder,class:"basis-32"},null,8,["modelValue","placeholder"])])]),_:1}),e.panel.edit.type!="Dynamic"?(d(),b(R,{key:0},[u("div",Z,[e.panel.edit.type=="Remote"?(d(),b("i",ee)):(d(),b("i",te))]),t(m,null,{label:l(()=>[t(y),c("Remote ")]),default:l(()=>[u("div",oe,[t(h,{modelValue:e.panel.edit.remoteHost,"onUpdate:modelValue":o[6]||(o[6]=n=>e.panel.edit.remoteHost=n),class:"basis-72"},null,8,["modelValue"]),le,t(h,{modelValue:e.panel.edit.remotePort,"onUpdate:modelValue":o[7]||(o[7]=n=>e.panel.edit.remotePort=n),placeholder:"port",class:"basis-32",onKeyup:N(r.confirmSave,["enter"])},null,8,["modelValue","onKeyup"])])]),_:1})],64)):k("",!0),u("div",ae,[t(m,{label:"Name",class:"w-64"},{default:l(()=>[t(h,{modelValue:e.panel.edit.name,"onUpdate:modelValue":o[8]||(o[8]=n=>e.panel.edit.name=n)},null,8,["modelValue"])]),_:1}),t(m,{class:"auto-start-form-item",label:"Auto Start",title:"Auto start with VS Code startup"},{default:l(()=>[t(V,{modelValue:e.panel.edit.autoStartUp,"onUpdate:modelValue":o[9]||(o[9]=n=>e.panel.edit.autoStartUp=n),class:"ml-2"},null,8,["modelValue"])]),_:1})])]),_:1},8,["model"])]),_:1},8,["modelValue"])}const re=E(J,[["render",ne],["__scopeId","data-v-43f4ae04"]]),ie=I({__name:"ForwardServerTable",props:{serverList:Array},emits:["selectServer"],setup(e,{emit:o}){const w=o;return(C,v)=>{const r=A,y=_("vsc-button"),i=F;return d(),f(i,{data:e.serverList,style:{width:"100%"}},{default:l(()=>[t(r,{prop:"key",label:"Key",width:"150",align:"center"}),t(r,{prop:"name",label:"Name",width:"350",align:"center"}),t(r,{prop:"count",label:"Count",width:"70",align:"center"}),t(r,{label:"Operation",width:"90",align:"center"},{default:l(({row:s})=>[t(y,{type:"icon",icon:"codicon-edit",title:"edit",onClick:m=>w("selectServer",s)},null,8,["onClick"])]),_:1})]),_:1},8,["data"])}}}),se={components:{ForwardDialog:re,ForwardServerTable:ie},mixins:[U],data(){return{name:"",serverKey:null,serverList:[],forwardList:[],serverListMode:!1}},computed:{...L(H,{panel:e=>e.panel})},mounted(){this.on("forwardList",e=>{this.forwardList=e,this.panel.loading=!1,this.panel.visible=!1}).on("serverList",e=>{this.serverList=e}).on("name",e=>{this.name=e}).on("success",()=>{this.error=!1,this.emit("load")}).on("error",({id:e,message:o})=>{for(const w of this.forwardList)w.id==e&&(w.loading=!1);this.panel.loading=!1,T({message:o,type:"error",position:"top-left"})}).init()},methods:{selectServer(e){this.name=e.name,this.serverKey=e.key,this.serverListMode=!1,this.emit("selectServer",e.key)},updateForward(e){this.emit("save",{info:e,serverKey:this.serverKey})},createRequest(){this.panel.edit={type:"Local",autoStartUp:!1,localHost:"127.0.0.1",remoteHost:"127.0.0.1"},this.panel.visible=!0},load(){this.emit("load")},getState(e){switch(e){case S.Running:return"Running";case S.AlreadyUsed:return"AlreadyUsed";default:return"Stop"}},start(e){e.loading=!0,this.emit("start",e.id)},stop(e){this.emit("stop",e)},remove(e){this.emit("remove",{id:e,serverKey:this.serverKey})},openEdit(e){this.panel.edit={...e},this.panel.visible=!0},deleteConfirm(e){W.confirm("Are you sure to delete this forward?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(()=>{this.remove(e)})}}},de={class:"ml-2 my-1 text-base"},pe={class:"ml-5"};function me(e,o,w,C,v,r){const y=_("ForwardServerTable"),i=_("vsc-button"),s=A,m=P,h=F,V=_("ForwardDialog");return d(),b("div",null,[v.serverListMode?(d(),f(y,{key:0,serverList:v.serverList,onSelectServer:r.selectServer},null,8,["serverList","onSelectServer"])):(d(),b(R,{key:1},[u("div",de,[t(i,{type:"icon",icon:"el-icon-d-arrow-left",onClick:o[0]||(o[0]=a=>v.serverListMode=!0)}),t(i,{type:"icon",icon:"codicon-add text-base",style:{color:"var(--vscode-terminal-ansiCyan)"},onClick:r.createRequest},null,8,["onClick"]),t(i,{type:"icon",icon:"codicon-refresh text-base",style:{color:"var(--vscode-terminal-ansiBrightGreen)"},onClick:r.load},null,8,["onClick"]),u("span",pe,"Connection: "+g(v.name),1)]),t(h,{data:v.forwardList,style:{width:"100%"}},{default:l(()=>[t(s,{prop:"name",label:"Name"}),t(s,{prop:"type",label:"Type"}),t(s,{prop:"localPort",label:"Local Port"}),t(s,{prop:"remoteHost",label:"Remote Host",width:"120"}),t(s,{prop:"remotePort",label:"Remote Port",width:"120"}),t(s,{prop:"keepAlive",label:"KeepAlive"},{default:l(a=>[t(m,{modelValue:a.row.keepAlive,"onUpdate:modelValue":p=>a.row.keepAlive=p,onChange:p=>r.updateForward(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(s,{prop:"autoStartUp",label:"AutoStart"},{default:l(a=>[t(m,{modelValue:a.row.autoStartUp,"onUpdate:modelValue":p=>a.row.autoStartUp=p,onChange:p=>r.updateForward(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(s,{prop:"state",label:"State"},{default:l(a=>[a.row.state==0?(d(),f(i,{key:0,type:"icon",icon:"el-icon-close text-base text-red"})):a.row.state==1?(d(),f(i,{key:1,type:"icon",icon:"el-icon-check text-base text-green"})):(d(),f(i,{key:2,type:"icon",icon:"el-icon-video-pause text-base text-yellow"})),c(" "+g(r.getState(a.row.state)),1)]),_:1}),t(s,{fixed:"right",width:"200"},{default:l(a=>[a.row.state!=1?(d(),f(i,{key:0,type:"success",size:"small",title:"Start",loading:a.row.loading,icon:"el-icon-video-play",style:{color:"var(--vscode-terminal-ansiBrightGreen)"},circle:"",onClick:p=>{r.start(a.row)}},null,8,["loading","onClick"])):k("",!0),a.row.state==1?(d(),f(i,{key:1,type:"danger",size:"small",title:"Stop",icon:"el-icon-switch-button",circle:"",onClick:p=>{r.stop(a.row.id)}},null,8,["onClick"])):k("",!0),t(i,{type:"primary",size:"small",title:"Edit",icon:"el-icon-edit",style:{color:"var(--vscode-terminal-ansiCyan)"},circle:"",onClick:p=>{r.openEdit(a.row)}},null,8,["onClick"]),t(i,{title:"delete",type:"danger",size:"small",icon:"el-icon-delete",style:{color:"#f56c6c"},circle:"",onClick:p=>r.deleteConfirm(a.row.id)},null,8,["onClick"])]),_:1})]),_:1},8,["data"])],64)),t(V,{ref:"fowardDialog",onSave:r.updateForward},null,8,["onSave"])])}const Ne=E(se,[["render",me]]);export{Ne as default};
